#!/usr/bin/env node
var Xe=Object.create;var L=Object.defineProperty,Ye=Object.defineProperties,Ze=Object.getOwnPropertyDescriptor,et=Object.getOwnPropertyDescriptors,tt=Object.getOwnPropertyNames,pe=Object.getOwnPropertySymbols,rt=Object.getPrototypeOf,me=Object.prototype.hasOwnProperty,ot=Object.prototype.propertyIsEnumerable;var de=(e,t,r)=>t in e?L(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,d=(e,t)=>{for(var r in t||(t={}))me.call(t,r)&&de(e,r,t[r]);if(pe)for(var r of pe(t))ot.call(t,r)&&de(e,r,t[r]);return e},E=(e,t)=>Ye(e,et(t)),st=e=>L(e,"__esModule",{value:!0});var it=(e,t,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of tt(t))!me.call(e,o)&&o!=="default"&&L(e,o,{get:()=>t[o],enumerable:!(r=Ze(t,o))||r.enumerable});return e},a=e=>it(st(L(e!=null?Xe(rt(e)):{},"default",e&&e.__esModule&&"default"in e?{get:()=>e.default,enumerable:!0}:{value:e,enumerable:!0})),e);var le=a(require("fs-extra")),Ge=a(require("sade"));var nt="presta",at="0.34.6",lt="Hyper minimal framework for the modern web.",ct="dist/index.js",ut="index.d.ts",pt=["dist","index.d.ts"],mt={presta:"dist/cli.js"},dt={prepare:"pnpm build",build:"node scripts/build",test:"rm -rf ./fixtures && NODE_ENV=test node test","test:watch":"NODE_ENV=test nodemon -e js,ts --ignore fixtures/ test",cloc:"pnpx cloc lib/*.ts",typecheck:"pnpx tsc --noEmit"},gt={type:"git",url:"git+ssh://git@github.com/sure-thing/presta.git"},ft="estrattonbailey",ht="MIT",bt={url:"https://github.com/sure-thing/presta/issues"},yt="https://github.com/sure-thing/presta#readme",xt={"@netlify/functions":"^0.7.2","@types/mime-types":"^2.1.0",chokidar:"^3.4.3",deepmerge:"^4.2.2",esbuild:"^0.12.9","esbuild-register":"^2.5.0",filewatcher:"^3.0.1","fs-extra":"^9.0.1","get-port":"^5.1.1",kleur:"^4.1.4","mime-types":"^2.1.31","module-alias":"^2.2.2",ms:"^2.1.2",picomatch:"^2.3.0","pocket.io":"^0.1.4","query-string":"^6.13.7","raw-body":"^2.4.1",regexparam:"^1.3.0","route-sort":"^1.0.0",sade:"^1.7.3",sirv:"^1.0.7","tiny-glob":"^0.2.9","watch-dependency-graph":"^2.6.1"},vt={"@types/fs-extra":"^9.0.12","@types/picomatch":"^2.2.4","@types/sade":"^1.7.3",baretest:"^2.0.0",nodemon:"^2.0.4",proxyquire:"^2.1.3","supertest-fetch":"^1.4.3"},ge={name:nt,version:at,description:lt,main:ct,types:ut,files:pt,bin:mt,scripts:dt,repository:gt,author:ft,license:ht,bugs:bt,homepage:yt,dependencies:xt,devDependencies:vt};var O=a(require("kleur"));var w=a(require("path"));function fe(){let e={};function t(i,...c){e[i]&&e[i].map(s=>s(...c))}function r(i,c){return e[i]=e[i]?e[i].concat(c):[c],()=>e[i].splice(e[i].indexOf(c),1)}function o(){e={}}function n(i){return e[i]||[]}return{emit:t,on:r,clear:o,listeners:n}}var he="presta.config.js",x;(function(o){o.PRODUCTION="production",o.DEVELOPMENT="development",o.TEST="test"})(x||(x={}));var wt={pid:process.pid,cwd:process.cwd(),env:x.TEST,debug:!1};function Z(e){return global.__presta__=e,e}function P(){return global.__presta__||Z(wt),global.__presta__}function be(e){let t=process.cwd();return e.files&&(e.files=[].concat(e.files).map(r=>w.default.resolve(t,r))),e.output&&(e.output=w.default.resolve(t,e.output)),e.assets&&(e.assets=w.default.resolve(t,e.assets)),e}function k(e,t=!1){try{return require(w.default.resolve(e||he))}catch(r){return f({label:"error",error:r}),t&&process.exit(1),{}}}function ye(){return p({label:"debug",message:"config file values cleared"}),Z(T(E(d({},P()),{config:{}})))}function T({env:e=P().env,config:t={},cli:r={}}){t=be(d({},t)),r=be(d({},r));let o={output:r.output||t.output||w.default.resolve("build"),assets:r.assets||t.assets||w.default.resolve("public"),files:r.files&&r.files.length?r.files:t.files?[].concat(t.files):[]},n=Z(E(d(d({},P()),o),{env:e,debug:r.debug||P().debug,cwd:process.cwd(),configFilepath:w.default.resolve(r.config||he),functionsOutputDir:w.default.join(o.output,"functions"),staticOutputDir:w.default.join(o.output,"static"),routesManifest:w.default.join(o.output,"routes.json"),events:fe()}));return t.plugins&&t.plugins.map(i=>{try{i()}catch(c){f({label:"error",error:c})}}),p({label:"debug",message:`config created ${JSON.stringify(n)}`}),n}var S;(function(n){n.Debug="debug",n.Info="info",n.Warn="warn",n.Err="error"})(S||(S={}));var xe=[],St={[S.Debug]:"magenta",[S.Info]:"blue",[S.Warn]:"yellow",[S.Err]:"red"};function U(e){if(process.env.TESTING)xe.push(e);else{let t=P().debug,r=P().env===x.PRODUCTION?"prod":"dev";if(!t&&e.level===S.Debug)return;console.log([O.default.gray(r),O.default[St[e.level||"info"]](e.label),e.message,e.duration?O.default.gray("+"+e.duration):"",e.error?`

${e.error.stack||e.error}

`:""].filter(Boolean).join(" "))}}function p(e){U(d({level:S.Debug},e))}function y(e){U(d({level:S.Info},e))}function C(e){U(d({level:S.Warn},e))}function f(e){U(d({level:S.Err},e))}function q(...e){P().env===x.TEST?xe.push(e):console.log(...e)}function $(){P().env!==x.TEST&&console.log("")}var K=a(require("fs-extra")),De=a(require("watch-dependency-graph")),ke=a(require("chokidar")),je=a(require("picomatch"));var z=a(require("fs-extra")),ee=a(require("path")),we=a(require("route-sort"));function ve(e){for(var t=5381,r=e.length;r;)t=t*33^e.charCodeAt(--r);return(t>>>0).toString(36)}function Ft(e,t){let{route:r}=require(e),o=ee.default.basename(e).split(".").reverse().slice(1).reverse().join("."),n=ee.default.join(t.functionsOutputDir,t.env===x.PRODUCTION?o+"-"+ve(z.default.readFileSync(e,"utf8"))+".js":o+".js");return p({label:"debug",message:`generating ${o} lambda`}),delete require.cache[e],delete require.cache[n],z.default.outputFileSync(n,`import { wrapHandler } from 'presta';
import * as file from '${e}';
export const route = file.route
export const handler = wrapHandler(file)`),[r,n]}function G(e,t){let r=e.map(i=>{try{return Ft(i,t)}catch(c){return f({label:"error",error:c}),null}}).filter(Boolean),o=(0,we.default)(r.map(i=>i[0])),n={};for(let i of o){let c=r.find(s=>s[0]===i);c&&(n[i]=c[1])}return z.default.outputFileSync(t.routesManifest,JSON.stringify(n)),r}var te=a(require("fs-extra")),Se=a(require("path")),Fe=a(require("tiny-glob/sync"));function D(e){return/export\s.+\sroute\s+\=/.test(te.default.readFileSync(e,"utf-8"))}function I(e){return/export\s.+\sgetStaticPaths/.test(te.default.readFileSync(e,"utf-8"))}function N(e){return[].concat(e.files).map(t=>(0,Fe.default)(t,{cwd:e.cwd})).flat().map(t=>Se.default.resolve(e.cwd,t))}var Te=a(require("fs-extra")),re=a(require("path")),Oe=a(require("mime-types"));function F(){let e=process.hrtime();return()=>{let[t,r]=process.hrtime(e),o=r/1e6;return t<1?(o>=1?o.toFixed(0):o.toFixed(2))+"ms":t+"."+o.toFixed(0)+"s"}}var Ce=a(require("regexparam"));function Ee(e,t){let r=(0,Ce.default)(t),o=0,n={},i=r.pattern.exec(e)||[];for(;o<r.keys.length;)n[r.keys[o]]=i[++o];return n}function Ct(e){return typeof e=="object"?JSON.stringify(e):e}function J(e){let{isBase64Encoded:t=!1,statusCode:r=200,headers:o={},multiValueHeaders:n={},body:i="",html:c=void 0,json:s=void 0,xml:l=void 0}=typeof e=="string"?{body:e}:e,u="text/html; charset=utf-8";return s?u="application/json; charset=utf-8":l&&(u="application/xml; charset=utf-8"),{isBase64Encoded:t,statusCode:r,headers:d({"Content-Type":u},o),multiValueHeaders:n,body:Ct(i||c||s||l||"")}}var _={};var Pe=a(require("fs-extra")),$e=a(require("path"));function H(e,t){p({label:"debug",message:`removing old static file ${e}`}),Pe.default.remove($e.default.join(t.staticOutputDir,e))}function Et(e,t="html"){return re.default.extname(e)?e:t==="html"?`${e}/index.html`:`${e}.${t}`}function A(e,t){return new Promise(async(r,o)=>{p({label:"debug",message:`rendering ${JSON.stringify(e)}`});let n=[];for(let i of e){let c=i.replace(t.cwd,"");try{delete require.cache[i];let s=require(i),l=await s.getStaticPaths(),u=_[i]=_[i]||[],m=[];if(!l||!l.length){C({label:"paths",message:`${c} - no paths to render`}),u.forEach(h=>H(h,t));continue}for(let h of l){let ce=F(),B={path:h,params:s.route?Ee(h,s.route):{}},g=J(await s.handler(B,{})),V=g.headers?g.headers["Content-Type"]:"",v=V&&Oe.default.extension(V)||"html",R=Et(h,v);n.push(R),m.push(R),Te.default.outputFileSync(re.default.join(t.staticOutputDir,R),g.body,"utf-8"),y({label:"built",message:h,duration:ce()})}for(let h of u)m.includes(h)||H(h,t);_[i]=m}catch(s){t.env==="development"?(f({label:"error",message:"errors detected, pausing...",error:s}),r({allGeneratedFiles:n})):(f({label:"error",error:s}),o(s));break}}r({allGeneratedFiles:n})})}function Q(e,t){let r=F();G(e,t),e.length&&y({label:"built",message:"lambdas",duration:r()})}async function Re(e){let t=N(e),r=K.default.existsSync(e.configFilepath);t.length||C({label:"paths",message:"no files configured"}),Q(t.filter(D),e);let o=(0,De.default)({alias:{"@":e.cwd}}),n=ke.default.watch(e.cwd,{ignoreInitial:!0,ignored:[e.output,e.assets]});async function i(){t=N(e),await A(t.filter(I),e),Q(t.filter(D),e)}async function c(s){I(s)&&await A([s],e),D(s)&&Q(t.filter(D),e),e.events.emit("refresh"),e.events.emit("done",[s])}o.on("remove",([s])=>{p({label:"watch",message:`fileWatcher - removed ${s}`}),t.splice(t.indexOf(s),1),Q(t.filter(D),e),s===e.configFilepath&&(e=ye(),r=!1,i()),(_[s]||[]).forEach(l=>H(l,e)),e.events.emit("remove",s)}),o.on("change",([s])=>{if(p({label:"watch",message:`fileWatcher - changed ${s}`}),s===e.configFilepath){delete require.cache[e.configFilepath];try{e=T({config:k(e.configFilepath)}),i()}catch(l){f({label:"error",error:l})}}else c(s);e.events.emit("change",s)}),o.on("error",s=>{f({label:"error",error:s})}),n.on("all",async(s,l)=>{if(!(!/add|change/.test(s)||!K.default.existsSync(l)||K.default.lstatSync(l).isDirectory())){if((0,je.default)(e.files)(l)&&!t.includes(l)&&(p({label:"watch",message:`globalWatcher - add ${l}`}),t.push(l),o.add(l),c(l)),l===e.configFilepath&&!r){p({label:"watch",message:`globalWatcher - add config file ${l}`}),o.add(e.configFilepath);try{e=T({config:k(e.configFilepath)}),r=!0,i()}catch(u){f({label:"error",error:u})}}e.events.emit("add",l)}}),o.add(t),r&&o.add(e.configFilepath);try{t.map(require)}catch(s){f({label:"error",error:s})}}var oe=a(require("fs-extra")),_e=a(require("esbuild"));function Pt(e){try{return require(e)}catch(t){return{}}}async function Me(e){let t=F(),r=N(e),o=r.filter(I),n=r.filter(D);if(p({label:"build",message:"starting build"}),!o.length&&!n.length)C({label:"files",message:"no files were found, nothing to build"});else{let i="",c=0,s="",l="",u=await Promise.allSettled([(async()=>{if(o.length){let m=F(),{allGeneratedFiles:h}=await A(o,e);i=m(),c=h.length}})(),(async()=>{if(n.length){let m=F();G(n,e),await(0,_e.build)({entryPoints:Object.values(require(e.routesManifest)),outdir:e.functionsOutputDir,bundle:!0,platform:"node",target:["node12"],minify:!0,allowOverwrite:!0}),s=m()}})(),(async()=>{if(oe.default.existsSync(e.assets)){let m=F();oe.default.copySync(e.assets,e.staticOutputDir),l=m()}})()]);if(u.find(m=>m.status==="rejected")){p({label:"build",message:"build partially failed"}),u.forEach(m=>{m.status==="rejected"&&f({label:"error",error:m.reason})}),process.exit(1);return}(i||s)&&$(),i&&y({label:"static",message:`rendered ${c} file(s)`,duration:i}),s&&y({label:"lambda",message:`compiled ${n.length} function(s)`,duration:s}),l&&y({label:"assets",message:`copied in ${l}`}),(i||s)&&($(),y({label:"complete",message:`in ${t()}`}),$()),e.events.emit("postbuild",{output:e.output,staticOutput:e.staticOutputDir,functionsOutput:e.functionsOutputDir,functionsManifest:Pt(e.routesManifest)})}}var ie=a(require("fs")),X=a(require("path")),Be=a(require("http")),Ve=a(require("get-port")),ne=a(require("sirv")),Le=a(require("chokidar")),Ue=a(require("mime-types")),qe=a(require("regexparam"));var se=`<!-- built with presta https://npm.im/presta -->
<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>404</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="https://unpkg.com/svbstrate@4.1.1/dist/svbstrate.css"
    />
  </head>
  <body>
    <div class="f aic jcc" style="height: 100vh">
      <h2 class="p1" style="color: blue">404 Not Found</h2>
    </div>
  </body>
</html>`;var Ie=a(require("url")),Ne=a(require("query-string")),He=a(require("raw-body")),Ae=a(require("mime-types")),$t=/image|audio|video|application\/pdf|application\/zip|applicaton\/octet-stream/i;function Tt(e){return Boolean(e)&&$t.test(e)}async function We(e){var i;let t=String(e.headers["x-forwarded-for"])||e.connection.remoteAddress||"",r=(i=t.split(t.includes(".")?":":",").pop())==null?void 0:i.trim(),o=Tt(e.headers["content-type"]||""),n=e.headers["content-length"]?await(0,He.default)(e,{limit:"1mb",encoding:Ae.default.charset(e.headers["content-type"]||"")||void 0}):void 0;return{path:e.url,httpMethod:e.method,headers:E(d({},e.headers),{"client-ip":r}),multiValueHeaders:Object.keys(e.headers).reduce((c,s)=>e.headers[s]&&!e.headers[s].includes(",")?c:E(d({},c),{[s]:e.headers[s].split(",")}),{}),queryStringParameters:(0,Ne.parse)((0,Ie.parse)(e.url).query),body:n?new Buffer(n).toString(o?"base64":"utf8"):null,isBase64Encoded:o}}function j(e,t){let r=J(t);for(let o in t.multiValueHeaders)e.setHeader(o,String(t.multiValueHeaders[o]));for(let o in t.headers)e.setHeader(o,String(t.headers[o]));e.statusCode=r.statusCode,e.write(r.body),e.end()}var Ot=["position: fixed","bottom: 24px","right: 24px","width: 32px","height: 32px","border-radius: 32px","background: white","color: #FF7A93","font-size: 20px","font-weight: bold","text-align: center","line-height: 31px","box-shadow: 0px 0px 1px rgba(0, 0, 0, 0.04), 0px 4px 8px rgba(0, 0, 0, 0.04), 0px 16px 24px rgba(0, 0, 0, 0.04), 0px 24px 32px rgba(0, 0, 0, 0.04)"],M=`
  <div style="${Ot.join(";")}">~</div>
`;function ze(e,t){let r=X.default.join(e,t);if(!X.default.extname(t))try{return ie.default.readFileSync(X.default.join(e,t,"index.html"),"utf8")}catch(o){}return ie.default.readFileSync(r,"utf8")}function Dt({port:e}){return`
    <script>
      (function (global) {
        try {
          const socketio = document.createElement('script')
          socketio.src = 'https://unpkg.com/pocket.io@0.1.4/min.js'
          socketio.onload = function init () {
            var disconnected = false
            var socket = io('http://localhost:${e}', {
              reconnectionAttempts: 3
            })
            socket.on('connect', function() { console.log('presta connected') })
            socket.on('refresh', function() {
              global.location.reload()
            })
            socket.on('disconnect', function() {
              disconnected = true
            })
            socket.on('reconnect_failed', function(e) {
              if (disconnected) return
              console.error("presta - connection to server on :${e} failed")
            })
          }
          document.head.appendChild(socketio)
        } catch (e) {}
      })(this);
    <\/script>
  `}function kt({port:e,config:t}){let r=Dt({port:e}),o=t.staticOutputDir,n=t.assets;return async function(c,s){let l=F(),u=c.url;if(/^.+\..+$/.test(u)&&!/\.html?$/.test(u))p({label:"debug",message:`attempting to serve static asset ${u}`}),(0,ne.default)(n,{dev:!0})(c,s,()=>{(0,ne.default)(o,{dev:!0})(c,s,()=>{C({label:"serve",message:`404 ${u}`,duration:l()}),j(s,{statusCode:404,body:se+r+M})})});else try{p({label:"debug",message:`attempting to render static HTML for ${u}`});let m=ze(o,u)+r+M;y({label:"serve",message:`200 ${u}`,duration:l()}),j(s,{body:m})}catch(m){p({label:"debug",message:"serve error",error:m}),/ENOENT|EISDIR/.test(m.message)||console.error(m);try{let h=require(t.routesManifest),B=Object.keys(h).map(g=>({matcher:(0,qe.default)(g),route:g})).filter(({matcher:g})=>g.pattern.test(u.split("?")[0])).map(({route:g})=>h[g])[0];if(B){p({label:"debug",message:`attempting to render lambda for ${u}`});let{handler:g}=require(B),V=await We(c),v=await g(V,{}),R=v.headers||{},Ke=v.statusCode>299&&v.statusCode<399,ue=R["Content-Type"],Qe=ue?Ue.default.extension(ue):"html";y({label:"serve",message:`${v.statusCode} ${Ke?R.Location:u}`,duration:l()}),j(s,{statusCode:v.statusCode,headers:v.headers,multiValueHeaders:v.multiValueHeaders,body:Qe==="html"?(v.body||"").split("</body>")[0]+r+M:v.body})}else{p({label:"debug",message:`attempting to render static 404.html page for ${u}`});try{let g=ze(o,"404")+r+M;C({label:"serve",message:`404 ${u}`,duration:l()}),j(s,{statusCode:404,body:g})}catch(g){g.message.includes("ENOENT")||console.error(g),p({label:"debug",message:`rendering default 404 HTML page for ${u}`}),C({label:"serve",message:`404 ${u}`,duration:l()}),j(s,{statusCode:404,body:se+r+M})}}}catch(h){p({label:"debug",message:`rendering default 500 HTML page for ${u}`}),f({label:"serve",message:`500 ${u}`,error:h,duration:l()}),j(s,{statusCode:500,body:""+r+M})}}}}async function ae(e){let t=await(0,Ve.default)({port:4e3}),r=Be.default.createServer(kt({port:t,config:e})).listen(t),o=require("pocket.io")(r,{serveClient:!1});return e.events.on("refresh",()=>{p({label:"debug",message:"refresh event received"}),o.emit("refresh")}),Le.default.watch(e.assets,{ignoreInitial:!0}).on("all",()=>{e.events.emit("refresh")}),{port:t}}var W=(0,Ge.default)("presta"),Y="presta.config.js";function Je(e={}){require("module-alias").addAliases({"@":process.cwd(),"presta:internal":__dirname}),require("esbuild-register/dist/node").register(e)}W.version(ge.version).option("--config, -c",`Path to a config file \u2014 defaults to ${Y}`).option("--output, -o","Specify output directory for built files \u2014 defaults to ./build").option("--assets, -a","Specify static asset directory \u2014 defaults to ./public").option("--debug, -d","Enable debug mode (prints more logs)");W.command("build","Render files(s) to output directory.",{default:!0}).example("build").example("build files/**/*.js").example(`build -c ${Y}`).action(async e=>{Je(),console.clear();let t=T({env:x.PRODUCTION,config:k(e.config,!0),cli:E(d({},e),{files:e._})});le.default.emptyDirSync(t.output),q(`${O.default.blue("presta build")}`),$(),await Me(t)});W.command("watch").option("--no-serve, -n","Do not run local dev server.",!1).describe("Watch and build files(s) to output directory").example("watch").example("watch ./files/**/*.js").example("watch ./files/**/*.js -o ./out").example(`watch -c ${Y}`).action(async e=>{Je(),console.clear();let t=T({env:x.DEVELOPMENT,config:k(e.config),cli:E(d({},e),{files:e._})});if(le.default.emptyDirSync(t.output),e.n)y({label:"dev"}),$();else{let r=await ae(t);q(`${O.default.blue("presta dev")} - http://localhost:${r.port}`),$()}Re(t)});W.command("serve").describe("Serve built files.").example("serve").example("serve -o ./out").example(`watch -c ${Y}`).action(async e=>{console.clear();let t=T({env:x.PRODUCTION,config:k(e.config),cli:e}),r=await ae(t);q(`${O.default.blue("presta serve")} - http://localhost:${r.port}`),$()});W.parse(process.argv);
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsiLi4vbGliL2NsaS50cyIsICIuLi9saWIvbG9nLnRzIiwgIi4uL2xpYi9jb25maWcudHMiLCAiLi4vbGliL2NyZWF0ZUVtaXR0ZXIudHMiLCAiLi4vbGliL3dhdGNoLnRzIiwgIi4uL2xpYi9vdXRwdXRMYW1iZGFzLnRzIiwgIi4uL2xpYi9oYXNoQ29udGVudC50cyIsICIuLi9saWIvZ2V0RmlsZXMudHMiLCAiLi4vbGliL3JlbmRlclN0YXRpY0VudHJpZXMudHMiLCAiLi4vbGliL3RpbWVyLnRzIiwgIi4uL2xpYi9nZXRSb3V0ZVBhcmFtcy50cyIsICIuLi9saWIvbm9ybWFsaXplUmVzcG9uc2UudHMiLCAiLi4vbGliL2J1aWx0U3RhdGljRmlsZXMudHMiLCAiLi4vbGliL3JlbW92ZUJ1aWx0U3RhdGljRmlsZS50cyIsICIuLi9saWIvYnVpbGQudHMiLCAiLi4vbGliL3NlcnZlLnRzIiwgIi4uL2xpYi9kZWZhdWx0NDA0LnRzIiwgIi4uL2xpYi9yZXF1ZXN0VG9FdmVudC50cyIsICIuLi9saWIvc2VuZFNlcnZlcmxlc3NSZXNwb25zZS50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiIyEvdXNyL2Jpbi9lbnYgbm9kZVxuXG5pbXBvcnQgZnMgZnJvbSAnZnMtZXh0cmEnXG5pbXBvcnQgc2FkZSBmcm9tICdzYWRlJ1xuXG5pbXBvcnQgcGtnIGZyb20gJy4uL3BhY2thZ2UuanNvbidcblxuaW1wb3J0ICogYXMgbG9nZ2VyIGZyb20gJy4vbG9nJ1xuaW1wb3J0IHsgY3JlYXRlQ29uZmlnLCBnZXRDb25maWdGaWxlLCBFbnYgfSBmcm9tICcuL2NvbmZpZydcbmltcG9ydCB7IHdhdGNoIH0gZnJvbSAnLi93YXRjaCdcbmltcG9ydCB7IGJ1aWxkIH0gZnJvbSAnLi9idWlsZCdcbmltcG9ydCB7IHNlcnZlIH0gZnJvbSAnLi9zZXJ2ZSdcblxuY29uc3QgcHJvZyA9IHNhZGUoJ3ByZXN0YScpXG5jb25zdCBDT05GSUdfREVGQVVMVCA9ICdwcmVzdGEuY29uZmlnLmpzJ1xuXG5mdW5jdGlvbiByZWdpc3RlclJ1bnRpbWUob3B0aW9ucyA9IHt9KSB7XG4gIHJlcXVpcmUoJ21vZHVsZS1hbGlhcycpLmFkZEFsaWFzZXMoe1xuICAgICdAJzogcHJvY2Vzcy5jd2QoKSxcbiAgICAncHJlc3RhOmludGVybmFsJzogX19kaXJuYW1lLCAvLyB3aGVyZXZlciB0aGlzIGlzIHJ1bm5pbmcgZnJvbVxuICB9KVxuXG4gIHJlcXVpcmUoJ2VzYnVpbGQtcmVnaXN0ZXIvZGlzdC9ub2RlJykucmVnaXN0ZXIob3B0aW9ucylcbn1cblxucHJvZ1xuICAudmVyc2lvbihwa2cudmVyc2lvbilcbiAgLm9wdGlvbignLS1jb25maWcsIC1jJywgYFBhdGggdG8gYSBjb25maWcgZmlsZSBcdTIwMTQgZGVmYXVsdHMgdG8gJHtDT05GSUdfREVGQVVMVH1gKVxuICAub3B0aW9uKCctLW91dHB1dCwgLW8nLCBgU3BlY2lmeSBvdXRwdXQgZGlyZWN0b3J5IGZvciBidWlsdCBmaWxlcyBcdTIwMTQgZGVmYXVsdHMgdG8gLi9idWlsZGApXG4gIC5vcHRpb24oJy0tYXNzZXRzLCAtYScsIGBTcGVjaWZ5IHN0YXRpYyBhc3NldCBkaXJlY3RvcnkgXHUyMDE0IGRlZmF1bHRzIHRvIC4vcHVibGljYClcbiAgLm9wdGlvbignLS1kZWJ1ZywgLWQnLCBgRW5hYmxlIGRlYnVnIG1vZGUgKHByaW50cyBtb3JlIGxvZ3MpYClcblxucHJvZ1xuICAuY29tbWFuZCgnYnVpbGQnLCAnUmVuZGVyIGZpbGVzKHMpIHRvIG91dHB1dCBkaXJlY3RvcnkuJywgeyBkZWZhdWx0OiB0cnVlIH0pXG4gIC5leGFtcGxlKGBidWlsZGApXG4gIC5leGFtcGxlKGBidWlsZCBmaWxlcy8qKi8qLmpzYClcbiAgLmV4YW1wbGUoYGJ1aWxkIC1jICR7Q09ORklHX0RFRkFVTFR9YClcbiAgLmFjdGlvbihhc3luYyAob3B0cykgPT4ge1xuICAgIHJlZ2lzdGVyUnVudGltZSgpXG5cbiAgICBjb25zb2xlLmNsZWFyKClcblxuICAgIGNvbnN0IGNvbmZpZyA9IGNyZWF0ZUNvbmZpZyh7XG4gICAgICBlbnY6IEVudi5QUk9EVUNUSU9OLFxuICAgICAgY29uZmlnOiBnZXRDb25maWdGaWxlKG9wdHMuY29uZmlnLCB0cnVlKSxcbiAgICAgIGNsaToge1xuICAgICAgICAuLi5vcHRzLFxuICAgICAgICBmaWxlczogb3B0cy5fLFxuICAgICAgfSxcbiAgICB9KVxuXG4gICAgZnMuZW1wdHlEaXJTeW5jKGNvbmZpZy5vdXRwdXQpXG5cbiAgICBsb2dnZXIucmF3KGAke2xvZ2dlci5jb2xvcnMuYmx1ZSgncHJlc3RhIGJ1aWxkJyl9YClcbiAgICBsb2dnZXIubmV3bGluZSgpXG5cbiAgICBhd2FpdCBidWlsZChjb25maWcpXG4gIH0pXG5cbnByb2dcbiAgLmNvbW1hbmQoJ3dhdGNoJylcbiAgLm9wdGlvbignLS1uby1zZXJ2ZSwgLW4nLCBgRG8gbm90IHJ1biBsb2NhbCBkZXYgc2VydmVyLmAsIGZhbHNlKVxuICAuZGVzY3JpYmUoJ1dhdGNoIGFuZCBidWlsZCBmaWxlcyhzKSB0byBvdXRwdXQgZGlyZWN0b3J5JylcbiAgLmV4YW1wbGUoYHdhdGNoYClcbiAgLmV4YW1wbGUoYHdhdGNoIC4vZmlsZXMvKiovKi5qc2ApXG4gIC5leGFtcGxlKGB3YXRjaCAuL2ZpbGVzLyoqLyouanMgLW8gLi9vdXRgKVxuICAuZXhhbXBsZShgd2F0Y2ggLWMgJHtDT05GSUdfREVGQVVMVH1gKVxuICAuYWN0aW9uKGFzeW5jIChvcHRzKSA9PiB7XG4gICAgcmVnaXN0ZXJSdW50aW1lKClcblxuICAgIGNvbnNvbGUuY2xlYXIoKVxuXG4gICAgY29uc3QgY29uZmlnID0gY3JlYXRlQ29uZmlnKHtcbiAgICAgIGVudjogRW52LkRFVkVMT1BNRU5ULFxuICAgICAgY29uZmlnOiBnZXRDb25maWdGaWxlKG9wdHMuY29uZmlnKSxcbiAgICAgIGNsaToge1xuICAgICAgICAuLi5vcHRzLFxuICAgICAgICBmaWxlczogb3B0cy5fLFxuICAgICAgfSxcbiAgICB9KVxuXG4gICAgZnMuZW1wdHlEaXJTeW5jKGNvbmZpZy5vdXRwdXQpXG5cbiAgICBpZiAoIW9wdHMubikge1xuICAgICAgY29uc3Qgc2VydmVyID0gYXdhaXQgc2VydmUoY29uZmlnKVxuXG4gICAgICBsb2dnZXIucmF3KGAke2xvZ2dlci5jb2xvcnMuYmx1ZSgncHJlc3RhIGRldicpfSAtIGh0dHA6Ly9sb2NhbGhvc3Q6JHtzZXJ2ZXIucG9ydH1gKVxuICAgICAgbG9nZ2VyLm5ld2xpbmUoKVxuICAgIH0gZWxzZSB7XG4gICAgICBsb2dnZXIuaW5mbyh7XG4gICAgICAgIGxhYmVsOiAnZGV2JyxcbiAgICAgIH0pXG4gICAgICBsb2dnZXIubmV3bGluZSgpXG4gICAgfVxuXG4gICAgd2F0Y2goY29uZmlnKVxuICB9KVxuXG5wcm9nXG4gIC5jb21tYW5kKCdzZXJ2ZScpXG4gIC5kZXNjcmliZSgnU2VydmUgYnVpbHQgZmlsZXMuJylcbiAgLmV4YW1wbGUoYHNlcnZlYClcbiAgLmV4YW1wbGUoYHNlcnZlIC1vIC4vb3V0YClcbiAgLmV4YW1wbGUoYHdhdGNoIC1jICR7Q09ORklHX0RFRkFVTFR9YClcbiAgLmFjdGlvbihhc3luYyAob3B0cykgPT4ge1xuICAgIGNvbnNvbGUuY2xlYXIoKVxuXG4gICAgY29uc3QgY29uZmlnID0gY3JlYXRlQ29uZmlnKHtcbiAgICAgIGVudjogRW52LlBST0RVQ1RJT04sXG4gICAgICBjb25maWc6IGdldENvbmZpZ0ZpbGUob3B0cy5jb25maWcpLFxuICAgICAgY2xpOiBvcHRzLFxuICAgIH0pXG4gICAgY29uc3Qgc2VydmVyID0gYXdhaXQgc2VydmUoY29uZmlnKVxuXG4gICAgbG9nZ2VyLnJhdyhgJHtsb2dnZXIuY29sb3JzLmJsdWUoJ3ByZXN0YSBzZXJ2ZScpfSAtIGh0dHA6Ly9sb2NhbGhvc3Q6JHtzZXJ2ZXIucG9ydH1gKVxuICAgIGxvZ2dlci5uZXdsaW5lKClcbiAgfSlcblxucHJvZy5wYXJzZShwcm9jZXNzLmFyZ3YpXG4iLCAiaW1wb3J0IGMsIHsgS2xldXIgfSBmcm9tICdrbGV1cidcblxuaW1wb3J0IHsgZ2V0Q3VycmVudENvbmZpZywgRW52IH0gZnJvbSAnLi9jb25maWcnXG5cbmV4cG9ydCBlbnVtIExldmVscyB7XG4gIERlYnVnID0gJ2RlYnVnJyxcbiAgSW5mbyA9ICdpbmZvJyxcbiAgV2FybiA9ICd3YXJuJyxcbiAgRXJyID0gJ2Vycm9yJyxcbn1cblxuZXhwb3J0IHR5cGUgTWVzc2FnZSA9IHtcbiAgbGV2ZWw/OiBMZXZlbHNcbiAgbGFiZWw6IHN0cmluZyB8IG51bWJlclxuICBtZXNzYWdlPzogc3RyaW5nXG4gIGR1cmF0aW9uPzogc3RyaW5nIHwgbnVtYmVyXG4gIGVycm9yPzogRXJyb3Jcbn1cblxubGV0IGxvZ3M6IGFueVtdID0gW11cblxuY29uc3QgY29sb3JzID0ge1xuICBbTGV2ZWxzLkRlYnVnXTogJ21hZ2VudGEnLFxuICBbTGV2ZWxzLkluZm9dOiAnYmx1ZScsXG4gIFtMZXZlbHMuV2Fybl06ICd5ZWxsb3cnLFxuICBbTGV2ZWxzLkVycl06ICdyZWQnLFxufVxuXG5leHBvcnQgeyBjIGFzIGNvbG9ycyB9XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRMb2dzKCkge1xuICBpZiAoZ2V0Q3VycmVudENvbmZpZygpLmVudiAhPT0gRW52LlRFU1QpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludGVybmFsIG1ldGhvZCB3YXMgY2FsbGVkIG91dHNpZGUgdGVzdCBtb2RlJylcbiAgfVxuXG4gIHJldHVybiBsb2dzXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBsb2dnZXIobWVzc2FnZTogTWVzc2FnZSkge1xuICBpZiAocHJvY2Vzcy5lbnYuVEVTVElORykge1xuICAgIGxvZ3MucHVzaChtZXNzYWdlKVxuICB9IGVsc2Uge1xuICAgIGNvbnN0IGRlYnVnID0gZ2V0Q3VycmVudENvbmZpZygpLmRlYnVnXG4gICAgY29uc3QgY29udGV4dCA9IGdldEN1cnJlbnRDb25maWcoKS5lbnYgPT09IEVudi5QUk9EVUNUSU9OID8gJ3Byb2QnIDogJ2RldidcblxuICAgIGlmICghZGVidWcgJiYgbWVzc2FnZS5sZXZlbCA9PT0gTGV2ZWxzLkRlYnVnKSByZXR1cm5cblxuICAgIGNvbnNvbGUubG9nKFxuICAgICAgW1xuICAgICAgICBjLmdyYXkoY29udGV4dCksXG4gICAgICAgIGNbY29sb3JzW21lc3NhZ2UubGV2ZWwgfHwgJ2luZm8nXSBhcyBrZXlvZiBLbGV1cl0obWVzc2FnZS5sYWJlbCksXG4gICAgICAgIG1lc3NhZ2UubWVzc2FnZSxcbiAgICAgICAgbWVzc2FnZS5kdXJhdGlvbiA/IGMuZ3JheSgnKycgKyBtZXNzYWdlLmR1cmF0aW9uKSA6ICcnLFxuICAgICAgICBtZXNzYWdlLmVycm9yID8gYFxcblxcbiR7bWVzc2FnZS5lcnJvci5zdGFjayB8fCBtZXNzYWdlLmVycm9yfVxcblxcbmAgOiAnJyxcbiAgICAgIF1cbiAgICAgICAgLmZpbHRlcihCb29sZWFuKVxuICAgICAgICAuam9pbignICcpXG4gICAgKVxuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBkZWJ1ZyhtZXNzYWdlOiBNZXNzYWdlKSB7XG4gIGxvZ2dlcih7IGxldmVsOiBMZXZlbHMuRGVidWcsIC4uLm1lc3NhZ2UgfSlcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGluZm8obWVzc2FnZTogTWVzc2FnZSkge1xuICBsb2dnZXIoeyBsZXZlbDogTGV2ZWxzLkluZm8sIC4uLm1lc3NhZ2UgfSlcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHdhcm4obWVzc2FnZTogTWVzc2FnZSkge1xuICBsb2dnZXIoeyBsZXZlbDogTGV2ZWxzLldhcm4sIC4uLm1lc3NhZ2UgfSlcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGVycm9yKG1lc3NhZ2U6IE1lc3NhZ2UpIHtcbiAgbG9nZ2VyKHsgbGV2ZWw6IExldmVscy5FcnIsIC4uLm1lc3NhZ2UgfSlcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHJhdyguLi5hcmdzOiBhbnlbXSkge1xuICBpZiAoZ2V0Q3VycmVudENvbmZpZygpLmVudiA9PT0gRW52LlRFU1QpIHtcbiAgICBsb2dzLnB1c2goYXJncylcbiAgfSBlbHNlIHtcbiAgICBjb25zb2xlLmxvZyguLi5hcmdzKVxuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBuZXdsaW5lKCkge1xuICBpZiAoZ2V0Q3VycmVudENvbmZpZygpLmVudiA9PT0gRW52LlRFU1QpIHJldHVyblxuICBjb25zb2xlLmxvZygnJylcbn1cbiIsICJpbXBvcnQgcGF0aCBmcm9tICdwYXRoJ1xuXG5pbXBvcnQgKiBhcyBsb2dnZXIgZnJvbSAnLi9sb2cnXG5pbXBvcnQgeyBjcmVhdGVFbWl0dGVyIH0gZnJvbSAnLi9jcmVhdGVFbWl0dGVyJ1xuXG5pbXBvcnQgdHlwZSB7IFByZXN0YSwgQ29uZmlnLCBDTEkgfSBmcm9tICcuLidcblxuY29uc3QgZGVmYXVsdENvbmZpZ0ZpbGVwYXRoID0gJ3ByZXN0YS5jb25maWcuanMnXG5cbmV4cG9ydCBlbnVtIEVudiB7XG4gIFBST0RVQ1RJT04gPSAncHJvZHVjdGlvbicsXG4gIERFVkVMT1BNRU5UID0gJ2RldmVsb3BtZW50JyxcbiAgVEVTVCA9ICd0ZXN0Jyxcbn1cblxuY29uc3QgZGVmYXVsdENvbmZpZyA9IHtcbiAgcGlkOiBwcm9jZXNzLnBpZCxcbiAgY3dkOiBwcm9jZXNzLmN3ZCgpLFxuICBlbnY6IEVudi5URVNULFxuICBkZWJ1ZzogZmFsc2UsXG59IGFzIFByZXN0YVxuXG5mdW5jdGlvbiBzZXRDdXJyZW50Q29uZmlnKGNvbmZpZzogUHJlc3RhKTogUHJlc3RhIHtcbiAgLy8gQHRzLWlnbm9yZVxuICBnbG9iYWwuX19wcmVzdGFfXyA9IGNvbmZpZ1xuICByZXR1cm4gY29uZmlnXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRDdXJyZW50Q29uZmlnKCk6IFByZXN0YSB7XG4gIC8vIEB0cy1pZ25vcmVcbiAgaWYgKCFnbG9iYWwuX19wcmVzdGFfXykge1xuICAgIHNldEN1cnJlbnRDb25maWcoZGVmYXVsdENvbmZpZylcbiAgfVxuXG4gIC8vIEB0cy1pZ25vcmVcbiAgcmV0dXJuIGdsb2JhbC5fX3ByZXN0YV9fXG59XG5cbmZ1bmN0aW9uIHJlc29sdmVBYnNvbHV0ZVBhdGhzKGNvbmZpZzogQ29uZmlnKSB7XG4gIGNvbnN0IGN3ZCA9IHByb2Nlc3MuY3dkKClcblxuICBpZiAoY29uZmlnLmZpbGVzKSBjb25maWcuZmlsZXMgPSAoW10gYXMgc3RyaW5nW10pLmNvbmNhdChjb25maWcuZmlsZXMpLm1hcCgocCkgPT4gcGF0aC5yZXNvbHZlKGN3ZCwgcCkpXG4gIGlmIChjb25maWcub3V0cHV0KSBjb25maWcub3V0cHV0ID0gcGF0aC5yZXNvbHZlKGN3ZCwgY29uZmlnLm91dHB1dClcbiAgaWYgKGNvbmZpZy5hc3NldHMpIGNvbmZpZy5hc3NldHMgPSBwYXRoLnJlc29sdmUoY3dkLCBjb25maWcuYXNzZXRzKVxuICByZXR1cm4gY29uZmlnXG59XG5cbi8qKlxuICogQHByaXZhdGVcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIF9jbGVhckN1cnJlbnRDb25maWcoKSB7XG4gIC8vIEB0cy1pZ25vcmVcbiAgZ2xvYmFsLl9fcHJlc3RhX18gPSB7XG4gICAgcGlkOiBwcm9jZXNzLnBpZCxcbiAgICBjd2Q6IHByb2Nlc3MuY3dkKCksXG4gICAgZW52OiBFbnYuVEVTVCxcbiAgfVxufVxuXG4vKipcbiAqIEZldGNoIGEgY29uZmlnIGZpbGUuIElmIG9uZSB3YXMgc3BlY2lmaWVkIGJ5IHRoZSB1c2VyLCBsZXQgdGhlbSBrbm93IGlmXG4gKiBhbnl0aGluZyBnb2VzIHdyb25nLiBPdXRzaWRlIHdhdGNoIG1vZGUsIHRoaXMgc2hvdWxkIGV4aXQoMSkgaWYgdGhlIHVzZXJcbiAqIHByb3ZpZGVkIGEgY29uZmlnIGFuZCB0aGVyZSB3YXMgYW4gZXJyb3JcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldENvbmZpZ0ZpbGUoZmlsZXBhdGg6IHN0cmluZywgc2hvdWxkRXhpdDogYm9vbGVhbiA9IGZhbHNlKSB7XG4gIHRyeSB7XG4gICAgcmV0dXJuIHJlcXVpcmUocGF0aC5yZXNvbHZlKGZpbGVwYXRoIHx8IGRlZmF1bHRDb25maWdGaWxlcGF0aCkpXG4gIH0gY2F0Y2ggKGUpIHtcbiAgICBsb2dnZXIuZXJyb3Ioe1xuICAgICAgbGFiZWw6ICdlcnJvcicsXG4gICAgICBlcnJvcjogZSxcbiAgICB9KVxuXG4gICAgLy8gd2UncmUgbm90IGluIHdhdGNoIG1vZGUsIGV4aXRcbiAgICBpZiAoc2hvdWxkRXhpdCkgcHJvY2Vzcy5leGl0KDEpXG5cbiAgICByZXR1cm4ge31cbiAgfVxufVxuXG4vKipcbiAqIENyZWF0ZXMgYSBuZXcgaW5zdGFuY2UgX3dpdGhvdXRfIGFueSB2YWx1ZXMgcHJvdmlkZWQgYnkgdGhlIGNvbmZpZyBmaWxlLlxuICogVGhpcyBpcyB1c2VkIHdoZW4gdGhlIHVzZXIgZGVsZXRlcyB0aGVpciBjb25maWcgZmlsZS5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJlbW92ZUNvbmZpZ1ZhbHVlcygpIHtcbiAgbG9nZ2VyLmRlYnVnKHtcbiAgICBsYWJlbDogJ2RlYnVnJyxcbiAgICBtZXNzYWdlOiBgY29uZmlnIGZpbGUgdmFsdWVzIGNsZWFyZWRgLFxuICB9KVxuXG4gIHJldHVybiBzZXRDdXJyZW50Q29uZmlnKFxuICAgIGNyZWF0ZUNvbmZpZyh7XG4gICAgICAuLi5nZXRDdXJyZW50Q29uZmlnKCksXG4gICAgICBjb25maWc6IHt9LFxuICAgIH0pXG4gIClcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUNvbmZpZyh7XG4gIGVudiA9IGdldEN1cnJlbnRDb25maWcoKS5lbnYsXG4gIGNvbmZpZyA9IHt9LFxuICBjbGkgPSB7fSxcbn06IHtcbiAgZW52PzogRW52XG4gIGNvbmZpZz86IFBhcnRpYWw8Q29uZmlnPlxuICBjbGk/OiBQYXJ0aWFsPENMST5cbn0pIHtcbiAgY29uZmlnID0gcmVzb2x2ZUFic29sdXRlUGF0aHMoeyAuLi5jb25maWcgfSkgLy8gY2xvbmUgcmVhZC1vbmx5IG9ialxuICBjbGkgPSByZXNvbHZlQWJzb2x1dGVQYXRocyh7IC4uLmNsaSB9KVxuXG4gIC8vIGNvbWJpbmVkIGNvbmZpZywgcHJlZmVyZW5jZSB0byBDTEkgYXJnc1xuICBjb25zdCBtZXJnZWQgPSB7XG4gICAgb3V0cHV0OiBjbGkub3V0cHV0IHx8IGNvbmZpZy5vdXRwdXQgfHwgcGF0aC5yZXNvbHZlKCdidWlsZCcpLFxuICAgIGFzc2V0czogY2xpLmFzc2V0cyB8fCBjb25maWcuYXNzZXRzIHx8IHBhdGgucmVzb2x2ZSgncHVibGljJyksXG4gICAgZmlsZXM6IGNsaS5maWxlcyAmJiBjbGkuZmlsZXMubGVuZ3RoID8gY2xpLmZpbGVzIDogY29uZmlnLmZpbGVzID8gKFtdIGFzIHN0cmluZ1tdKS5jb25jYXQoY29uZmlnLmZpbGVzKSA6IFtdLFxuICB9XG5cbiAgLy8gc2V0IGluc3RhbmNlXG4gIGNvbnN0IGN1cnJlbnQgPSBzZXRDdXJyZW50Q29uZmlnKHtcbiAgICAuLi5nZXRDdXJyZW50Q29uZmlnKCksXG4gICAgLi4ubWVyZ2VkLCAvLyBvdmVyd3JpdGVzIGV2ZXJ5IHRpbWVcbiAgICBlbnYsXG4gICAgZGVidWc6IGNsaS5kZWJ1ZyB8fCBnZXRDdXJyZW50Q29uZmlnKCkuZGVidWcsXG4gICAgY3dkOiBwcm9jZXNzLmN3ZCgpLFxuICAgIGNvbmZpZ0ZpbGVwYXRoOiBwYXRoLnJlc29sdmUoY2xpLmNvbmZpZyB8fCBkZWZhdWx0Q29uZmlnRmlsZXBhdGgpLFxuICAgIGZ1bmN0aW9uc091dHB1dERpcjogcGF0aC5qb2luKG1lcmdlZC5vdXRwdXQsICdmdW5jdGlvbnMnKSxcbiAgICBzdGF0aWNPdXRwdXREaXI6IHBhdGguam9pbihtZXJnZWQub3V0cHV0LCAnc3RhdGljJyksXG4gICAgcm91dGVzTWFuaWZlc3Q6IHBhdGguam9pbihtZXJnZWQub3V0cHV0LCAncm91dGVzLmpzb24nKSxcbiAgICBldmVudHM6IGNyZWF0ZUVtaXR0ZXIoKSxcbiAgfSlcblxuICBpZiAoY29uZmlnLnBsdWdpbnMpIHtcbiAgICBjb25maWcucGx1Z2lucy5tYXAocCA9PiB7XG4gICAgICB0cnkge1xuICAgICAgICBwKClcbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgbG9nZ2VyLmVycm9yKHtcbiAgICAgICAgICBsYWJlbDogJ2Vycm9yJyxcbiAgICAgICAgICBlcnJvcjogZVxuICAgICAgICB9KVxuICAgICAgfVxuICAgIH0pXG4gIH1cblxuICBsb2dnZXIuZGVidWcoe1xuICAgIGxhYmVsOiAnZGVidWcnLFxuICAgIG1lc3NhZ2U6IGBjb25maWcgY3JlYXRlZCAke0pTT04uc3RyaW5naWZ5KGN1cnJlbnQpfWAsXG4gIH0pXG5cbiAgcmV0dXJuIGN1cnJlbnRcbn1cbiIsICJ0eXBlIGNhbGxhYmxlID0gKC4uLmFyZ3M6IGFueVtdKSA9PiB2b2lkXG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVFbWl0dGVyKCkge1xuICBsZXQgZXZlbnRzOiB7IFtldmVudDogc3RyaW5nXTogY2FsbGFibGVbXSB9ID0ge31cblxuICBmdW5jdGlvbiBlbWl0KGV2OiBzdHJpbmcsIC4uLmFyZ3M6IGFueVtdKTogdm9pZCB7XG4gICAgZXZlbnRzW2V2XSA/IGV2ZW50c1tldl0ubWFwKChmbjogY2FsbGFibGUpID0+IGZuKC4uLmFyZ3MpKSA6IFtdXG4gIH1cblxuICBmdW5jdGlvbiBvbihldjogc3RyaW5nLCBmbjogKC4uLmFyZ3M6IGFueVtdKSA9PiB2b2lkKSB7XG4gICAgZXZlbnRzW2V2XSA9IGV2ZW50c1tldl0gPyBldmVudHNbZXZdLmNvbmNhdChmbikgOiBbZm5dXG4gICAgcmV0dXJuICgpID0+IGV2ZW50c1tldl0uc3BsaWNlKGV2ZW50c1tldl0uaW5kZXhPZihmbiksIDEpXG4gIH1cblxuICBmdW5jdGlvbiBjbGVhcigpIHtcbiAgICBldmVudHMgPSB7fVxuICB9XG5cbiAgZnVuY3Rpb24gbGlzdGVuZXJzKGV2OiBzdHJpbmcpIHtcbiAgICByZXR1cm4gZXZlbnRzW2V2XSB8fCBbXVxuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBlbWl0LFxuICAgIG9uLFxuICAgIGNsZWFyLFxuICAgIGxpc3RlbmVycyxcbiAgfVxufVxuIiwgImltcG9ydCBmcyBmcm9tICdmcy1leHRyYSdcbi8vIEB0cy1pZ25vcmVcbmltcG9ydCBncmFwaCBmcm9tICd3YXRjaC1kZXBlbmRlbmN5LWdyYXBoJ1xuaW1wb3J0IGNob2tpZGFyIGZyb20gJ2Nob2tpZGFyJ1xuaW1wb3J0IG1hdGNoIGZyb20gJ3BpY29tYXRjaCdcblxuaW1wb3J0IHsgb3V0cHV0TGFtYmRhcyB9IGZyb20gJy4vb3V0cHV0TGFtYmRhcydcbmltcG9ydCAqIGFzIGxvZ2dlciBmcm9tICcuL2xvZydcbmltcG9ydCB7IGdldEZpbGVzLCBpc1N0YXRpYywgaXNEeW5hbWljIH0gZnJvbSAnLi9nZXRGaWxlcydcbmltcG9ydCB7IHJlbmRlclN0YXRpY0VudHJpZXMgfSBmcm9tICcuL3JlbmRlclN0YXRpY0VudHJpZXMnXG5pbXBvcnQgeyB0aW1lciB9IGZyb20gJy4vdGltZXInXG5pbXBvcnQgeyBjcmVhdGVDb25maWcsIHJlbW92ZUNvbmZpZ1ZhbHVlcywgZ2V0Q29uZmlnRmlsZSB9IGZyb20gJy4vY29uZmlnJ1xuaW1wb3J0IHsgYnVpbHRTdGF0aWNGaWxlcyB9IGZyb20gJy4vYnVpbHRTdGF0aWNGaWxlcydcbmltcG9ydCB7IHJlbW92ZUJ1aWx0U3RhdGljRmlsZSB9IGZyb20gJy4vcmVtb3ZlQnVpbHRTdGF0aWNGaWxlJ1xuXG5pbXBvcnQgdHlwZSB7IFByZXN0YSB9IGZyb20gJy4uJ1xuXG4vKlxuICogV3JhcHMgb3V0cHV0TGFtYmRhcyBmb3IgbG9nZ2luZ1xuICovXG5mdW5jdGlvbiB1cGRhdGVMYW1iZGFzKGlucHV0czogc3RyaW5nW10sIGNvbmZpZzogUHJlc3RhKSB7XG4gIGNvbnN0IHRpbWUgPSB0aW1lcigpXG5cbiAgLy8gYWx3YXlzIHdyaXRlIHRoaXMsIGV2ZW4gaWYgaW5wdXRzID0gW11cbiAgb3V0cHV0TGFtYmRhcyhpbnB1dHMsIGNvbmZpZylcblxuICAvLyBpZiB1c2VyIGFjdHVhbGx5IGhhcyByb3V0ZXMgY29uZmlndXJlZCwgZ2l2ZSBmZWVkYmFja1xuICBpZiAoaW5wdXRzLmxlbmd0aCkge1xuICAgIGxvZ2dlci5pbmZvKHtcbiAgICAgIGxhYmVsOiAnYnVpbHQnLFxuICAgICAgbWVzc2FnZTogYGxhbWJkYXNgLFxuICAgICAgZHVyYXRpb246IHRpbWUoKSxcbiAgICB9KVxuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB3YXRjaChjb25maWc6IFByZXN0YSkge1xuICAvKlxuICAgKiBHZXQgZmlsZXMgdGhhdCBtYXRjaCBzdGF0aWMvZHluYW1pYyBwYXR0ZXJzIGF0IHN0YXJ0dXBcbiAgICovXG4gIGxldCBmaWxlcyA9IGdldEZpbGVzKGNvbmZpZylcbiAgbGV0IGhhc0NvbmZpZ0ZpbGUgPSBmcy5leGlzdHNTeW5jKGNvbmZpZy5jb25maWdGaWxlcGF0aClcblxuICBpZiAoIWZpbGVzLmxlbmd0aCkge1xuICAgIGxvZ2dlci53YXJuKHtcbiAgICAgIGxhYmVsOiAncGF0aHMnLFxuICAgICAgbWVzc2FnZTogJ25vIGZpbGVzIGNvbmZpZ3VyZWQnLFxuICAgIH0pXG4gIH1cblxuICAvKlxuICAgKiBDcmVhdGUgaW5pdGlhbCBkeW5hbWljIGVudHJ5IHJlZ2FyZGxlc3Mgb2YgaWYgdGhlIHVzZXIgaGFzIHJvdXRlcywgYmMgd2VcbiAgICogbmVlZCB0aGlzIGZpbGUgdG8gc2VydmUgNDA0IGxvY2FsbHlcbiAgICovXG4gIHVwZGF0ZUxhbWJkYXMoZmlsZXMuZmlsdGVyKGlzRHluYW1pYyksIGNvbmZpZylcblxuICAvKlxuICAgKiBTZXQgdXAgYWxsIHdhdGNoZXJzXG4gICAqL1xuICBjb25zdCBmaWxlV2F0Y2hlciA9IGdyYXBoKHsgYWxpYXM6IHsgJ0AnOiBjb25maWcuY3dkIH0gfSlcbiAgY29uc3QgZ2xvYmFsV2F0Y2hlciA9IGNob2tpZGFyLndhdGNoKGNvbmZpZy5jd2QsIHtcbiAgICBpZ25vcmVJbml0aWFsOiB0cnVlLFxuICAgIGlnbm9yZWQ6IFtjb25maWcub3V0cHV0LCBjb25maWcuYXNzZXRzXSxcbiAgfSlcblxuICAvKlxuICAgKiBPbiBhIGNvbmZpZyB1cGRhdGUsIHRoZSB1c2VyIG1heSBoYXZlIHBhc3NlZCBpbiBhIG5ldyBgZmlsZXNgIGFycmF5IG9yXG4gICAqIG90aGVyIGdsb2JhbCBjb25maWcgcmVxdWlyZWQgYnkgYWxsIGZpbGVzLCBzbyB3ZSBuZWVkIHRvIHJlLWZldGNoIGFsbFxuICAgKiBmaWxlcyBhbmQgcmVidWlsZCBldmVyeXRoaW5nLlxuICAgKi9cbiAgYXN5bmMgZnVuY3Rpb24gaGFuZGxlQ29uZmlnVXBkYXRlKCkge1xuICAgIGZpbGVzID0gZ2V0RmlsZXMoY29uZmlnKVxuICAgIGF3YWl0IHJlbmRlclN0YXRpY0VudHJpZXMoZmlsZXMuZmlsdGVyKGlzU3RhdGljKSwgY29uZmlnKVxuICAgIHVwZGF0ZUxhbWJkYXMoZmlsZXMuZmlsdGVyKGlzRHluYW1pYyksIGNvbmZpZylcbiAgfVxuXG4gIC8qXG4gICAqIE9uIGEgY2hhbmdlZCBmaWxlLCB3ZSBjYW4ganVzdCByZW5kZXIgaXRcbiAgICovXG4gIGFzeW5jIGZ1bmN0aW9uIGhhbmRsZUZpbGVDaGFuZ2UoZmlsZTogc3RyaW5nKSB7XG4gICAgLy8gcmVuZGVyIGp1c3QgZmlsZSB0aGF0IGNoYW5nZWRcbiAgICBpZiAoaXNTdGF0aWMoZmlsZSkpIHtcbiAgICAgIGF3YWl0IHJlbmRlclN0YXRpY0VudHJpZXMoW2ZpbGVdLCBjb25maWcpXG4gICAgfVxuXG4gICAgLy8gdXBkYXRlIGR5bmFtaWMgZW50cnkgd2l0aCBBTEwgZHluYW1pYyBmaWxlc1xuICAgIGlmIChpc0R5bmFtaWMoZmlsZSkpIHtcbiAgICAgIHVwZGF0ZUxhbWJkYXMoZmlsZXMuZmlsdGVyKGlzRHluYW1pYyksIGNvbmZpZylcbiAgICB9XG5cbiAgICBjb25maWcuZXZlbnRzLmVtaXQoJ3JlZnJlc2gnKVxuICAgIGNvbmZpZy5ldmVudHMuZW1pdCgnZG9uZScsIFtmaWxlXSlcbiAgfVxuXG4gIGZpbGVXYXRjaGVyLm9uKCdyZW1vdmUnLCAoW2lkXTogc3RyaW5nW10pID0+IHtcbiAgICBsb2dnZXIuZGVidWcoe1xuICAgICAgbGFiZWw6ICd3YXRjaCcsXG4gICAgICBtZXNzYWdlOiBgZmlsZVdhdGNoZXIgLSByZW1vdmVkICR7aWR9YCxcbiAgICB9KVxuXG4gICAgLy8gcmVtb3ZlIGZyb20gbG9jYWwgaGFzaFxuICAgIGZpbGVzLnNwbGljZShmaWxlcy5pbmRleE9mKGlkKSwgMSlcblxuICAgIC8vIHVwZGF0ZSB0aGlzIHJlZ2FyZGxlc3MsIG5vdCBzdXJlIGlmIFtpZF0gd2FzIGR5bmFtaWMgb3Igc3RhdGljXG4gICAgdXBkYXRlTGFtYmRhcyhmaWxlcy5maWx0ZXIoaXNEeW5hbWljKSwgY29uZmlnKVxuXG4gICAgLy8gaWYgaXQgd2FzIGNvbmZpZywgd2UgZ290dGEgZG8gYSByZXN0YXJ0XG4gICAgaWYgKGlkID09PSBjb25maWcuY29uZmlnRmlsZXBhdGgpIHtcbiAgICAgIC8vIGZpbHRlciBvdXQgdmFsdWVzIGZyb20gdGhlIGNvbmZpZyBmaWxlXG4gICAgICBjb25maWcgPSByZW1vdmVDb25maWdWYWx1ZXMoKVxuXG4gICAgICAvLyByZXNldCB0aGlzIVxuICAgICAgaGFzQ29uZmlnRmlsZSA9IGZhbHNlXG5cbiAgICAgIGhhbmRsZUNvbmZpZ1VwZGF0ZSgpXG4gICAgfVxuXG4gICAgOyhidWlsdFN0YXRpY0ZpbGVzW2lkXSB8fCBbXSkuZm9yRWFjaCgoZmlsZSkgPT4gcmVtb3ZlQnVpbHRTdGF0aWNGaWxlKGZpbGUsIGNvbmZpZykpXG5cbiAgICBjb25maWcuZXZlbnRzLmVtaXQoJ3JlbW92ZScsIGlkKVxuICB9KVxuXG4gIGZpbGVXYXRjaGVyLm9uKCdjaGFuZ2UnLCAoW2lkXTogc3RyaW5nW10pID0+IHtcbiAgICBsb2dnZXIuZGVidWcoe1xuICAgICAgbGFiZWw6ICd3YXRjaCcsXG4gICAgICBtZXNzYWdlOiBgZmlsZVdhdGNoZXIgLSBjaGFuZ2VkICR7aWR9YCxcbiAgICB9KVxuXG4gICAgaWYgKGlkID09PSBjb25maWcuY29uZmlnRmlsZXBhdGgpIHtcbiAgICAgIC8vIGNsZWFyIGNvbmZpZyBmaWxlIGZvciByZS1yZXF1aXJlXG4gICAgICBkZWxldGUgcmVxdWlyZS5jYWNoZVtjb25maWcuY29uZmlnRmlsZXBhdGhdXG5cbiAgICAgIHRyeSB7XG4gICAgICAgIC8vIG1lcmdlIGluIG5ldyB2YWx1ZXMgZnJvbSBjb25maWcgZmlsZVxuICAgICAgICBjb25maWcgPSBjcmVhdGVDb25maWcoe1xuICAgICAgICAgIGNvbmZpZzogZ2V0Q29uZmlnRmlsZShjb25maWcuY29uZmlnRmlsZXBhdGgpLFxuICAgICAgICB9KVxuXG4gICAgICAgIGhhbmRsZUNvbmZpZ1VwZGF0ZSgpXG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGxvZ2dlci5lcnJvcih7XG4gICAgICAgICAgbGFiZWw6ICdlcnJvcicsXG4gICAgICAgICAgZXJyb3I6IGUsXG4gICAgICAgIH0pXG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGhhbmRsZUZpbGVDaGFuZ2UoaWQpXG4gICAgfVxuXG4gICAgY29uZmlnLmV2ZW50cy5lbWl0KCdjaGFuZ2UnLCBpZClcbiAgfSlcblxuICBmaWxlV2F0Y2hlci5vbignZXJyb3InLCAoZTogRXJyb3IpID0+IHtcbiAgICBsb2dnZXIuZXJyb3Ioe1xuICAgICAgbGFiZWw6ICdlcnJvcicsXG4gICAgICBlcnJvcjogZSxcbiAgICB9KVxuICB9KVxuXG4gIC8qXG4gICAqIGdsb2JhbFdhdGNoZXIgd2F0Y2hlcyB0aGUgcmF3IGZpbGUgZ2xvYnMgcGFzc2VkIHRvIHRoZSBDTEkgb3IgYXMgYGZpbGVzYFxuICAgKiBpbiB0aGUgY29uZmlnLiBJZiBjaGVja3Mgb24gYWRkL2NoYW5nZSB0byBzZWUgaWYgYSBmaWxlIHNob3VsZCBiZSB1cGdyYWRlZFxuICAgKiB0byBhIGEgUHJlc3RhIHNvdXJjZSBmaWxlLCBhbmQgYWRkZWQgdG8gdGhlIGZpbGVXYXRjaGVyLiBJdCBhbHNvIHdhdGNoZXNcbiAgICogZm9yIGFkZGl0aW9uIG9mIGEgY29uZmlnIGZpbGUuXG4gICAqL1xuICBnbG9iYWxXYXRjaGVyLm9uKCdhbGwnLCBhc3luYyAoZXZlbnQsIGZpbGUpID0+IHtcbiAgICAvLyBpZ25vcmUgZXZlbnRzIGhhbmRsZWQgYnkgd2RnLCBvciBhbnkgZGlyZWN0b3J5IGV2ZW50c1xuICAgIGlmICghL2FkZHxjaGFuZ2UvLnRlc3QoZXZlbnQpIHx8ICFmcy5leGlzdHNTeW5jKGZpbGUpIHx8IGZzLmxzdGF0U3luYyhmaWxlKS5pc0RpcmVjdG9yeSgpKSByZXR1cm5cblxuICAgIC8vIGlmIGEgZmlsZSBjaGFuZ2UgbWF0Y2hlcyBhbnkgcGFnZXMgZ2xvYnNcbiAgICBpZiAobWF0Y2goY29uZmlnLmZpbGVzKShmaWxlKSAmJiAhZmlsZXMuaW5jbHVkZXMoZmlsZSkpIHtcbiAgICAgIGxvZ2dlci5kZWJ1Zyh7XG4gICAgICAgIGxhYmVsOiAnd2F0Y2gnLFxuICAgICAgICBtZXNzYWdlOiBgZ2xvYmFsV2F0Y2hlciAtIGFkZCAke2ZpbGV9YCxcbiAgICAgIH0pXG5cbiAgICAgIGZpbGVzLnB1c2goZmlsZSlcblxuICAgICAgZmlsZVdhdGNoZXIuYWRkKGZpbGUpXG5cbiAgICAgIGhhbmRsZUZpbGVDaGFuZ2UoZmlsZSlcbiAgICB9XG5cbiAgICAvLyBpZiBmaWxlIG1hdGNoZXMgY29uZmlnIGZpbGUgYW5kIHdlIGRvbid0IGFscmVhZHkgaGF2ZSBvbmVcbiAgICBpZiAoZmlsZSA9PT0gY29uZmlnLmNvbmZpZ0ZpbGVwYXRoICYmICFoYXNDb25maWdGaWxlKSB7XG4gICAgICBsb2dnZXIuZGVidWcoe1xuICAgICAgICBsYWJlbDogJ3dhdGNoJyxcbiAgICAgICAgbWVzc2FnZTogYGdsb2JhbFdhdGNoZXIgLSBhZGQgY29uZmlnIGZpbGUgJHtmaWxlfWAsXG4gICAgICB9KVxuXG4gICAgICBmaWxlV2F0Y2hlci5hZGQoY29uZmlnLmNvbmZpZ0ZpbGVwYXRoKVxuXG4gICAgICB0cnkge1xuICAgICAgICAvLyBtZXJnZSBpbiBuZXcgdmFsdWVzIGZyb20gY29uZmlnIGZpbGVcbiAgICAgICAgY29uZmlnID0gY3JlYXRlQ29uZmlnKHtcbiAgICAgICAgICBjb25maWc6IGdldENvbmZpZ0ZpbGUoY29uZmlnLmNvbmZpZ0ZpbGVwYXRoKSxcbiAgICAgICAgfSlcblxuICAgICAgICBoYXNDb25maWdGaWxlID0gdHJ1ZVxuXG4gICAgICAgIGhhbmRsZUNvbmZpZ1VwZGF0ZSgpXG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGxvZ2dlci5lcnJvcih7XG4gICAgICAgICAgbGFiZWw6ICdlcnJvcicsXG4gICAgICAgICAgZXJyb3I6IGUsXG4gICAgICAgIH0pXG4gICAgICB9XG4gICAgfVxuXG4gICAgY29uZmlnLmV2ZW50cy5lbWl0KCdhZGQnLCBmaWxlKVxuICB9KVxuXG4gIC8qKlxuICAgKiBJbml0IHdhdGNoaW5nIGFmdGVyIGV2ZW50IHN1YnNjcmlwdGlvbnNcbiAgICovXG4gIGZpbGVXYXRjaGVyLmFkZChmaWxlcylcbiAgaWYgKGhhc0NvbmZpZ0ZpbGUpIGZpbGVXYXRjaGVyLmFkZChjb25maWcuY29uZmlnRmlsZXBhdGgpXG5cbiAgLyoqXG4gICAqIFByaW1lIGZpbGVzIHRvIGNoZWNrIGZvciBlcnJvcnMgb24gc3RhcnR1cCBhbmQgcmVnaXN0ZXIgYW55IHBsdWdpbnNcbiAgICovXG4gIHRyeSB7XG4gICAgZmlsZXMubWFwKHJlcXVpcmUpXG4gIH0gY2F0Y2ggKGUpIHtcbiAgICBsb2dnZXIuZXJyb3Ioe1xuICAgICAgbGFiZWw6ICdlcnJvcicsXG4gICAgICBlcnJvcjogZSxcbiAgICB9KVxuICB9XG59XG4iLCAiaW1wb3J0IGZzIGZyb20gJ2ZzLWV4dHJhJ1xuaW1wb3J0IHBhdGggZnJvbSAncGF0aCdcbmltcG9ydCByc29ydCBmcm9tICdyb3V0ZS1zb3J0J1xuXG5pbXBvcnQgeyBFbnYgfSBmcm9tICcuL2NvbmZpZydcbmltcG9ydCB7IGhhc2hDb250ZW50IH0gZnJvbSAnLi9oYXNoQ29udGVudCdcbmltcG9ydCAqIGFzIGxvZ2dlciBmcm9tICcuL2xvZydcblxuaW1wb3J0IHR5cGUgeyBQcmVzdGEgfSBmcm9tICcuLidcblxuZXhwb3J0IGZ1bmN0aW9uIG91dHB1dExhbWJkYShpbnB1dDogc3RyaW5nLCBjb25maWc6IFByZXN0YSk6IFtzdHJpbmcsIHN0cmluZ10ge1xuICBjb25zdCB7IHJvdXRlIH0gPSByZXF1aXJlKGlucHV0KVxuICBjb25zdCBuYW1lID0gcGF0aC5iYXNlbmFtZShpbnB1dCkuc3BsaXQoJy4nKS5yZXZlcnNlKCkuc2xpY2UoMSkucmV2ZXJzZSgpLmpvaW4oJy4nKVxuICBjb25zdCBvdXRwdXQgPSBwYXRoLmpvaW4oXG4gICAgY29uZmlnLmZ1bmN0aW9uc091dHB1dERpcixcbiAgICBjb25maWcuZW52ID09PSBFbnYuUFJPRFVDVElPTiA/IG5hbWUgKyAnLScgKyBoYXNoQ29udGVudChmcy5yZWFkRmlsZVN5bmMoaW5wdXQsICd1dGY4JykpICsgJy5qcycgOiBuYW1lICsgJy5qcydcbiAgKVxuXG4gIGxvZ2dlci5kZWJ1Zyh7XG4gICAgbGFiZWw6ICdkZWJ1ZycsXG4gICAgbWVzc2FnZTogYGdlbmVyYXRpbmcgJHtuYW1lfSBsYW1iZGFgLFxuICB9KVxuXG4gIC8vIGltcG9ydGFudCBmb3Igd2F0Y2ggdGFza1xuICBkZWxldGUgcmVxdWlyZS5jYWNoZVtpbnB1dF1cbiAgZGVsZXRlIHJlcXVpcmUuY2FjaGVbb3V0cHV0XVxuXG4gIGZzLm91dHB1dEZpbGVTeW5jKFxuICAgIG91dHB1dCxcbiAgICBgaW1wb3J0IHsgd3JhcEhhbmRsZXIgfSBmcm9tICdwcmVzdGEnO1xuaW1wb3J0ICogYXMgZmlsZSBmcm9tICcke2lucHV0fSc7XG5leHBvcnQgY29uc3Qgcm91dGUgPSBmaWxlLnJvdXRlXG5leHBvcnQgY29uc3QgaGFuZGxlciA9IHdyYXBIYW5kbGVyKGZpbGUpYFxuICApXG5cbiAgcmV0dXJuIFtyb3V0ZSwgb3V0cHV0XVxufVxuXG5leHBvcnQgZnVuY3Rpb24gb3V0cHV0TGFtYmRhcyhpbnB1dHM6IHN0cmluZ1tdLCBjb25maWc6IFByZXN0YSkge1xuICBjb25zdCBsYW1iZGFzID0gaW5wdXRzXG4gICAgLm1hcCgoaW5wdXQpID0+IHtcbiAgICAgIHRyeSB7XG4gICAgICAgIHJldHVybiBvdXRwdXRMYW1iZGEoaW5wdXQsIGNvbmZpZylcbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgbG9nZ2VyLmVycm9yKHtcbiAgICAgICAgICBsYWJlbDogJ2Vycm9yJyxcbiAgICAgICAgICBlcnJvcjogZSxcbiAgICAgICAgfSlcbiAgICAgICAgcmV0dXJuIG51bGxcbiAgICAgIH1cbiAgICB9KVxuICAgIC5maWx0ZXIoQm9vbGVhbikgYXMgW3N0cmluZywgc3RyaW5nXVtdXG5cbiAgY29uc3Qgc29ydGVkID0gcnNvcnQobGFtYmRhcy5tYXAoKGwpID0+IGxbMF0pKVxuICBjb25zdCBtYW5pZmVzdDogeyBbcm91dGU6IHN0cmluZ106IHN0cmluZyB9ID0ge31cblxuICBmb3IgKGNvbnN0IHJvdXRlIG9mIHNvcnRlZCkge1xuICAgIGNvbnN0IG1hdGNoID0gbGFtYmRhcy5maW5kKChsKSA9PiBsWzBdID09PSByb3V0ZSlcblxuICAgIGlmIChtYXRjaCkge1xuICAgICAgbWFuaWZlc3Rbcm91dGVdID0gbWF0Y2hbMV1cbiAgICB9XG4gIH1cblxuICBmcy5vdXRwdXRGaWxlU3luYyhjb25maWcucm91dGVzTWFuaWZlc3QsIEpTT04uc3RyaW5naWZ5KG1hbmlmZXN0KSlcblxuICByZXR1cm4gbGFtYmRhc1xufVxuIiwgImV4cG9ydCBmdW5jdGlvbiBoYXNoQ29udGVudChjb250ZW50OiBzdHJpbmcpIHtcbiAgdmFyIGggPSA1MzgxLFxuICAgIGkgPSBjb250ZW50Lmxlbmd0aFxuXG4gIHdoaWxlIChpKSBoID0gKGggKiAzMykgXiBjb250ZW50LmNoYXJDb2RlQXQoLS1pKVxuXG4gIHJldHVybiAoaCA+Pj4gMCkudG9TdHJpbmcoMzYpXG59XG4iLCAiaW1wb3J0IGZzIGZyb20gJ2ZzLWV4dHJhJ1xuaW1wb3J0IHBhdGggZnJvbSAncGF0aCdcbmltcG9ydCBnbG9iU3luYyBmcm9tICd0aW55LWdsb2Ivc3luYydcblxuaW1wb3J0IHsgUHJlc3RhIH0gZnJvbSAnLi4nXG5cbmV4cG9ydCBmdW5jdGlvbiBpc0R5bmFtaWMoZmlsZTogc3RyaW5nKSB7XG4gIHJldHVybiAvZXhwb3J0XFxzLitcXHNyb3V0ZVxccytcXD0vLnRlc3QoZnMucmVhZEZpbGVTeW5jKGZpbGUsICd1dGYtOCcpKVxufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNTdGF0aWMoZmlsZTogc3RyaW5nKSB7XG4gIHJldHVybiAvZXhwb3J0XFxzLitcXHNnZXRTdGF0aWNQYXRocy8udGVzdChmcy5yZWFkRmlsZVN5bmMoZmlsZSwgJ3V0Zi04JykpXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc1ByZXN0YUZpbGUoZmlsZTogc3RyaW5nKSB7XG4gIHJldHVybiBpc1N0YXRpYyhmaWxlKSB8fCBpc0R5bmFtaWMoZmlsZSlcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldEZpbGVzKGNvbmZpZzogUHJlc3RhKTogc3RyaW5nW10ge1xuICByZXR1cm4gKFtdIGFzIHN0cmluZ1tdKVxuICAgIC5jb25jYXQoY29uZmlnLmZpbGVzKVxuICAgIC5tYXAoKGZpbGUpID0+IGdsb2JTeW5jKGZpbGUsIHsgY3dkOiBjb25maWcuY3dkIH0pKVxuICAgIC5mbGF0KClcbiAgICAubWFwKChmaWxlKSA9PiBwYXRoLnJlc29sdmUoY29uZmlnLmN3ZCwgZmlsZSkpIC8vIG1ha2UgYWJzb2x1dGVcbn1cbiIsICJpbXBvcnQgZnMgZnJvbSAnZnMtZXh0cmEnXG5pbXBvcnQgcGF0aCBmcm9tICdwYXRoJ1xuaW1wb3J0IG1pbWUgZnJvbSAnbWltZS10eXBlcydcblxuaW1wb3J0ICogYXMgbG9nZ2VyIGZyb20gJy4vbG9nJ1xuaW1wb3J0IHsgdGltZXIgfSBmcm9tICcuL3RpbWVyJ1xuaW1wb3J0IHsgZ2V0Um91dGVQYXJhbXMgfSBmcm9tICcuL2dldFJvdXRlUGFyYW1zJ1xuaW1wb3J0IHsgbm9ybWFsaXplUmVzcG9uc2UgfSBmcm9tICcuL25vcm1hbGl6ZVJlc3BvbnNlJ1xuaW1wb3J0IHsgYnVpbHRTdGF0aWNGaWxlcyB9IGZyb20gJy4vYnVpbHRTdGF0aWNGaWxlcydcbmltcG9ydCB7IHJlbW92ZUJ1aWx0U3RhdGljRmlsZSB9IGZyb20gJy4vcmVtb3ZlQnVpbHRTdGF0aWNGaWxlJ1xuXG5pbXBvcnQgdHlwZSB7IFByZXN0YSB9IGZyb20gJy4uJ1xuXG5leHBvcnQgZnVuY3Rpb24gcGF0aG5hbWVUb0ZpbGUocGF0aG5hbWU6IHN0cmluZywgZXh0ID0gJ2h0bWwnKSB7XG4gIHJldHVybiAhIXBhdGguZXh0bmFtZShwYXRobmFtZSlcbiAgICA/IHBhdGhuYW1lIC8vIGlmIHBhdGggaGFzIGV4dGVuc2lvbiwgdXNlIGl0XG4gICAgOiBleHQgPT09ICdodG1sJ1xuICAgID8gYCR7cGF0aG5hbWV9L2luZGV4Lmh0bWxgIC8vIGlmIEhUTUwgaXMgaW5mZXJyZWQsIGNyZWF0ZSBpbmRleFxuICAgIDogYCR7cGF0aG5hbWV9LiR7ZXh0fWAgLy8gYW55dGhpbmcgYnV0IEhUTUwgd2lsbCBuZWVkIGFuIGV4dGVuc2lvbiwgb3RoZXJ3aXNlIGJyb3dzZXJzIHdpbGwgcmVuZGVyIGFzIHRleHRcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHJlbmRlclN0YXRpY0VudHJpZXMoZW50cmllczogc3RyaW5nW10sIGNvbmZpZzogUHJlc3RhKTogUHJvbWlzZTx7IGFsbEdlbmVyYXRlZEZpbGVzOiBzdHJpbmdbXSB9PiB7XG4gIHJldHVybiBuZXcgUHJvbWlzZShhc3luYyAoeSwgbikgPT4ge1xuICAgIGxvZ2dlci5kZWJ1Zyh7XG4gICAgICBsYWJlbDogJ2RlYnVnJyxcbiAgICAgIG1lc3NhZ2U6IGByZW5kZXJpbmcgJHtKU09OLnN0cmluZ2lmeShlbnRyaWVzKX1gLFxuICAgIH0pXG5cbiAgICBjb25zdCBhbGxHZW5lcmF0ZWRGaWxlczogc3RyaW5nW10gPSBbXVxuXG4gICAgZm9yIChjb25zdCBlbnRyeSBvZiBlbnRyaWVzKSB7XG4gICAgICBjb25zdCBsb2NhdGlvbiA9IGVudHJ5LnJlcGxhY2UoY29uZmlnLmN3ZCwgJycpXG5cbiAgICAgIHRyeSB7XG4gICAgICAgIGRlbGV0ZSByZXF1aXJlLmNhY2hlW2VudHJ5XVxuXG4gICAgICAgIGNvbnN0IGZpbGUgPSByZXF1aXJlKGVudHJ5KVxuICAgICAgICBjb25zdCBwYXRocyA9IGF3YWl0IGZpbGUuZ2V0U3RhdGljUGF0aHMoKVxuXG4gICAgICAgIGNvbnN0IHByZXZGaWxlcyA9IChidWlsdFN0YXRpY0ZpbGVzW2VudHJ5XSA9IGJ1aWx0U3RhdGljRmlsZXNbZW50cnldIHx8IFtdKVxuICAgICAgICBjb25zdCBuZXh0RmlsZXM6IHN0cmluZ1tdID0gW11cblxuICAgICAgICBpZiAoIXBhdGhzIHx8ICFwYXRocy5sZW5ndGgpIHtcbiAgICAgICAgICBsb2dnZXIud2Fybih7XG4gICAgICAgICAgICBsYWJlbDogJ3BhdGhzJyxcbiAgICAgICAgICAgIG1lc3NhZ2U6IGAke2xvY2F0aW9ufSAtIG5vIHBhdGhzIHRvIHJlbmRlcmAsXG4gICAgICAgICAgfSlcblxuICAgICAgICAgIHByZXZGaWxlcy5mb3JFYWNoKChmaWxlKSA9PiByZW1vdmVCdWlsdFN0YXRpY0ZpbGUoZmlsZSwgY29uZmlnKSlcblxuICAgICAgICAgIGNvbnRpbnVlXG4gICAgICAgIH1cblxuICAgICAgICBmb3IgKGNvbnN0IHVybCBvZiBwYXRocykge1xuICAgICAgICAgIGNvbnN0IHRpbWUgPSB0aW1lcigpXG4gICAgICAgICAgY29uc3QgZXZlbnQgPSB7XG4gICAgICAgICAgICBwYXRoOiB1cmwsXG4gICAgICAgICAgICBwYXJhbXM6IGZpbGUucm91dGUgPyBnZXRSb3V0ZVBhcmFtcyh1cmwsIGZpbGUucm91dGUpIDoge30sXG4gICAgICAgICAgfVxuXG4gICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBub3JtYWxpemVSZXNwb25zZShhd2FpdCBmaWxlLmhhbmRsZXIoZXZlbnQsIHt9KSlcbiAgICAgICAgICBjb25zdCB0eXBlID0gcmVzcG9uc2UuaGVhZGVycyA/IHJlc3BvbnNlLmhlYWRlcnNbJ0NvbnRlbnQtVHlwZSddIDogJydcbiAgICAgICAgICBjb25zdCBleHQgPSB0eXBlID8gbWltZS5leHRlbnNpb24odHlwZSBhcyBzdHJpbmcpIHx8ICdodG1sJyA6ICdodG1sJ1xuICAgICAgICAgIGNvbnN0IGZpbGVuYW1lID0gcGF0aG5hbWVUb0ZpbGUodXJsLCBleHQpXG5cbiAgICAgICAgICBhbGxHZW5lcmF0ZWRGaWxlcy5wdXNoKGZpbGVuYW1lKVxuICAgICAgICAgIG5leHRGaWxlcy5wdXNoKGZpbGVuYW1lKVxuXG4gICAgICAgICAgZnMub3V0cHV0RmlsZVN5bmMocGF0aC5qb2luKGNvbmZpZy5zdGF0aWNPdXRwdXREaXIsIGZpbGVuYW1lKSwgcmVzcG9uc2UuYm9keSwgJ3V0Zi04JylcblxuICAgICAgICAgIGxvZ2dlci5pbmZvKHtcbiAgICAgICAgICAgIGxhYmVsOiAnYnVpbHQnLFxuICAgICAgICAgICAgbWVzc2FnZTogdXJsLFxuICAgICAgICAgICAgZHVyYXRpb246IHRpbWUoKSxcbiAgICAgICAgICB9KVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gZGlmZiBhbmQgcmVtb3ZlIGZpbGVzXG4gICAgICAgIGZvciAoY29uc3QgZmlsZSBvZiBwcmV2RmlsZXMpIHtcbiAgICAgICAgICBpZiAoIW5leHRGaWxlcy5pbmNsdWRlcyhmaWxlKSkge1xuICAgICAgICAgICAgcmVtb3ZlQnVpbHRTdGF0aWNGaWxlKGZpbGUsIGNvbmZpZylcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBidWlsdFN0YXRpY0ZpbGVzW2VudHJ5XSA9IG5leHRGaWxlc1xuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBpZiAoY29uZmlnLmVudiA9PT0gJ2RldmVsb3BtZW50Jykge1xuICAgICAgICAgIGxvZ2dlci5lcnJvcih7XG4gICAgICAgICAgICBsYWJlbDogJ2Vycm9yJyxcbiAgICAgICAgICAgIG1lc3NhZ2U6ICdlcnJvcnMgZGV0ZWN0ZWQsIHBhdXNpbmcuLi4nLFxuICAgICAgICAgICAgZXJyb3I6IGUsXG4gICAgICAgICAgfSlcblxuICAgICAgICAgIHkoeyBhbGxHZW5lcmF0ZWRGaWxlcyB9KVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGxvZ2dlci5lcnJvcih7XG4gICAgICAgICAgICBsYWJlbDogJ2Vycm9yJyxcbiAgICAgICAgICAgIGVycm9yOiBlLFxuICAgICAgICAgIH0pXG5cbiAgICAgICAgICBuKGUpXG4gICAgICAgIH1cblxuICAgICAgICAvLyBleGl0IGxvb3Agb24gYW55IGVycm9yXG4gICAgICAgIGJyZWFrXG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gY2xlYXIgdG8gcHJldmVudCBtZW1vcnkgbGVha1xuICAgIC8vIGxvYWRDYWNoZS5jbGVhckFsbE1lbW9yeSgpIC8vIFRPRE8gcHJvYnMgY2FuJ3QgXHUyMDE0IGVtaXQ/XG5cbiAgICB5KHsgYWxsR2VuZXJhdGVkRmlsZXMgfSlcbiAgfSlcbn1cbiIsICJleHBvcnQgZnVuY3Rpb24gdGltZXIoKSB7XG4gIGNvbnN0IHN0YXJ0ID0gcHJvY2Vzcy5ocnRpbWUoKVxuICByZXR1cm4gKCkgPT4ge1xuICAgIGNvbnN0IFtzLCBuYW5vc10gPSBwcm9jZXNzLmhydGltZShzdGFydClcbiAgICBjb25zdCBtcyA9IG5hbm9zIC8gMTAwMDAwMFxuXG4gICAgaWYgKHMgPCAxKSB7XG4gICAgICByZXR1cm4gKG1zID49IDEgPyBtcy50b0ZpeGVkKDApIDogbXMudG9GaXhlZCgyKSkgKyAnbXMnXG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBzICsgJy4nICsgbXMudG9GaXhlZCgwKSArICdzJ1xuICAgIH1cbiAgfVxufVxuIiwgImltcG9ydCB0b1JlZ0V4cCBmcm9tICdyZWdleHBhcmFtJ1xuXG5pbXBvcnQgeyBSb3V0ZVBhcmFtcyB9IGZyb20gJy4uJ1xuXG4vLyBAc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9sdWtlZWQvcmVnZXhwYXJhbSN1c2FnZVxuZXhwb3J0IGZ1bmN0aW9uIGdldFJvdXRlUGFyYW1zKHVybDogc3RyaW5nLCByb3V0ZTogc3RyaW5nKTogUm91dGVQYXJhbXMge1xuICBjb25zdCByZXN1bHQgPSB0b1JlZ0V4cChyb3V0ZSlcbiAgbGV0IGkgPSAwXG4gIGxldCBvdXQ6IFJvdXRlUGFyYW1zID0ge31cbiAgbGV0IG1hdGNoZXMgPSByZXN1bHQucGF0dGVybi5leGVjKHVybCkgfHwgW11cblxuICB3aGlsZSAoaSA8IHJlc3VsdC5rZXlzLmxlbmd0aCkge1xuICAgIG91dFtyZXN1bHQua2V5c1tpXV0gPSBtYXRjaGVzWysraV1cbiAgfVxuXG4gIHJldHVybiBvdXRcbn1cbiIsICJpbXBvcnQgeyBBV1MsIFJlc3BvbnNlIH0gZnJvbSAnLi4nXG5cbmZ1bmN0aW9uIHN0cmluZ2lmeShvYmo6IG9iamVjdCB8IHN0cmluZykge1xuICByZXR1cm4gdHlwZW9mIG9iaiA9PT0gJ29iamVjdCcgPyBKU09OLnN0cmluZ2lmeShvYmopIDogb2JqXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBub3JtYWxpemVSZXNwb25zZShyZXNwb25zZTogUGFydGlhbDxSZXNwb25zZT4gfCBzdHJpbmcpOiBBV1NbJ0hhbmRsZXJSZXNwb25zZSddIHtcbiAgY29uc3Qge1xuICAgIGlzQmFzZTY0RW5jb2RlZCA9IGZhbHNlLFxuICAgIHN0YXR1c0NvZGUgPSAyMDAsXG4gICAgaGVhZGVycyA9IHt9LFxuICAgIG11bHRpVmFsdWVIZWFkZXJzID0ge30sXG4gICAgYm9keSA9ICcnLFxuICAgIGh0bWwgPSB1bmRlZmluZWQsXG4gICAganNvbiA9IHVuZGVmaW5lZCxcbiAgICB4bWwgPSB1bmRlZmluZWQsXG4gIH0gPSB0eXBlb2YgcmVzcG9uc2UgPT09ICdzdHJpbmcnXG4gICAgPyB7XG4gICAgICAgIGJvZHk6IHJlc3BvbnNlLFxuICAgICAgfVxuICAgIDogcmVzcG9uc2VcblxuICBsZXQgY29udGVudFR5cGUgPSAndGV4dC9odG1sOyBjaGFyc2V0PXV0Zi04J1xuXG4gIGlmICghIWpzb24pIHtcbiAgICBjb250ZW50VHlwZSA9ICdhcHBsaWNhdGlvbi9qc29uOyBjaGFyc2V0PXV0Zi04J1xuICB9IGVsc2UgaWYgKCEheG1sKSB7XG4gICAgY29udGVudFR5cGUgPSAnYXBwbGljYXRpb24veG1sOyBjaGFyc2V0PXV0Zi04J1xuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBpc0Jhc2U2NEVuY29kZWQsXG4gICAgc3RhdHVzQ29kZSxcbiAgICBoZWFkZXJzOiB7XG4gICAgICAnQ29udGVudC1UeXBlJzogY29udGVudFR5cGUsXG4gICAgICAuLi5oZWFkZXJzLFxuICAgIH0sXG4gICAgbXVsdGlWYWx1ZUhlYWRlcnMsXG4gICAgYm9keTogc3RyaW5naWZ5KGJvZHkgfHwgaHRtbCB8fCBqc29uIHx8IHhtbCB8fCAnJyksXG4gIH1cbn1cbiIsICJ0eXBlIEJ1aWx0U3RhdGljRmlsZSA9IHN0cmluZ1xuXG5leHBvcnQgY29uc3QgYnVpbHRTdGF0aWNGaWxlczogeyBbZW50cnlGaWxlOiBzdHJpbmddOiBCdWlsdFN0YXRpY0ZpbGVbXSB9ID0ge31cbiIsICJpbXBvcnQgZnMgZnJvbSAnZnMtZXh0cmEnXG5pbXBvcnQgcGF0aCBmcm9tICdwYXRoJ1xuXG5pbXBvcnQgKiBhcyBsb2dnZXIgZnJvbSAnLi9sb2cnXG5cbmltcG9ydCB0eXBlIHsgUHJlc3RhIH0gZnJvbSAnLi4nXG5cbmV4cG9ydCBmdW5jdGlvbiByZW1vdmVCdWlsdFN0YXRpY0ZpbGUoZmlsZTogc3RyaW5nLCBjb25maWc6IFByZXN0YSkge1xuICBsb2dnZXIuZGVidWcoe1xuICAgIGxhYmVsOiAnZGVidWcnLFxuICAgIG1lc3NhZ2U6IGByZW1vdmluZyBvbGQgc3RhdGljIGZpbGUgJHtmaWxlfWAsXG4gIH0pXG5cbiAgZnMucmVtb3ZlKHBhdGguam9pbihjb25maWcuc3RhdGljT3V0cHV0RGlyLCBmaWxlKSlcbn1cbiIsICJpbXBvcnQgZnMgZnJvbSAnZnMtZXh0cmEnXG5pbXBvcnQgeyBidWlsZCBhcyBlc2J1aWxkIH0gZnJvbSAnZXNidWlsZCdcblxuaW1wb3J0IHsgb3V0cHV0TGFtYmRhcyB9IGZyb20gJy4vb3V0cHV0TGFtYmRhcydcbmltcG9ydCB7IGdldEZpbGVzLCBpc1N0YXRpYywgaXNEeW5hbWljIH0gZnJvbSAnLi9nZXRGaWxlcydcbmltcG9ydCB7IHJlbmRlclN0YXRpY0VudHJpZXMgfSBmcm9tICcuL3JlbmRlclN0YXRpY0VudHJpZXMnXG5pbXBvcnQgeyB0aW1lciB9IGZyb20gJy4vdGltZXInXG5pbXBvcnQgKiBhcyBsb2dnZXIgZnJvbSAnLi9sb2cnXG5cbmltcG9ydCB0eXBlIHsgUHJlc3RhIH0gZnJvbSAnLi4nXG5cbmZ1bmN0aW9uIGdldFJvdXRlc01hbmlmZXN0U2FmZWx5IChtYW5pZmVzdEZpbGVwYXRoOiBzdHJpbmcpIHtcbiAgdHJ5IHtcbiAgICByZXR1cm4gcmVxdWlyZShtYW5pZmVzdEZpbGVwYXRoKVxuICB9IGNhdGNoIChlKSB7XG4gICAgcmV0dXJuIHt9XG4gIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGJ1aWxkKGNvbmZpZzogUHJlc3RhKSB7XG4gIGNvbnN0IHRvdGFsVGltZSA9IHRpbWVyKClcbiAgY29uc3QgZmlsZXMgPSBnZXRGaWxlcyhjb25maWcpXG4gIGNvbnN0IHN0YXRpY0lkcyA9IGZpbGVzLmZpbHRlcihpc1N0YXRpYylcbiAgY29uc3QgZHluYW1pY0lkcyA9IGZpbGVzLmZpbHRlcihpc0R5bmFtaWMpXG5cbiAgbG9nZ2VyLmRlYnVnKHtcbiAgICBsYWJlbDogJ2J1aWxkJyxcbiAgICBtZXNzYWdlOiAnc3RhcnRpbmcgYnVpbGQnLFxuICB9KVxuXG4gIGlmICghc3RhdGljSWRzLmxlbmd0aCAmJiAhZHluYW1pY0lkcy5sZW5ndGgpIHtcbiAgICBsb2dnZXIud2Fybih7XG4gICAgICBsYWJlbDogJ2ZpbGVzJyxcbiAgICAgIG1lc3NhZ2U6ICdubyBmaWxlcyB3ZXJlIGZvdW5kLCBub3RoaW5nIHRvIGJ1aWxkJyxcbiAgICB9KVxuICB9IGVsc2Uge1xuICAgIGxldCBzdGF0aWNUaW1lID0gJydcbiAgICBsZXQgc3RhdGljRmlsZUFtb3VudCA9IDBcbiAgICBsZXQgZHluYW1pY1RpbWUgPSAnJ1xuICAgIGxldCBjb3B5VGltZSA9ICcnXG5cbiAgICBjb25zdCB0YXNrcyA9IGF3YWl0IFByb21pc2UuYWxsU2V0dGxlZChbXG4gICAgICAoYXN5bmMgKCkgPT4ge1xuICAgICAgICBpZiAoc3RhdGljSWRzLmxlbmd0aCkge1xuICAgICAgICAgIGNvbnN0IHRpbWUgPSB0aW1lcigpXG5cbiAgICAgICAgICBjb25zdCB7IGFsbEdlbmVyYXRlZEZpbGVzIH0gPSBhd2FpdCByZW5kZXJTdGF0aWNFbnRyaWVzKHN0YXRpY0lkcywgY29uZmlnKVxuXG4gICAgICAgICAgc3RhdGljVGltZSA9IHRpbWUoKVxuICAgICAgICAgIHN0YXRpY0ZpbGVBbW91bnQgPSBhbGxHZW5lcmF0ZWRGaWxlcy5sZW5ndGhcbiAgICAgICAgfVxuICAgICAgfSkoKSxcbiAgICAgIChhc3luYyAoKSA9PiB7XG4gICAgICAgIGlmIChkeW5hbWljSWRzLmxlbmd0aCkge1xuICAgICAgICAgIGNvbnN0IHRpbWUgPSB0aW1lcigpXG5cbiAgICAgICAgICBvdXRwdXRMYW1iZGFzKGR5bmFtaWNJZHMsIGNvbmZpZylcblxuICAgICAgICAgIGF3YWl0IGVzYnVpbGQoe1xuICAgICAgICAgICAgZW50cnlQb2ludHM6IE9iamVjdC52YWx1ZXMocmVxdWlyZShjb25maWcucm91dGVzTWFuaWZlc3QpKSxcbiAgICAgICAgICAgIG91dGRpcjogY29uZmlnLmZ1bmN0aW9uc091dHB1dERpcixcbiAgICAgICAgICAgIGJ1bmRsZTogdHJ1ZSxcbiAgICAgICAgICAgIHBsYXRmb3JtOiAnbm9kZScsXG4gICAgICAgICAgICB0YXJnZXQ6IFsnbm9kZTEyJ10sXG4gICAgICAgICAgICBtaW5pZnk6IHRydWUsXG4gICAgICAgICAgICBhbGxvd092ZXJ3cml0ZTogdHJ1ZSxcbiAgICAgICAgICB9KVxuXG4gICAgICAgICAgZHluYW1pY1RpbWUgPSB0aW1lKClcbiAgICAgICAgfVxuICAgICAgfSkoKSxcbiAgICAgIChhc3luYyAoKSA9PiB7XG4gICAgICAgIGlmIChmcy5leGlzdHNTeW5jKGNvbmZpZy5hc3NldHMpKSB7XG4gICAgICAgICAgY29uc3QgdGltZSA9IHRpbWVyKClcblxuICAgICAgICAgIGZzLmNvcHlTeW5jKGNvbmZpZy5hc3NldHMsIGNvbmZpZy5zdGF0aWNPdXRwdXREaXIpXG5cbiAgICAgICAgICBjb3B5VGltZSA9IHRpbWUoKVxuICAgICAgICB9XG4gICAgICB9KSgpLFxuICAgIF0pXG5cbiAgICAvLyBzaW5jZSB3ZSdyZSBidWlsZGluZyAobm90IHdhdGNoKSBpZiBhbnkgdGFzayBmYWlscywgZXhpdCB3aXRoIGVycm9yXG4gICAgaWYgKHRhc2tzLmZpbmQoKHRhc2spID0+IHRhc2suc3RhdHVzID09PSAncmVqZWN0ZWQnKSkge1xuICAgICAgbG9nZ2VyLmRlYnVnKHtcbiAgICAgICAgbGFiZWw6ICdidWlsZCcsXG4gICAgICAgIG1lc3NhZ2U6ICdidWlsZCBwYXJ0aWFsbHkgZmFpbGVkJyxcbiAgICAgIH0pXG5cbiAgICAgIC8vIGxvZyBvdXQgZXJyb3JzXG4gICAgICB0YXNrcy5mb3JFYWNoKCh0YXNrKSA9PiB7XG4gICAgICAgIGlmICh0YXNrLnN0YXR1cyA9PT0gJ3JlamVjdGVkJykge1xuICAgICAgICAgIGxvZ2dlci5lcnJvcih7XG4gICAgICAgICAgICBsYWJlbDogJ2Vycm9yJyxcbiAgICAgICAgICAgIGVycm9yOiB0YXNrLnJlYXNvbixcbiAgICAgICAgICB9KVxuICAgICAgICB9XG4gICAgICB9KVxuXG4gICAgICBwcm9jZXNzLmV4aXQoMSlcbiAgICAgIHJldHVyblxuICAgIH1cblxuICAgIGlmIChzdGF0aWNUaW1lIHx8IGR5bmFtaWNUaW1lKSB7XG4gICAgICBsb2dnZXIubmV3bGluZSgpXG4gICAgfVxuXG4gICAgaWYgKHN0YXRpY1RpbWUpIHtcbiAgICAgIGxvZ2dlci5pbmZvKHtcbiAgICAgICAgbGFiZWw6ICdzdGF0aWMnLFxuICAgICAgICBtZXNzYWdlOiBgcmVuZGVyZWQgJHtzdGF0aWNGaWxlQW1vdW50fSBmaWxlKHMpYCxcbiAgICAgICAgZHVyYXRpb246IHN0YXRpY1RpbWUsXG4gICAgICB9KVxuICAgIH1cblxuICAgIGlmIChkeW5hbWljVGltZSkge1xuICAgICAgbG9nZ2VyLmluZm8oe1xuICAgICAgICBsYWJlbDogJ2xhbWJkYScsXG4gICAgICAgIG1lc3NhZ2U6IGBjb21waWxlZCAke2R5bmFtaWNJZHMubGVuZ3RofSBmdW5jdGlvbihzKWAsXG4gICAgICAgIGR1cmF0aW9uOiBkeW5hbWljVGltZSxcbiAgICAgIH0pXG4gICAgfVxuXG4gICAgaWYgKGNvcHlUaW1lKSB7XG4gICAgICBsb2dnZXIuaW5mbyh7XG4gICAgICAgIGxhYmVsOiAnYXNzZXRzJyxcbiAgICAgICAgbWVzc2FnZTogYGNvcGllZCBpbiAke2NvcHlUaW1lfWAsXG4gICAgICB9KVxuICAgIH1cblxuICAgIGlmIChzdGF0aWNUaW1lIHx8IGR5bmFtaWNUaW1lKSB7XG4gICAgICBsb2dnZXIubmV3bGluZSgpXG4gICAgICBsb2dnZXIuaW5mbyh7XG4gICAgICAgIGxhYmVsOiAnY29tcGxldGUnLFxuICAgICAgICBtZXNzYWdlOiBgaW4gJHt0b3RhbFRpbWUoKX1gLFxuICAgICAgfSlcbiAgICAgIGxvZ2dlci5uZXdsaW5lKClcbiAgICB9XG5cbiAgICBjb25maWcuZXZlbnRzLmVtaXQoJ3Bvc3RidWlsZCcsIHtcbiAgICAgIG91dHB1dDogY29uZmlnLm91dHB1dCxcbiAgICAgIHN0YXRpY091dHB1dDogY29uZmlnLnN0YXRpY091dHB1dERpcixcbiAgICAgIGZ1bmN0aW9uc091dHB1dDogY29uZmlnLmZ1bmN0aW9uc091dHB1dERpcixcbiAgICAgIGZ1bmN0aW9uc01hbmlmZXN0OiBnZXRSb3V0ZXNNYW5pZmVzdFNhZmVseShjb25maWcucm91dGVzTWFuaWZlc3QpLFxuICAgIH0pXG4gIH1cbn1cbiIsICJpbXBvcnQgZnMgZnJvbSAnZnMnXG5pbXBvcnQgcGF0aCBmcm9tICdwYXRoJ1xuaW1wb3J0IGh0dHAgZnJvbSAnaHR0cCdcbmltcG9ydCBnZXRQb3J0IGZyb20gJ2dldC1wb3J0J1xuaW1wb3J0IHNpcnYgZnJvbSAnc2lydidcbmltcG9ydCBjaG9raWRhciBmcm9tICdjaG9raWRhcidcbmltcG9ydCBtaW1lIGZyb20gJ21pbWUtdHlwZXMnXG5pbXBvcnQgdG9SZWdFeHAgZnJvbSAncmVnZXhwYXJhbSdcblxuaW1wb3J0IHsgdGltZXIgfSBmcm9tICcuL3RpbWVyJ1xuaW1wb3J0ICogYXMgbG9nZ2VyIGZyb20gJy4vbG9nJ1xuaW1wb3J0IHsgZGVmYXVsdDQwNCB9IGZyb20gJy4vZGVmYXVsdDQwNCdcbmltcG9ydCB7IHJlcXVlc3RUb0V2ZW50IH0gZnJvbSAnLi9yZXF1ZXN0VG9FdmVudCdcbmltcG9ydCB7IHNlbmRTZXJ2ZXJsZXNzUmVzcG9uc2UgfSBmcm9tICcuL3NlbmRTZXJ2ZXJsZXNzUmVzcG9uc2UnXG5cbmltcG9ydCB0eXBlIHsgQVdTLCBQcmVzdGEgfSBmcm9tICcuLidcblxuY29uc3Qgc3R5bGUgPSBbXG4gICdwb3NpdGlvbjogZml4ZWQnLFxuICAnYm90dG9tOiAyNHB4JyxcbiAgJ3JpZ2h0OiAyNHB4JyxcbiAgJ3dpZHRoOiAzMnB4JyxcbiAgJ2hlaWdodDogMzJweCcsXG4gICdib3JkZXItcmFkaXVzOiAzMnB4JyxcbiAgJ2JhY2tncm91bmQ6IHdoaXRlJyxcbiAgJ2NvbG9yOiAjRkY3QTkzJyxcbiAgJ2ZvbnQtc2l6ZTogMjBweCcsXG4gICdmb250LXdlaWdodDogYm9sZCcsXG4gICd0ZXh0LWFsaWduOiBjZW50ZXInLFxuICAnbGluZS1oZWlnaHQ6IDMxcHgnLFxuICAnYm94LXNoYWRvdzogMHB4IDBweCAxcHggcmdiYSgwLCAwLCAwLCAwLjA0KSwgMHB4IDRweCA4cHggcmdiYSgwLCAwLCAwLCAwLjA0KSwgMHB4IDE2cHggMjRweCByZ2JhKDAsIDAsIDAsIDAuMDQpLCAwcHggMjRweCAzMnB4IHJnYmEoMCwgMCwgMCwgMC4wNCknLFxuXVxuXG5jb25zdCBkZXZTZXJ2ZXJJY29uID0gYFxuICA8ZGl2IHN0eWxlPVwiJHtzdHlsZS5qb2luKCc7Jyl9XCI+fjwvZGl2PlxuYFxuXG5mdW5jdGlvbiByZXNvbHZlSFRNTChkaXI6IHN0cmluZywgdXJsOiBzdHJpbmcpIHtcbiAgbGV0IGZpbGUgPSBwYXRoLmpvaW4oZGlyLCB1cmwpXG5cbiAgLy8gaWYgbm8gZXh0ZW5zaW9uLCBpdCdzIHByb2JhYmx5IGludGVuZGVkIHRvIGJlIGFuIEhUTUwgZmlsZVxuICBpZiAoIXBhdGguZXh0bmFtZSh1cmwpKSB7XG4gICAgdHJ5IHtcbiAgICAgIHJldHVybiBmcy5yZWFkRmlsZVN5bmMocGF0aC5qb2luKGRpciwgdXJsLCAnaW5kZXguaHRtbCcpLCAndXRmOCcpXG4gICAgfSBjYXRjaCAoZSkge31cbiAgfVxuXG4gIHJldHVybiBmcy5yZWFkRmlsZVN5bmMoZmlsZSwgJ3V0ZjgnKVxufVxuXG5mdW5jdGlvbiBjcmVhdGVEZXZDbGllbnQoeyBwb3J0IH06IHsgcG9ydDogbnVtYmVyIH0pIHtcbiAgcmV0dXJuIGBcbiAgICA8c2NyaXB0PlxuICAgICAgKGZ1bmN0aW9uIChnbG9iYWwpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb25zdCBzb2NrZXRpbyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NjcmlwdCcpXG4gICAgICAgICAgc29ja2V0aW8uc3JjID0gJ2h0dHBzOi8vdW5wa2cuY29tL3BvY2tldC5pb0AwLjEuNC9taW4uanMnXG4gICAgICAgICAgc29ja2V0aW8ub25sb2FkID0gZnVuY3Rpb24gaW5pdCAoKSB7XG4gICAgICAgICAgICB2YXIgZGlzY29ubmVjdGVkID0gZmFsc2VcbiAgICAgICAgICAgIHZhciBzb2NrZXQgPSBpbygnaHR0cDovL2xvY2FsaG9zdDoke3BvcnR9Jywge1xuICAgICAgICAgICAgICByZWNvbm5lY3Rpb25BdHRlbXB0czogM1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIHNvY2tldC5vbignY29ubmVjdCcsIGZ1bmN0aW9uKCkgeyBjb25zb2xlLmxvZygncHJlc3RhIGNvbm5lY3RlZCcpIH0pXG4gICAgICAgICAgICBzb2NrZXQub24oJ3JlZnJlc2gnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgZ2xvYmFsLmxvY2F0aW9uLnJlbG9hZCgpXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgc29ja2V0Lm9uKCdkaXNjb25uZWN0JywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgIGRpc2Nvbm5lY3RlZCA9IHRydWVcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBzb2NrZXQub24oJ3JlY29ubmVjdF9mYWlsZWQnLCBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICAgIGlmIChkaXNjb25uZWN0ZWQpIHJldHVyblxuICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKFwicHJlc3RhIC0gY29ubmVjdGlvbiB0byBzZXJ2ZXIgb24gOiR7cG9ydH0gZmFpbGVkXCIpXG4gICAgICAgICAgICB9KVxuICAgICAgICAgIH1cbiAgICAgICAgICBkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKHNvY2tldGlvKVxuICAgICAgICB9IGNhdGNoIChlKSB7fVxuICAgICAgfSkodGhpcyk7XG4gICAgPC9zY3JpcHQ+XG4gIGBcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVNlcnZlckhhbmRsZXIoeyBwb3J0LCBjb25maWcgfTogeyBwb3J0OiBudW1iZXI7IGNvbmZpZzogUHJlc3RhIH0pIHtcbiAgY29uc3QgZGV2Q2xpZW50ID0gY3JlYXRlRGV2Q2xpZW50KHsgcG9ydCB9KVxuICBjb25zdCBzdGF0aWNEaXIgPSBjb25maWcuc3RhdGljT3V0cHV0RGlyXG4gIGNvbnN0IGFzc2V0RGlyID0gY29uZmlnLmFzc2V0c1xuXG4gIHJldHVybiBhc3luYyBmdW5jdGlvbiBzZXJ2ZUhhbmRsZXIocmVxOiBodHRwLkluY29taW5nTWVzc2FnZSwgcmVzOiBodHRwLlNlcnZlclJlc3BvbnNlKSB7XG4gICAgY29uc3QgdGltZSA9IHRpbWVyKClcbiAgICBjb25zdCB1cmwgPSByZXEudXJsIGFzIHN0cmluZ1xuXG4gICAgLypcbiAgICAgKiBJZiB0aGlzIGlzIGFuIGFzc2V0IG90aGVyIHRoYW4gSFRNTCBmaWxlcywganVzdCBzZXJ2ZSBpdFxuICAgICAqL1xuICAgIGlmICgvXi4rXFwuLiskLy50ZXN0KHVybCkgJiYgIS9cXC5odG1sPyQvLnRlc3QodXJsKSkge1xuICAgICAgbG9nZ2VyLmRlYnVnKHtcbiAgICAgICAgbGFiZWw6ICdkZWJ1ZycsXG4gICAgICAgIG1lc3NhZ2U6IGBhdHRlbXB0aW5nIHRvIHNlcnZlIHN0YXRpYyBhc3NldCAke3VybH1gLFxuICAgICAgfSlcblxuICAgICAgLypcbiAgICAgICAqIGZpcnN0IGNoZWNrIHRoZSB2Y3MtdHJhY2tlZCBzdGF0aWMgZm9sZGVyLFxuICAgICAgICogdGhlbiBjaGVjayB0aGUgcHJlc3RhLWJ1aWx0IHN0YXRpYyBmb2xkZXJcbiAgICAgICAqXG4gICAgICAgKiBAc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9zdXJlLXRoaW5nL3ByZXN0YS9pc3N1ZXMvMzBcbiAgICAgICAqL1xuICAgICAgc2lydihhc3NldERpciwgeyBkZXY6IHRydWUgfSkocmVxLCByZXMsICgpID0+IHtcbiAgICAgICAgc2lydihzdGF0aWNEaXIsIHsgZGV2OiB0cnVlIH0pKHJlcSwgcmVzLCAoKSA9PiB7XG4gICAgICAgICAgbG9nZ2VyLndhcm4oe1xuICAgICAgICAgICAgbGFiZWw6ICdzZXJ2ZScsXG4gICAgICAgICAgICBtZXNzYWdlOiBgNDA0ICR7dXJsfWAsXG4gICAgICAgICAgICBkdXJhdGlvbjogdGltZSgpLFxuICAgICAgICAgIH0pXG5cbiAgICAgICAgICBzZW5kU2VydmVybGVzc1Jlc3BvbnNlKHJlcywge1xuICAgICAgICAgICAgc3RhdHVzQ29kZTogNDA0LFxuICAgICAgICAgICAgYm9keTogZGVmYXVsdDQwNCArIGRldkNsaWVudCArIGRldlNlcnZlckljb24sXG4gICAgICAgICAgfSlcbiAgICAgICAgfSlcbiAgICAgIH0pXG4gICAgfSBlbHNlIHtcbiAgICAgIC8qXG4gICAgICAgKiBUcnkgdG8gcmVzb2x2ZSBhIHN0YXRpYyByb3V0ZSBub3JtYWxseVxuICAgICAgICovXG4gICAgICB0cnkge1xuICAgICAgICBsb2dnZXIuZGVidWcoe1xuICAgICAgICAgIGxhYmVsOiAnZGVidWcnLFxuICAgICAgICAgIG1lc3NhZ2U6IGBhdHRlbXB0aW5nIHRvIHJlbmRlciBzdGF0aWMgSFRNTCBmb3IgJHt1cmx9YCxcbiAgICAgICAgfSlcblxuICAgICAgICBjb25zdCBmaWxlID0gcmVzb2x2ZUhUTUwoc3RhdGljRGlyLCB1cmwpICsgZGV2Q2xpZW50ICsgZGV2U2VydmVySWNvblxuXG4gICAgICAgIGxvZ2dlci5pbmZvKHtcbiAgICAgICAgICBsYWJlbDogJ3NlcnZlJyxcbiAgICAgICAgICBtZXNzYWdlOiBgMjAwICR7dXJsfWAsXG4gICAgICAgICAgZHVyYXRpb246IHRpbWUoKSxcbiAgICAgICAgfSlcblxuICAgICAgICBzZW5kU2VydmVybGVzc1Jlc3BvbnNlKHJlcywgeyBib2R5OiBmaWxlIH0pXG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGxvZ2dlci5kZWJ1Zyh7XG4gICAgICAgICAgbGFiZWw6ICdkZWJ1ZycsXG4gICAgICAgICAgbWVzc2FnZTogYHNlcnZlIGVycm9yYCxcbiAgICAgICAgICBlcnJvcjogZSxcbiAgICAgICAgfSlcblxuICAgICAgICAvLyBleHBlY3QgRU5PRU5ULCBsb2cgZXZlcnl0aGluZyBlbHNlXG4gICAgICAgIGlmICghL0VOT0VOVHxFSVNESVIvLnRlc3QoZS5tZXNzYWdlKSkge1xuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZSlcbiAgICAgICAgfVxuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgLypcbiAgICAgICAgICAgKiBObyBhc3NldCBmaWxlLCBubyBzdGF0aWMgZmlsZSwgdHJ5IGR5bmFtaWNcbiAgICAgICAgICAgKi9cbiAgICAgICAgICBjb25zdCBtYW5pZmVzdCA9IHJlcXVpcmUoY29uZmlnLnJvdXRlc01hbmlmZXN0KVxuICAgICAgICAgIGNvbnN0IHJvdXRlcyA9IE9iamVjdC5rZXlzKG1hbmlmZXN0KVxuICAgICAgICAgIGNvbnN0IGxhbWJkYUZpbGVwYXRoID0gcm91dGVzXG4gICAgICAgICAgICAubWFwKChyb3V0ZSkgPT4gKHtcbiAgICAgICAgICAgICAgbWF0Y2hlcjogdG9SZWdFeHAocm91dGUpLFxuICAgICAgICAgICAgICByb3V0ZSxcbiAgICAgICAgICAgIH0pKVxuICAgICAgICAgICAgLmZpbHRlcigoeyBtYXRjaGVyIH0pID0+IHtcbiAgICAgICAgICAgICAgcmV0dXJuIG1hdGNoZXIucGF0dGVybi50ZXN0KHVybC5zcGxpdCgnPycpWzBdKVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5tYXAoKHsgcm91dGUgfSkgPT4gbWFuaWZlc3Rbcm91dGVdKVswXVxuXG4gICAgICAgICAgLyoqXG4gICAgICAgICAgICogSWYgd2UgaGF2ZSBhIHNlcnZlcmxlc3MgZnVuY3Rpb24sIGRlbGVnYXRlIHRvIGl0LCBvdGhlcndpc2UgNDA0XG4gICAgICAgICAgICovXG4gICAgICAgICAgaWYgKGxhbWJkYUZpbGVwYXRoKSB7XG4gICAgICAgICAgICBsb2dnZXIuZGVidWcoe1xuICAgICAgICAgICAgICBsYWJlbDogJ2RlYnVnJyxcbiAgICAgICAgICAgICAgbWVzc2FnZTogYGF0dGVtcHRpbmcgdG8gcmVuZGVyIGxhbWJkYSBmb3IgJHt1cmx9YCxcbiAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgIGNvbnN0IHsgaGFuZGxlciB9OiB7IGhhbmRsZXI6IEFXU1snSGFuZGxlciddIH0gPSByZXF1aXJlKGxhbWJkYUZpbGVwYXRoKVxuICAgICAgICAgICAgY29uc3QgZXZlbnQgPSBhd2FpdCByZXF1ZXN0VG9FdmVudChyZXEpXG4gICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGhhbmRsZXIoZXZlbnQsIHt9KVxuICAgICAgICAgICAgY29uc3QgaGVhZGVycyA9IHJlc3BvbnNlLmhlYWRlcnMgfHwge31cbiAgICAgICAgICAgIGNvbnN0IHJlZGlyID0gcmVzcG9uc2Uuc3RhdHVzQ29kZSA+IDI5OSAmJiByZXNwb25zZS5zdGF0dXNDb2RlIDwgMzk5XG5cbiAgICAgICAgICAgIC8vIGdldCBtaW1lIHR5cGVcbiAgICAgICAgICAgIGNvbnN0IHR5cGUgPSBoZWFkZXJzWydDb250ZW50LVR5cGUnXSBhcyBzdHJpbmdcbiAgICAgICAgICAgIGNvbnN0IGV4dCA9IHR5cGUgPyBtaW1lLmV4dGVuc2lvbih0eXBlKSA6ICdodG1sJ1xuXG4gICAgICAgICAgICBsb2dnZXIuaW5mbyh7XG4gICAgICAgICAgICAgIGxhYmVsOiAnc2VydmUnLFxuICAgICAgICAgICAgICBtZXNzYWdlOiBgJHtyZXNwb25zZS5zdGF0dXNDb2RlfSAke3JlZGlyID8gaGVhZGVycy5Mb2NhdGlvbiA6IHVybH1gLFxuICAgICAgICAgICAgICBkdXJhdGlvbjogdGltZSgpLFxuICAgICAgICAgICAgfSlcblxuICAgICAgICAgICAgc2VuZFNlcnZlcmxlc3NSZXNwb25zZShyZXMsIHtcbiAgICAgICAgICAgICAgc3RhdHVzQ29kZTogcmVzcG9uc2Uuc3RhdHVzQ29kZSxcbiAgICAgICAgICAgICAgaGVhZGVyczogcmVzcG9uc2UuaGVhZGVycyxcbiAgICAgICAgICAgICAgbXVsdGlWYWx1ZUhlYWRlcnM6IHJlc3BvbnNlLm11bHRpVmFsdWVIZWFkZXJzLFxuICAgICAgICAgICAgICAvLyBvbmx5IGh0bWwgY2FuIGJlIGxpdmUtcmVsb2FkZWQsIGR1aFxuICAgICAgICAgICAgICBib2R5OlxuICAgICAgICAgICAgICAgIGV4dCA9PT0gJ2h0bWwnID8gKHJlc3BvbnNlLmJvZHkgfHwgJycpLnNwbGl0KCc8L2JvZHk+JylbMF0gKyBkZXZDbGllbnQgKyBkZXZTZXJ2ZXJJY29uIDogcmVzcG9uc2UuYm9keSxcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGxvZ2dlci5kZWJ1Zyh7XG4gICAgICAgICAgICAgIGxhYmVsOiAnZGVidWcnLFxuICAgICAgICAgICAgICBtZXNzYWdlOiBgYXR0ZW1wdGluZyB0byByZW5kZXIgc3RhdGljIDQwNC5odG1sIHBhZ2UgZm9yICR7dXJsfWAsXG4gICAgICAgICAgICB9KVxuXG4gICAgICAgICAgICAvKlxuICAgICAgICAgICAgICogVHJ5IHRvIGZhbGwgYmFjayB0byBhIHN0YXRpYyA0MDQgcGFnZVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICBjb25zdCBmaWxlID0gcmVzb2x2ZUhUTUwoc3RhdGljRGlyLCAnNDA0JykgKyBkZXZDbGllbnQgKyBkZXZTZXJ2ZXJJY29uXG5cbiAgICAgICAgICAgICAgbG9nZ2VyLndhcm4oe1xuICAgICAgICAgICAgICAgIGxhYmVsOiAnc2VydmUnLFxuICAgICAgICAgICAgICAgIG1lc3NhZ2U6IGA0MDQgJHt1cmx9YCxcbiAgICAgICAgICAgICAgICBkdXJhdGlvbjogdGltZSgpLFxuICAgICAgICAgICAgICB9KVxuXG4gICAgICAgICAgICAgIHNlbmRTZXJ2ZXJsZXNzUmVzcG9uc2UocmVzLCB7XG4gICAgICAgICAgICAgICAgc3RhdHVzQ29kZTogNDA0LFxuICAgICAgICAgICAgICAgIGJvZHk6IGZpbGUsXG4gICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgIGlmICghZS5tZXNzYWdlLmluY2x1ZGVzKCdFTk9FTlQnKSkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZSlcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIGxvZ2dlci5kZWJ1Zyh7XG4gICAgICAgICAgICAgICAgbGFiZWw6ICdkZWJ1ZycsXG4gICAgICAgICAgICAgICAgbWVzc2FnZTogYHJlbmRlcmluZyBkZWZhdWx0IDQwNCBIVE1MIHBhZ2UgZm9yICR7dXJsfWAsXG4gICAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgICAgbG9nZ2VyLndhcm4oe1xuICAgICAgICAgICAgICAgIGxhYmVsOiAnc2VydmUnLFxuICAgICAgICAgICAgICAgIG1lc3NhZ2U6IGA0MDQgJHt1cmx9YCxcbiAgICAgICAgICAgICAgICBkdXJhdGlvbjogdGltZSgpLFxuICAgICAgICAgICAgICB9KVxuXG4gICAgICAgICAgICAgIHNlbmRTZXJ2ZXJsZXNzUmVzcG9uc2UocmVzLCB7XG4gICAgICAgICAgICAgICAgc3RhdHVzQ29kZTogNDA0LFxuICAgICAgICAgICAgICAgIGJvZHk6IGRlZmF1bHQ0MDQgKyBkZXZDbGllbnQgKyBkZXZTZXJ2ZXJJY29uLFxuICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgIGxvZ2dlci5kZWJ1Zyh7XG4gICAgICAgICAgICBsYWJlbDogJ2RlYnVnJyxcbiAgICAgICAgICAgIG1lc3NhZ2U6IGByZW5kZXJpbmcgZGVmYXVsdCA1MDAgSFRNTCBwYWdlIGZvciAke3VybH1gLFxuICAgICAgICAgIH0pXG5cbiAgICAgICAgICBsb2dnZXIuZXJyb3Ioe1xuICAgICAgICAgICAgbGFiZWw6ICdzZXJ2ZScsXG4gICAgICAgICAgICBtZXNzYWdlOiBgNTAwICR7dXJsfWAsXG4gICAgICAgICAgICBlcnJvcjogZSxcbiAgICAgICAgICAgIGR1cmF0aW9uOiB0aW1lKCksXG4gICAgICAgICAgfSlcblxuICAgICAgICAgIHNlbmRTZXJ2ZXJsZXNzUmVzcG9uc2UocmVzLCB7XG4gICAgICAgICAgICBzdGF0dXNDb2RlOiA1MDAsXG4gICAgICAgICAgICBib2R5OiAnJyArIGRldkNsaWVudCArIGRldlNlcnZlckljb24sIC8vIFRPRE8gZGVmYXVsdCA1MDAgc2NyZWVuXG4gICAgICAgICAgfSlcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc2VydmUoY29uZmlnOiBQcmVzdGEpIHtcbiAgY29uc3QgcG9ydCA9IGF3YWl0IGdldFBvcnQoeyBwb3J0OiA0MDAwIH0pXG4gIGNvbnN0IHNlcnZlciA9IGh0dHAuY3JlYXRlU2VydmVyKGNyZWF0ZVNlcnZlckhhbmRsZXIoeyBwb3J0LCBjb25maWcgfSkpLmxpc3Rlbihwb3J0KVxuICBjb25zdCBzb2NrZXQgPSByZXF1aXJlKCdwb2NrZXQuaW8nKShzZXJ2ZXIsIHsgc2VydmVDbGllbnQ6IGZhbHNlIH0pXG5cbiAgY29uZmlnLmV2ZW50cy5vbigncmVmcmVzaCcsICgpID0+IHtcbiAgICBsb2dnZXIuZGVidWcoe1xuICAgICAgbGFiZWw6ICdkZWJ1ZycsXG4gICAgICBtZXNzYWdlOiBgcmVmcmVzaCBldmVudCByZWNlaXZlZGAsXG4gICAgfSlcblxuICAgIHNvY2tldC5lbWl0KCdyZWZyZXNoJylcbiAgfSlcblxuICBjaG9raWRhci53YXRjaChjb25maWcuYXNzZXRzLCB7IGlnbm9yZUluaXRpYWw6IHRydWUgfSkub24oJ2FsbCcsICgpID0+IHtcbiAgICBjb25maWcuZXZlbnRzLmVtaXQoJ3JlZnJlc2gnKVxuICB9KVxuXG4gIHJldHVybiB7IHBvcnQgfVxufVxuIiwgImV4cG9ydCBjb25zdCBkZWZhdWx0NDA0ID0gYDwhLS0gYnVpbHQgd2l0aCBwcmVzdGEgaHR0cHM6Ly9ucG0uaW0vcHJlc3RhIC0tPlxuPCFET0NUWVBFIGh0bWw+XG48aHRtbD5cbiAgPGhlYWQ+XG4gICAgPG1ldGEgY2hhcnNldD1cIlVURi04XCIgLz5cbiAgICA8bWV0YSBuYW1lPVwidmlld3BvcnRcIiBjb250ZW50PVwid2lkdGg9ZGV2aWNlLXdpZHRoLGluaXRpYWwtc2NhbGU9MVwiIC8+XG4gICAgPHRpdGxlPjQwNDwvdGl0bGU+XG4gICAgPGxpbmtcbiAgICAgIHJlbD1cInN0eWxlc2hlZXRcIlxuICAgICAgdHlwZT1cInRleHQvY3NzXCJcbiAgICAgIGhyZWY9XCJodHRwczovL3VucGtnLmNvbS9zdmJzdHJhdGVANC4xLjEvZGlzdC9zdmJzdHJhdGUuY3NzXCJcbiAgICAvPlxuICA8L2hlYWQ+XG4gIDxib2R5PlxuICAgIDxkaXYgY2xhc3M9XCJmIGFpYyBqY2NcIiBzdHlsZT1cImhlaWdodDogMTAwdmhcIj5cbiAgICAgIDxoMiBjbGFzcz1cInAxXCIgc3R5bGU9XCJjb2xvcjogYmx1ZVwiPjQwNCBOb3QgRm91bmQ8L2gyPlxuICAgIDwvZGl2PlxuICA8L2JvZHk+XG48L2h0bWw+YFxuIiwgImltcG9ydCBodHRwIGZyb20gJ2h0dHAnXG5pbXBvcnQgeyBwYXJzZSBhcyBwYXJzZVVybCB9IGZyb20gJ3VybCdcbmltcG9ydCB7IHBhcnNlIGFzIHBhcnNlUXVlcnkgfSBmcm9tICdxdWVyeS1zdHJpbmcnXG5pbXBvcnQgcmF3Qm9keSBmcm9tICdyYXctYm9keSdcbmltcG9ydCBtaW1lIGZyb20gJ21pbWUtdHlwZXMnXG5cbmltcG9ydCB0eXBlIHsgQVdTIH0gZnJvbSAnLi4nXG5cbi8vIEBzZWUgaHR0cHM6Ly9naXRodWIuY29tL25ldGxpZnkvY2xpL2Jsb2IvMjdiYjdiOWIzMGQ0NjVhYmU4NmY4N2Y0Mjc0ZGQ3YTcxYjFiMDAzYi9zcmMvdXRpbHMvc2VydmUtZnVuY3Rpb25zLmpzI0wxNjdcbmNvbnN0IEJBU0VfNjRfTUlNRV9SRUdFWFAgPSAvaW1hZ2V8YXVkaW98dmlkZW98YXBwbGljYXRpb25cXC9wZGZ8YXBwbGljYXRpb25cXC96aXB8YXBwbGljYXRvblxcL29jdGV0LXN0cmVhbS9pXG5mdW5jdGlvbiBzaG91bGRCYXNlNjRFbmNvZGUoY29udGVudFR5cGU6IHN0cmluZykge1xuICByZXR1cm4gQm9vbGVhbihjb250ZW50VHlwZSkgJiYgQkFTRV82NF9NSU1FX1JFR0VYUC50ZXN0KGNvbnRlbnRUeXBlKVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcmVxdWVzdFRvRXZlbnQocmVxOiBodHRwLkluY29taW5nTWVzc2FnZSk6IFByb21pc2U8QVdTWydIYW5kbGVyRXZlbnQnXT4ge1xuICAvLyBAc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9uZXRsaWZ5L2NsaS9ibG9iLzI3YmI3YjliMzBkNDY1YWJlODZmODdmNDI3NGRkN2E3MWIxYjAwM2Ivc3JjL3V0aWxzL3NlcnZlLWZ1bmN0aW9ucy5qcyNMMjA4XG4gIGNvbnN0IHJlbW90ZUFkZHJlc3MgPSBTdHJpbmcocmVxLmhlYWRlcnNbJ3gtZm9yd2FyZGVkLWZvciddKSB8fCByZXEuY29ubmVjdGlvbi5yZW1vdGVBZGRyZXNzIHx8ICcnXG4gIGNvbnN0IGlwID0gcmVtb3RlQWRkcmVzc1xuICAgIC5zcGxpdChyZW1vdGVBZGRyZXNzLmluY2x1ZGVzKCcuJykgPyAnOicgOiAnLCcpXG4gICAgLnBvcCgpXG4gICAgPy50cmltKClcbiAgY29uc3QgaXNCYXNlNjRFbmNvZGVkID0gc2hvdWxkQmFzZTY0RW5jb2RlKHJlcS5oZWFkZXJzWydjb250ZW50LXR5cGUnXSB8fCAnJylcbiAgY29uc3QgYm9keSA9IHJlcS5oZWFkZXJzWydjb250ZW50LWxlbmd0aCddXG4gICAgPyBhd2FpdCByYXdCb2R5KHJlcSwge1xuICAgICAgICBsaW1pdDogJzFtYicsXG4gICAgICAgIGVuY29kaW5nOiBtaW1lLmNoYXJzZXQocmVxLmhlYWRlcnNbJ2NvbnRlbnQtdHlwZSddIHx8ICcnKSB8fCB1bmRlZmluZWQsXG4gICAgICB9KVxuICAgIDogdW5kZWZpbmVkXG5cbiAgcmV0dXJuIHtcbiAgICBwYXRoOiByZXEudXJsIGFzIHN0cmluZyxcbiAgICBodHRwTWV0aG9kOiByZXEubWV0aG9kIGFzIHN0cmluZyxcbiAgICAvLyBAdHMtaWdub3JlIFRPRE8gdGVzdCBzZXQtY29va2llIGNvbWluZyBpbiBhcyBhcnJheVxuICAgIGhlYWRlcnM6IHtcbiAgICAgIC4uLnJlcS5oZWFkZXJzLFxuICAgICAgJ2NsaWVudC1pcCc6IGlwLFxuICAgIH0sXG4gICAgLy8gVE9ETyBzaG91bGQgdGhlc2UgaGVhZGVycyBiZSBleGNsdXNpdmVseSBzaW5nbGUgdmFsdWUgdnMgbXVsdGk/XG4gICAgbXVsdGlWYWx1ZUhlYWRlcnM6IE9iamVjdC5rZXlzKHJlcS5oZWFkZXJzKS5yZWR1Y2UoKGhlYWRlcnMsIGtleSkgPT4ge1xuICAgICAgaWYgKHJlcS5oZWFkZXJzW2tleV0gJiYgIShyZXEuaGVhZGVyc1trZXldIGFzIHN0cmluZykuaW5jbHVkZXMoJywnKSkgcmV0dXJuIGhlYWRlcnMgLy8gb25seSBpbmNsdWRlIG11bHRpLXZhbHVlIGhlYWRlcnMgaGVyZVxuXG4gICAgICByZXR1cm4ge1xuICAgICAgICAuLi5oZWFkZXJzLFxuICAgICAgICAvLyBAdHMtaWdub3JlIFRPRE8gYWdhaW4sIGFycmF5IGhlYWRlcnNcbiAgICAgICAgW2tleV06IHJlcS5oZWFkZXJzW2tleV0uc3BsaXQoJywnKSxcbiAgICAgIH1cbiAgICB9LCB7fSksXG4gICAgLy8gQHRzLWlnbm9yZSBUT0RPIGRvIEkgbmVlZCB0byBrZWVwIHRoZXNlIHNlcGFyYXRlP1xuICAgIHF1ZXJ5U3RyaW5nUGFyYW1ldGVyczogcGFyc2VRdWVyeShwYXJzZVVybChyZXEudXJsKS5xdWVyeSksXG4gICAgYm9keTogYm9keSA/IG5ldyBCdWZmZXIoYm9keSkudG9TdHJpbmcoaXNCYXNlNjRFbmNvZGVkID8gJ2Jhc2U2NCcgOiAndXRmOCcpIDogbnVsbCxcbiAgICBpc0Jhc2U2NEVuY29kZWQsXG4gIH1cbn1cbiIsICJpbXBvcnQgaHR0cCBmcm9tICdodHRwJ1xuXG5pbXBvcnQgeyBub3JtYWxpemVSZXNwb25zZSB9IGZyb20gJy4vbm9ybWFsaXplUmVzcG9uc2UnXG5cbmltcG9ydCB0eXBlIHsgQVdTIH0gZnJvbSAnLi4nXG5cbmV4cG9ydCBmdW5jdGlvbiBzZW5kU2VydmVybGVzc1Jlc3BvbnNlKHJlczogaHR0cC5TZXJ2ZXJSZXNwb25zZSwgcjogUGFydGlhbDxBV1NbJ0hhbmRsZXJSZXNwb25zZSddPikge1xuICBjb25zdCByZXNwb25zZSA9IG5vcm1hbGl6ZVJlc3BvbnNlKHIpXG5cbiAgLy8gQHNlZSBodHRwczovL2dpdGh1Yi5jb20vbmV0bGlmeS9jbGkvYmxvYi8yN2JiN2I5YjMwZDQ2NWFiZTg2Zjg3ZjQyNzRkZDdhNzFiMWIwMDNiL3NyYy91dGlscy9zZXJ2ZS1mdW5jdGlvbnMuanMjTDczXG4gIGZvciAoY29uc3Qga2V5IGluIHIubXVsdGlWYWx1ZUhlYWRlcnMpIHtcbiAgICByZXMuc2V0SGVhZGVyKGtleSwgU3RyaW5nKHIubXVsdGlWYWx1ZUhlYWRlcnNba2V5XSkpXG4gIH1cblxuICBmb3IgKGNvbnN0IGtleSBpbiByLmhlYWRlcnMpIHtcbiAgICByZXMuc2V0SGVhZGVyKGtleSwgU3RyaW5nKHIuaGVhZGVyc1trZXldKSlcbiAgfVxuXG4gIHJlcy5zdGF0dXNDb2RlID0gcmVzcG9uc2Uuc3RhdHVzQ29kZVxuICByZXMud3JpdGUocmVzcG9uc2UuYm9keSlcbiAgcmVzLmVuZCgpXG59XG4iXSwKICAibWFwcGluZ3MiOiAiO2s0QkFFQSxPQUFlLHVCQUNmLEdBQWlCLHU2Q0NIakIsTUFBeUIsb0JDQXpCLE1BQWlCLG1CQ0VWLGFBQXlCLENBQzlCLEdBQUksR0FBMEMsR0FFOUMsV0FBYyxLQUFlLEVBQW1CLENBQzlDLEVBQU8sSUFBTSxFQUFPLEdBQUksSUFBSSxBQUFDLEdBQWlCLEVBQUcsR0FBRyxJQUd0RCxXQUFZLEVBQVksRUFBOEIsQ0FDcEQsU0FBTyxHQUFNLEVBQU8sR0FBTSxFQUFPLEdBQUksT0FBTyxHQUFNLENBQUMsR0FDNUMsSUFBTSxFQUFPLEdBQUksT0FBTyxFQUFPLEdBQUksUUFBUSxHQUFLLEdBR3pELFlBQWlCLENBQ2YsRUFBUyxHQUdYLFdBQW1CLEVBQVksQ0FDN0IsTUFBTyxHQUFPLElBQU8sR0FHdkIsTUFBTyxDQUNMLE9BQ0EsS0FDQSxRQUNBLGFEbkJKLEdBQU0sSUFBd0IsbUJBRWxCLEVBQUwsVUFBSyxFQUFMLENBQ0wsYUFBYSxhQUNiLGNBQWMsY0FDZCxPQUFPLFNBSEcsV0FNWixHQUFNLElBQWdCLENBQ3BCLElBQUssUUFBUSxJQUNiLElBQUssUUFBUSxNQUNiLElB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
