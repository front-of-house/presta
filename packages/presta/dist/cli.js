#!/usr/bin/env node
var Xe=Object.create;var L=Object.defineProperty,Ye=Object.defineProperties,Ze=Object.getOwnPropertyDescriptor,et=Object.getOwnPropertyDescriptors,tt=Object.getOwnPropertyNames,pe=Object.getOwnPropertySymbols,rt=Object.getPrototypeOf,me=Object.prototype.hasOwnProperty,ot=Object.prototype.propertyIsEnumerable;var de=(e,t,r)=>t in e?L(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,d=(e,t)=>{for(var r in t||(t={}))me.call(t,r)&&de(e,r,t[r]);if(pe)for(var r of pe(t))ot.call(t,r)&&de(e,r,t[r]);return e},E=(e,t)=>Ye(e,et(t)),st=e=>L(e,"__esModule",{value:!0});var it=(e,t,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of tt(t))!me.call(e,o)&&o!=="default"&&L(e,o,{get:()=>t[o],enumerable:!(r=Ze(t,o))||r.enumerable});return e},a=e=>it(st(L(e!=null?Xe(rt(e)):{},"default",e&&e.__esModule&&"default"in e?{get:()=>e.default,enumerable:!0}:{value:e,enumerable:!0})),e);var le=a(require("fs-extra")),Ge=a(require("sade"));var nt="presta",at="0.35.0",lt="Hyper minimal framework for the modern web.",ct="dist/index.js",ut="index.d.ts",pt=["dist","index.d.ts"],mt={presta:"dist/cli.js"},dt={prepare:"pnpm build",build:"node scripts/build",test:"rm -rf ./fixtures && NODE_ENV=test node test","test:watch":"NODE_ENV=test nodemon -e js,ts --ignore fixtures/ test",cloc:"pnpx cloc lib/*.ts",typecheck:"pnpx tsc --noEmit"},gt={type:"git",url:"git+ssh://git@github.com/sure-thing/presta.git"},ft="estrattonbailey",ht="MIT",bt={url:"https://github.com/sure-thing/presta/issues"},yt="https://github.com/sure-thing/presta#readme",xt={"@netlify/functions":"^0.7.2","@types/mime-types":"^2.1.0",chokidar:"^3.4.3",deepmerge:"^4.2.2",esbuild:"^0.12.9","esbuild-register":"^2.5.0",filewatcher:"^3.0.1","fs-extra":"^9.0.1","get-port":"^5.1.1",kleur:"^4.1.4","mime-types":"^2.1.31","module-alias":"^2.2.2",ms:"^2.1.2",picomatch:"^2.3.0","pocket.io":"^0.1.4","query-string":"^6.13.7","raw-body":"^2.4.1",regexparam:"^1.3.0","route-sort":"^1.0.0",sade:"^1.7.3",sirv:"^1.0.7","tiny-glob":"^0.2.9","watch-dependency-graph":"^2.6.1"},vt={"@types/fs-extra":"^9.0.12","@types/picomatch":"^2.2.4","@types/sade":"^1.7.3",baretest:"^2.0.0",nodemon:"^2.0.4",proxyquire:"^2.1.3","supertest-fetch":"^1.4.3"},ge={name:nt,version:at,description:lt,main:ct,types:ut,files:pt,bin:mt,scripts:dt,repository:gt,author:ft,license:ht,bugs:bt,homepage:yt,dependencies:xt,devDependencies:vt};var O=a(require("kleur"));var w=a(require("path"));function fe(){let e={};function t(i,...c){e[i]&&e[i].map(s=>s(...c))}function r(i,c){return e[i]=e[i]?e[i].concat(c):[c],()=>e[i].splice(e[i].indexOf(c),1)}function o(){e={}}function n(i){return e[i]||[]}return{emit:t,on:r,clear:o,listeners:n}}var he="presta.config.js",x;(function(o){o.PRODUCTION="production",o.DEVELOPMENT="development",o.TEST="test"})(x||(x={}));var wt={pid:process.pid,cwd:process.cwd(),env:x.TEST,debug:!1};function Z(e){return global.__presta__=e,e}function P(){return global.__presta__||Z(wt),global.__presta__}function be(e){let t=process.cwd();return e.files&&(e.files=[].concat(e.files).map(r=>w.default.resolve(t,r))),e.output&&(e.output=w.default.resolve(t,e.output)),e.assets&&(e.assets=w.default.resolve(t,e.assets)),e}function k(e,t=!1){try{return require(w.default.resolve(e||he))}catch(r){return f({label:"error",error:r}),t&&process.exit(1),{}}}function ye(){return p({label:"debug",message:"config file values cleared"}),Z(T(E(d({},P()),{config:{}})))}function T({env:e=P().env,config:t={},cli:r={}}){t=be(d({},t)),r=be(d({},r));let o={output:r.output||t.output||w.default.resolve("build"),assets:r.assets||t.assets||w.default.resolve("public"),files:r.files&&r.files.length?r.files:t.files?[].concat(t.files):[]},n=Z(E(d(d({},P()),o),{env:e,debug:r.debug||P().debug,cwd:process.cwd(),configFilepath:w.default.resolve(r.config||he),functionsOutputDir:w.default.join(o.output,"functions"),staticOutputDir:w.default.join(o.output,"static"),routesManifest:w.default.join(o.output,"routes.json"),events:fe()}));return t.plugins&&t.plugins.map(i=>{try{i()}catch(c){f({label:"error",error:c})}}),p({label:"debug",message:`config created ${JSON.stringify(n)}`}),n}var S;(function(n){n.Debug="debug",n.Info="info",n.Warn="warn",n.Err="error"})(S||(S={}));var xe=[],St={[S.Debug]:"magenta",[S.Info]:"blue",[S.Warn]:"yellow",[S.Err]:"red"};function U(e){if(process.env.TESTING)xe.push(e);else{let t=P().debug,r=P().env===x.PRODUCTION?"prod":"dev";if(!t&&e.level===S.Debug)return;console.log([O.default.gray(r),O.default[St[e.level||"info"]](e.label),e.message,e.duration?O.default.gray("+"+e.duration):"",e.error?`

${e.error.stack||e.error}

`:""].filter(Boolean).join(" "))}}function p(e){U(d({level:S.Debug},e))}function y(e){U(d({level:S.Info},e))}function C(e){U(d({level:S.Warn},e))}function f(e){U(d({level:S.Err},e))}function q(...e){P().env===x.TEST?xe.push(e):console.log(...e)}function $(){P().env!==x.TEST&&console.log("")}var K=a(require("fs-extra")),De=a(require("watch-dependency-graph")),ke=a(require("chokidar")),je=a(require("picomatch"));var z=a(require("fs-extra")),ee=a(require("path")),we=a(require("route-sort"));function ve(e){for(var t=5381,r=e.length;r;)t=t*33^e.charCodeAt(--r);return(t>>>0).toString(36)}function Ft(e,t){let{route:r}=require(e),o=ee.default.basename(e).split(".").reverse().slice(1).reverse().join("."),n=ee.default.join(t.functionsOutputDir,t.env===x.PRODUCTION?o+"-"+ve(z.default.readFileSync(e,"utf8"))+".js":o+".js");return p({label:"debug",message:`generating ${o} lambda`}),delete require.cache[e],delete require.cache[n],z.default.outputFileSync(n,`import { wrapHandler } from 'presta';
import * as file from '${e}';
export const route = file.route
export const handler = wrapHandler(file)`),[r,n]}function G(e,t){let r=e.map(i=>{try{return Ft(i,t)}catch(c){return f({label:"error",error:c}),null}}).filter(Boolean),o=(0,we.default)(r.map(i=>i[0])),n={};for(let i of o){let c=r.find(s=>s[0]===i);c&&(n[i]=c[1])}return z.default.outputFileSync(t.routesManifest,JSON.stringify(n)),r}var te=a(require("fs-extra")),Se=a(require("path")),Fe=a(require("tiny-glob/sync"));function D(e){return/export\s.+\sroute\s+\=/.test(te.default.readFileSync(e,"utf-8"))}function I(e){return/export\s.+\sgetStaticPaths/.test(te.default.readFileSync(e,"utf-8"))}function N(e){return[].concat(e.files).map(t=>(0,Fe.default)(t,{cwd:e.cwd})).flat().map(t=>Se.default.resolve(e.cwd,t))}var Te=a(require("fs-extra")),re=a(require("path")),Oe=a(require("mime-types"));function F(){let e=process.hrtime();return()=>{let[t,r]=process.hrtime(e),o=r/1e6;return t<1?(o>=1?o.toFixed(0):o.toFixed(2))+"ms":t+"."+o.toFixed(0)+"s"}}var Ce=a(require("regexparam"));function Ee(e,t){let r=(0,Ce.default)(t),o=0,n={},i=r.pattern.exec(e)||[];for(;o<r.keys.length;)n[r.keys[o]]=i[++o];return n}function Ct(e){return typeof e=="object"?JSON.stringify(e):e}function J(e){let{isBase64Encoded:t=!1,statusCode:r=200,headers:o={},multiValueHeaders:n={},body:i="",html:c=void 0,json:s=void 0,xml:l=void 0}=typeof e=="string"?{body:e}:e,u="text/html; charset=utf-8";return s?u="application/json; charset=utf-8":l&&(u="application/xml; charset=utf-8"),{isBase64Encoded:t,statusCode:r,headers:d({"Content-Type":u},o),multiValueHeaders:n,body:Ct(i||c||s||l||"")}}var _={};var Pe=a(require("fs-extra")),$e=a(require("path"));function H(e,t){p({label:"debug",message:`removing old static file ${e}`}),Pe.default.remove($e.default.join(t.staticOutputDir,e))}function Et(e,t="html"){return re.default.extname(e)?e:t==="html"?`${e}/index.html`:`${e}.${t}`}function A(e,t){return new Promise(async(r,o)=>{p({label:"debug",message:`rendering ${JSON.stringify(e)}`});let n=[];for(let i of e){let c=i.replace(t.cwd,"");try{delete require.cache[i];let s=require(i),l=await s.getStaticPaths(),u=_[i]=_[i]||[],m=[];if(!l||!l.length){C({label:"paths",message:`${c} - no paths to render`}),u.forEach(h=>H(h,t));continue}for(let h of l){let ce=F(),B={path:h,params:s.route?Ee(h,s.route):{}},g=J(await s.handler(B,{})),V=g.headers?g.headers["Content-Type"]:"",v=V&&Oe.default.extension(V)||"html",R=Et(h,v);n.push(R),m.push(R),Te.default.outputFileSync(re.default.join(t.staticOutputDir,R),g.body,"utf-8"),y({label:"built",message:h,duration:ce()})}for(let h of u)m.includes(h)||H(h,t);_[i]=m}catch(s){t.env==="development"?(f({label:"error",message:"errors detected, pausing...",error:s}),r({allGeneratedFiles:n})):(f({label:"error",error:s}),o(s));break}}r({allGeneratedFiles:n})})}function Q(e,t){let r=F();G(e,t),e.length&&y({label:"built",message:"lambdas",duration:r()})}async function Re(e){let t=N(e),r=K.default.existsSync(e.configFilepath);t.length||C({label:"paths",message:"no files configured"}),Q(t.filter(D),e);let o=(0,De.default)({alias:{"@":e.cwd}}),n=ke.default.watch(e.cwd,{ignoreInitial:!0,ignored:[e.output,e.assets]});async function i(){t=N(e),await A(t.filter(I),e),Q(t.filter(D),e)}async function c(s){I(s)&&await A([s],e),D(s)&&Q(t.filter(D),e),e.events.emit("refresh"),e.events.emit("done",[s])}o.on("remove",([s])=>{p({label:"watch",message:`fileWatcher - removed ${s}`}),t.splice(t.indexOf(s),1),Q(t.filter(D),e),s===e.configFilepath&&(e=ye(),r=!1,i()),(_[s]||[]).forEach(l=>H(l,e)),e.events.emit("remove",s)}),o.on("change",([s])=>{if(p({label:"watch",message:`fileWatcher - changed ${s}`}),s===e.configFilepath){delete require.cache[e.configFilepath];try{e=T({config:k(e.configFilepath)}),i()}catch(l){f({label:"error",error:l})}}else c(s);e.events.emit("change",s)}),o.on("error",s=>{f({label:"error",error:s})}),n.on("all",async(s,l)=>{if(!(!/add|change/.test(s)||!K.default.existsSync(l)||K.default.lstatSync(l).isDirectory())){if((0,je.default)(e.files)(l)&&!t.includes(l)&&(p({label:"watch",message:`globalWatcher - add ${l}`}),t.push(l),o.add(l),c(l)),l===e.configFilepath&&!r){p({label:"watch",message:`globalWatcher - add config file ${l}`}),o.add(e.configFilepath);try{e=T({config:k(e.configFilepath)}),r=!0,i()}catch(u){f({label:"error",error:u})}}e.events.emit("add",l)}}),o.add(t),r&&o.add(e.configFilepath);try{t.map(require)}catch(s){f({label:"error",error:s})}}var oe=a(require("fs-extra")),_e=a(require("esbuild"));function Pt(e){try{return require(e)}catch(t){return{}}}async function Me(e){let t=F(),r=N(e),o=r.filter(I),n=r.filter(D);if(p({label:"build",message:"starting build"}),!o.length&&!n.length)C({label:"files",message:"no files were found, nothing to build"});else{let i="",c=0,s="",l="",u=await Promise.allSettled([(async()=>{if(o.length){let m=F(),{allGeneratedFiles:h}=await A(o,e);i=m(),c=h.length}})(),(async()=>{if(n.length){let m=F();G(n,e),await(0,_e.build)({entryPoints:Object.values(require(e.routesManifest)),outdir:e.functionsOutputDir,bundle:!0,platform:"node",target:["node12"],minify:!0,allowOverwrite:!0}),s=m()}})(),(async()=>{if(oe.default.existsSync(e.assets)){let m=F();oe.default.copySync(e.assets,e.staticOutputDir),l=m()}})()]);if(u.find(m=>m.status==="rejected")){p({label:"build",message:"build partially failed"}),u.forEach(m=>{m.status==="rejected"&&f({label:"error",error:m.reason})}),process.exit(1);return}(i||s)&&$(),i&&y({label:"static",message:`rendered ${c} file(s)`,duration:i}),s&&y({label:"lambda",message:`compiled ${n.length} function(s)`,duration:s}),l&&y({label:"assets",message:`copied in ${l}`}),(i||s)&&($(),y({label:"complete",message:`in ${t()}`}),$()),e.events.emit("postbuild",{output:e.output,staticOutput:e.staticOutputDir,functionsOutput:e.functionsOutputDir,functionsManifest:Pt(e.routesManifest)})}}var ie=a(require("fs")),X=a(require("path")),Be=a(require("http")),Ve=a(require("get-port")),ne=a(require("sirv")),Le=a(require("chokidar")),Ue=a(require("mime-types")),qe=a(require("regexparam"));var se=`<!-- built with presta https://npm.im/presta -->
<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>404</title>
    <link
      rel="stylesheet"
      type="text/css"
      href="https://unpkg.com/svbstrate@4.1.1/dist/svbstrate.css"
    />
  </head>
  <body>
    <div class="f aic jcc" style="height: 100vh">
      <h2 class="p1" style="color: blue">404 Not Found</h2>
    </div>
  </body>
</html>`;var Ie=a(require("url")),Ne=a(require("query-string")),He=a(require("raw-body")),Ae=a(require("mime-types")),$t=/image|audio|video|application\/pdf|application\/zip|applicaton\/octet-stream/i;function Tt(e){return Boolean(e)&&$t.test(e)}async function We(e){var i;let t=String(e.headers["x-forwarded-for"])||e.connection.remoteAddress||"",r=(i=t.split(t.includes(".")?":":",").pop())==null?void 0:i.trim(),o=Tt(e.headers["content-type"]||""),n=e.headers["content-length"]?await(0,He.default)(e,{limit:"1mb",encoding:Ae.default.charset(e.headers["content-type"]||"")||void 0}):void 0;return{path:e.url,httpMethod:e.method,headers:E(d({},e.headers),{"client-ip":r}),multiValueHeaders:Object.keys(e.headers).reduce((c,s)=>e.headers[s]&&!e.headers[s].includes(",")?c:E(d({},c),{[s]:e.headers[s].split(",")}),{}),queryStringParameters:(0,Ne.parse)((0,Ie.parse)(e.url).query),body:n?new Buffer(n).toString(o?"base64":"utf8"):null,isBase64Encoded:o}}function j(e,t){let r=J(t);for(let o in t.multiValueHeaders)e.setHeader(o,String(t.multiValueHeaders[o]));for(let o in t.headers)e.setHeader(o,String(t.headers[o]));e.statusCode=r.statusCode,e.write(r.body),e.end()}var Ot=["position: fixed","bottom: 24px","right: 24px","width: 32px","height: 32px","border-radius: 32px","background: white","color: #FF7A93","font-size: 20px","font-weight: bold","text-align: center","line-height: 31px","box-shadow: 0px 0px 1px rgba(0, 0, 0, 0.04), 0px 4px 8px rgba(0, 0, 0, 0.04), 0px 16px 24px rgba(0, 0, 0, 0.04), 0px 24px 32px rgba(0, 0, 0, 0.04)"],M=`
  <div style="${Ot.join(";")}">~</div>
`;function ze(e,t){let r=X.default.join(e,t);if(!X.default.extname(t))try{return ie.default.readFileSync(X.default.join(e,t,"index.html"),"utf8")}catch(o){}return ie.default.readFileSync(r,"utf8")}function Dt({port:e}){return`
    <script>
      (function (global) {
        try {
          const socketio = document.createElement('script')
          socketio.src = 'https://unpkg.com/pocket.io@0.1.4/min.js'
          socketio.onload = function init () {
            var disconnected = false
            var socket = io('http://localhost:${e}', {
              reconnectionAttempts: 3
            })
            socket.on('connect', function() { console.log('presta connected') })
            socket.on('refresh', function() {
              global.location.reload()
            })
            socket.on('disconnect', function() {
              disconnected = true
            })
            socket.on('reconnect_failed', function(e) {
              if (disconnected) return
              console.error("presta - connection to server on :${e} failed")
            })
          }
          document.head.appendChild(socketio)
        } catch (e) {}
      })(this);
    <\/script>
  `}function kt({port:e,config:t}){let r=Dt({port:e}),o=t.staticOutputDir,n=t.assets;return async function(c,s){let l=F(),u=c.url;if(/^.+\..+$/.test(u)&&!/\.html?$/.test(u))p({label:"debug",message:`attempting to serve static asset ${u}`}),(0,ne.default)(n,{dev:!0})(c,s,()=>{(0,ne.default)(o,{dev:!0})(c,s,()=>{C({label:"serve",message:`404 ${u}`,duration:l()}),j(s,{statusCode:404,body:se+r+M})})});else try{p({label:"debug",message:`attempting to render static HTML for ${u}`});let m=ze(o,u)+r+M;y({label:"serve",message:`200 ${u}`,duration:l()}),j(s,{body:m})}catch(m){p({label:"debug",message:"serve error",error:m}),/ENOENT|EISDIR/.test(m.message)||console.error(m);try{let h=require(t.routesManifest),B=Object.keys(h).map(g=>({matcher:(0,qe.default)(g),route:g})).filter(({matcher:g})=>g.pattern.test(u.split("?")[0])).map(({route:g})=>h[g])[0];if(B){p({label:"debug",message:`attempting to render lambda for ${u}`});let{handler:g}=require(B),V=await We(c),v=await g(V,{}),R=v.headers||{},Ke=v.statusCode>299&&v.statusCode<399,ue=R["Content-Type"],Qe=ue?Ue.default.extension(ue):"html";y({label:"serve",message:`${v.statusCode} ${Ke?R.Location:u}`,duration:l()}),j(s,{statusCode:v.statusCode,headers:v.headers,multiValueHeaders:v.multiValueHeaders,body:Qe==="html"?(v.body||"").split("</body>")[0]+r+M:v.body})}else{p({label:"debug",message:`attempting to render static 404.html page for ${u}`});try{let g=ze(o,"404")+r+M;C({label:"serve",message:`404 ${u}`,duration:l()}),j(s,{statusCode:404,body:g})}catch(g){g.message.includes("ENOENT")||console.error(g),p({label:"debug",message:`rendering default 404 HTML page for ${u}`}),C({label:"serve",message:`404 ${u}`,duration:l()}),j(s,{statusCode:404,body:se+r+M})}}}catch(h){p({label:"debug",message:`rendering default 500 HTML page for ${u}`}),f({label:"serve",message:`500 ${u}`,error:h,duration:l()}),j(s,{statusCode:500,body:""+r+M})}}}}async function ae(e){let t=await(0,Ve.default)({port:4e3}),r=Be.default.createServer(kt({port:t,config:e})).listen(t),o=require("pocket.io")(r,{serveClient:!1});return e.events.on("refresh",()=>{p({label:"debug",message:"refresh event received"}),o.emit("refresh")}),Le.default.watch(e.assets,{ignoreInitial:!0}).on("all",()=>{e.events.emit("refresh")}),{port:t}}var W=(0,Ge.default)("presta"),Y="presta.config.js";function Je(e={}){require("module-alias").addAliases({"@":process.cwd(),"presta:internal":__dirname}),require("esbuild-register/dist/node").register(e)}W.version(ge.version).option("--config, -c",`Path to a config file \u2014 defaults to ${Y}`).option("--output, -o","Specify output directory for built files \u2014 defaults to ./build").option("--assets, -a","Specify static asset directory \u2014 defaults to ./public").option("--debug, -d","Enable debug mode (prints more logs)");W.command("build","Render files(s) to output directory.",{default:!0}).example("build").example("build files/**/*.js").example(`build -c ${Y}`).action(async e=>{Je(),console.clear();let t=T({env:x.PRODUCTION,config:k(e.config,!0),cli:E(d({},e),{files:e._})});le.default.emptyDirSync(t.output),q(`${O.default.blue("presta build")}`),$(),await Me(t)});W.command("watch").option("--no-serve, -n","Do not run local dev server.",!1).describe("Watch and build files(s) to output directory").example("watch").example("watch ./files/**/*.js").example("watch ./files/**/*.js -o ./out").example(`watch -c ${Y}`).action(async e=>{Je(),console.clear();let t=T({env:x.DEVELOPMENT,config:k(e.config),cli:E(d({},e),{files:e._})});if(le.default.emptyDirSync(t.output),e.n)y({label:"dev"}),$();else{let r=await ae(t);q(`${O.default.blue("presta dev")} - http://localhost:${r.port}`),$()}Re(t)});W.command("serve").describe("Serve built files.").example("serve").example("serve -o ./out").example(`watch -c ${Y}`).action(async e=>{console.clear();let t=T({env:x.PRODUCTION,config:k(e.config),cli:e}),r=await ae(t);q(`${O.default.blue("presta serve")} - http://localhost:${r.port}`),$()});W.parse(process.argv);
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsiLi4vbGliL2NsaS50cyIsICIuLi9saWIvbG9nLnRzIiwgIi4uL2xpYi9jb25maWcudHMiLCAiLi4vbGliL2NyZWF0ZUVtaXR0ZXIudHMiLCAiLi4vbGliL3dhdGNoLnRzIiwgIi4uL2xpYi9vdXRwdXRMYW1iZGFzLnRzIiwgIi4uL2xpYi9oYXNoQ29udGVudC50cyIsICIuLi9saWIvZ2V0RmlsZXMudHMiLCAiLi4vbGliL3JlbmRlclN0YXRpY0VudHJpZXMudHMiLCAiLi4vbGliL3RpbWVyLnRzIiwgIi4uL2xpYi9nZXRSb3V0ZVBhcmFtcy50cyIsICIuLi9saWIvbm9ybWFsaXplUmVzcG9uc2UudHMiLCAiLi4vbGliL2J1aWx0U3RhdGljRmlsZXMudHMiLCAiLi4vbGliL3JlbW92ZUJ1aWx0U3RhdGljRmlsZS50cyIsICIuLi9saWIvYnVpbGQudHMiLCAiLi4vbGliL3NlcnZlLnRzIiwgIi4uL2xpYi9kZWZhdWx0NDA0LnRzIiwgIi4uL2xpYi9yZXF1ZXN0VG9FdmVudC50cyIsICIuLi9saWIvc2VuZFNlcnZlcmxlc3NSZXNwb25zZS50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiIyEvdXNyL2Jpbi9lbnYgbm9kZVxuXG5pbXBvcnQgZnMgZnJvbSAnZnMtZXh0cmEnXG5pbXBvcnQgc2FkZSBmcm9tICdzYWRlJ1xuXG5pbXBvcnQgcGtnIGZyb20gJy4uL3BhY2thZ2UuanNvbidcblxuaW1wb3J0ICogYXMgbG9nZ2VyIGZyb20gJy4vbG9nJ1xuaW1wb3J0IHsgY3JlYXRlQ29uZmlnLCBnZXRDb25maWdGaWxlLCBFbnYgfSBmcm9tICcuL2NvbmZpZydcbmltcG9ydCB7IHdhdGNoIH0gZnJvbSAnLi93YXRjaCdcbmltcG9ydCB7IGJ1aWxkIH0gZnJvbSAnLi9idWlsZCdcbmltcG9ydCB7IHNlcnZlIH0gZnJvbSAnLi9zZXJ2ZSdcblxuY29uc3QgcHJvZyA9IHNhZGUoJ3ByZXN0YScpXG5jb25zdCBDT05GSUdfREVGQVVMVCA9ICdwcmVzdGEuY29uZmlnLmpzJ1xuXG5mdW5jdGlvbiByZWdpc3RlclJ1bnRpbWUob3B0aW9ucyA9IHt9KSB7XG4gIHJlcXVpcmUoJ21vZHVsZS1hbGlhcycpLmFkZEFsaWFzZXMoe1xuICAgICdAJzogcHJvY2Vzcy5jd2QoKSxcbiAgICAncHJlc3RhOmludGVybmFsJzogX19kaXJuYW1lLCAvLyB3aGVyZXZlciB0aGlzIGlzIHJ1bm5pbmcgZnJvbVxuICB9KVxuXG4gIHJlcXVpcmUoJ2VzYnVpbGQtcmVnaXN0ZXIvZGlzdC9ub2RlJykucmVnaXN0ZXIob3B0aW9ucylcbn1cblxucHJvZ1xuICAudmVyc2lvbihwa2cudmVyc2lvbilcbiAgLm9wdGlvbignLS1jb25maWcsIC1jJywgYFBhdGggdG8gYSBjb25maWcgZmlsZSBcdTIwMTQgZGVmYXVsdHMgdG8gJHtDT05GSUdfREVGQVVMVH1gKVxuICAub3B0aW9uKCctLW91dHB1dCwgLW8nLCBgU3BlY2lmeSBvdXRwdXQgZGlyZWN0b3J5IGZvciBidWlsdCBmaWxlcyBcdTIwMTQgZGVmYXVsdHMgdG8gLi9idWlsZGApXG4gIC5vcHRpb24oJy0tYXNzZXRzLCAtYScsIGBTcGVjaWZ5IHN0YXRpYyBhc3NldCBkaXJlY3RvcnkgXHUyMDE0IGRlZmF1bHRzIHRvIC4vcHVibGljYClcbiAgLm9wdGlvbignLS1kZWJ1ZywgLWQnLCBgRW5hYmxlIGRlYnVnIG1vZGUgKHByaW50cyBtb3JlIGxvZ3MpYClcblxucHJvZ1xuICAuY29tbWFuZCgnYnVpbGQnLCAnUmVuZGVyIGZpbGVzKHMpIHRvIG91dHB1dCBkaXJlY3RvcnkuJywgeyBkZWZhdWx0OiB0cnVlIH0pXG4gIC5leGFtcGxlKGBidWlsZGApXG4gIC5leGFtcGxlKGBidWlsZCBmaWxlcy8qKi8qLmpzYClcbiAgLmV4YW1wbGUoYGJ1aWxkIC1jICR7Q09ORklHX0RFRkFVTFR9YClcbiAgLmFjdGlvbihhc3luYyAob3B0cykgPT4ge1xuICAgIHJlZ2lzdGVyUnVudGltZSgpXG5cbiAgICBjb25zb2xlLmNsZWFyKClcblxuICAgIGNvbnN0IGNvbmZpZyA9IGNyZWF0ZUNvbmZpZyh7XG4gICAgICBlbnY6IEVudi5QUk9EVUNUSU9OLFxuICAgICAgY29uZmlnOiBnZXRDb25maWdGaWxlKG9wdHMuY29uZmlnLCB0cnVlKSxcbiAgICAgIGNsaToge1xuICAgICAgICAuLi5vcHRzLFxuICAgICAgICBmaWxlczogb3B0cy5fLFxuICAgICAgfSxcbiAgICB9KVxuXG4gICAgZnMuZW1wdHlEaXJTeW5jKGNvbmZpZy5vdXRwdXQpXG5cbiAgICBsb2dnZXIucmF3KGAke2xvZ2dlci5jb2xvcnMuYmx1ZSgncHJlc3RhIGJ1aWxkJyl9YClcbiAgICBsb2dnZXIubmV3bGluZSgpXG5cbiAgICBhd2FpdCBidWlsZChjb25maWcpXG4gIH0pXG5cbnByb2dcbiAgLmNvbW1hbmQoJ3dhdGNoJylcbiAgLm9wdGlvbignLS1uby1zZXJ2ZSwgLW4nLCBgRG8gbm90IHJ1biBsb2NhbCBkZXYgc2VydmVyLmAsIGZhbHNlKVxuICAuZGVzY3JpYmUoJ1dhdGNoIGFuZCBidWlsZCBmaWxlcyhzKSB0byBvdXRwdXQgZGlyZWN0b3J5JylcbiAgLmV4YW1wbGUoYHdhdGNoYClcbiAgLmV4YW1wbGUoYHdhdGNoIC4vZmlsZXMvKiovKi5qc2ApXG4gIC5leGFtcGxlKGB3YXRjaCAuL2ZpbGVzLyoqLyouanMgLW8gLi9vdXRgKVxuICAuZXhhbXBsZShgd2F0Y2ggLWMgJHtDT05GSUdfREVGQVVMVH1gKVxuICAuYWN0aW9uKGFzeW5jIChvcHRzKSA9PiB7XG4gICAgcmVnaXN0ZXJSdW50aW1lKClcblxuICAgIGNvbnNvbGUuY2xlYXIoKVxuXG4gICAgY29uc3QgY29uZmlnID0gY3JlYXRlQ29uZmlnKHtcbiAgICAgIGVudjogRW52LkRFVkVMT1BNRU5ULFxuICAgICAgY29uZmlnOiBnZXRDb25maWdGaWxlKG9wdHMuY29uZmlnKSxcbiAgICAgIGNsaToge1xuICAgICAgICAuLi5vcHRzLFxuICAgICAgICBmaWxlczogb3B0cy5fLFxuICAgICAgfSxcbiAgICB9KVxuXG4gICAgZnMuZW1wdHlEaXJTeW5jKGNvbmZpZy5vdXRwdXQpXG5cbiAgICBpZiAoIW9wdHMubikge1xuICAgICAgY29uc3Qgc2VydmVyID0gYXdhaXQgc2VydmUoY29uZmlnKVxuXG4gICAgICBsb2dnZXIucmF3KGAke2xvZ2dlci5jb2xvcnMuYmx1ZSgncHJlc3RhIGRldicpfSAtIGh0dHA6Ly9sb2NhbGhvc3Q6JHtzZXJ2ZXIucG9ydH1gKVxuICAgICAgbG9nZ2VyLm5ld2xpbmUoKVxuICAgIH0gZWxzZSB7XG4gICAgICBsb2dnZXIuaW5mbyh7XG4gICAgICAgIGxhYmVsOiAnZGV2JyxcbiAgICAgIH0pXG4gICAgICBsb2dnZXIubmV3bGluZSgpXG4gICAgfVxuXG4gICAgd2F0Y2goY29uZmlnKVxuICB9KVxuXG5wcm9nXG4gIC5jb21tYW5kKCdzZXJ2ZScpXG4gIC5kZXNjcmliZSgnU2VydmUgYnVpbHQgZmlsZXMuJylcbiAgLmV4YW1wbGUoYHNlcnZlYClcbiAgLmV4YW1wbGUoYHNlcnZlIC1vIC4vb3V0YClcbiAgLmV4YW1wbGUoYHdhdGNoIC1jICR7Q09ORklHX0RFRkFVTFR9YClcbiAgLmFjdGlvbihhc3luYyAob3B0cykgPT4ge1xuICAgIGNvbnNvbGUuY2xlYXIoKVxuXG4gICAgY29uc3QgY29uZmlnID0gY3JlYXRlQ29uZmlnKHtcbiAgICAgIGVudjogRW52LlBST0RVQ1RJT04sXG4gICAgICBjb25maWc6IGdldENvbmZpZ0ZpbGUob3B0cy5jb25maWcpLFxuICAgICAgY2xpOiBvcHRzLFxuICAgIH0pXG4gICAgY29uc3Qgc2VydmVyID0gYXdhaXQgc2VydmUoY29uZmlnKVxuXG4gICAgbG9nZ2VyLnJhdyhgJHtsb2dnZXIuY29sb3JzLmJsdWUoJ3ByZXN0YSBzZXJ2ZScpfSAtIGh0dHA6Ly9sb2NhbGhvc3Q6JHtzZXJ2ZXIucG9ydH1gKVxuICAgIGxvZ2dlci5uZXdsaW5lKClcbiAgfSlcblxucHJvZy5wYXJzZShwcm9jZXNzLmFyZ3YpXG4iLCAiaW1wb3J0IGMsIHsgS2xldXIgfSBmcm9tICdrbGV1cidcblxuaW1wb3J0IHsgZ2V0Q3VycmVudENvbmZpZywgRW52IH0gZnJvbSAnLi9jb25maWcnXG5cbmV4cG9ydCBlbnVtIExldmVscyB7XG4gIERlYnVnID0gJ2RlYnVnJyxcbiAgSW5mbyA9ICdpbmZvJyxcbiAgV2FybiA9ICd3YXJuJyxcbiAgRXJyID0gJ2Vycm9yJyxcbn1cblxuZXhwb3J0IHR5cGUgTWVzc2FnZSA9IHtcbiAgbGV2ZWw/OiBMZXZlbHNcbiAgbGFiZWw6IHN0cmluZyB8IG51bWJlclxuICBtZXNzYWdlPzogc3RyaW5nXG4gIGR1cmF0aW9uPzogc3RyaW5nIHwgbnVtYmVyXG4gIGVycm9yPzogRXJyb3Jcbn1cblxubGV0IGxvZ3M6IGFueVtdID0gW11cblxuY29uc3QgY29sb3JzID0ge1xuICBbTGV2ZWxzLkRlYnVnXTogJ21hZ2VudGEnLFxuICBbTGV2ZWxzLkluZm9dOiAnYmx1ZScsXG4gIFtMZXZlbHMuV2Fybl06ICd5ZWxsb3cnLFxuICBbTGV2ZWxzLkVycl06ICdyZWQnLFxufVxuXG5leHBvcnQgeyBjIGFzIGNvbG9ycyB9XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRMb2dzKCkge1xuICBpZiAoZ2V0Q3VycmVudENvbmZpZygpLmVudiAhPT0gRW52LlRFU1QpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludGVybmFsIG1ldGhvZCB3YXMgY2FsbGVkIG91dHNpZGUgdGVzdCBtb2RlJylcbiAgfVxuXG4gIHJldHVybiBsb2dzXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBsb2dnZXIobWVzc2FnZTogTWVzc2FnZSkge1xuICBpZiAocHJvY2Vzcy5lbnYuVEVTVElORykge1xuICAgIGxvZ3MucHVzaChtZXNzYWdlKVxuICB9IGVsc2Uge1xuICAgIGNvbnN0IGRlYnVnID0gZ2V0Q3VycmVudENvbmZpZygpLmRlYnVnXG4gICAgY29uc3QgY29udGV4dCA9IGdldEN1cnJlbnRDb25maWcoKS5lbnYgPT09IEVudi5QUk9EVUNUSU9OID8gJ3Byb2QnIDogJ2RldidcblxuICAgIGlmICghZGVidWcgJiYgbWVzc2FnZS5sZXZlbCA9PT0gTGV2ZWxzLkRlYnVnKSByZXR1cm5cblxuICAgIGNvbnNvbGUubG9nKFxuICAgICAgW1xuICAgICAgICBjLmdyYXkoY29udGV4dCksXG4gICAgICAgIGNbY29sb3JzW21lc3NhZ2UubGV2ZWwgfHwgJ2luZm8nXSBhcyBrZXlvZiBLbGV1cl0obWVzc2FnZS5sYWJlbCksXG4gICAgICAgIG1lc3NhZ2UubWVzc2FnZSxcbiAgICAgICAgbWVzc2FnZS5kdXJhdGlvbiA/IGMuZ3JheSgnKycgKyBtZXNzYWdlLmR1cmF0aW9uKSA6ICcnLFxuICAgICAgICBtZXNzYWdlLmVycm9yID8gYFxcblxcbiR7bWVzc2FnZS5lcnJvci5zdGFjayB8fCBtZXNzYWdlLmVycm9yfVxcblxcbmAgOiAnJyxcbiAgICAgIF1cbiAgICAgICAgLmZpbHRlcihCb29sZWFuKVxuICAgICAgICAuam9pbignICcpXG4gICAgKVxuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBkZWJ1ZyhtZXNzYWdlOiBNZXNzYWdlKSB7XG4gIGxvZ2dlcih7IGxldmVsOiBMZXZlbHMuRGVidWcsIC4uLm1lc3NhZ2UgfSlcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGluZm8obWVzc2FnZTogTWVzc2FnZSkge1xuICBsb2dnZXIoeyBsZXZlbDogTGV2ZWxzLkluZm8sIC4uLm1lc3NhZ2UgfSlcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHdhcm4obWVzc2FnZTogTWVzc2FnZSkge1xuICBsb2dnZXIoeyBsZXZlbDogTGV2ZWxzLldhcm4sIC4uLm1lc3NhZ2UgfSlcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGVycm9yKG1lc3NhZ2U6IE1lc3NhZ2UpIHtcbiAgbG9nZ2VyKHsgbGV2ZWw6IExldmVscy5FcnIsIC4uLm1lc3NhZ2UgfSlcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHJhdyguLi5hcmdzOiBhbnlbXSkge1xuICBpZiAoZ2V0Q3VycmVudENvbmZpZygpLmVudiA9PT0gRW52LlRFU1QpIHtcbiAgICBsb2dzLnB1c2goYXJncylcbiAgfSBlbHNlIHtcbiAgICBjb25zb2xlLmxvZyguLi5hcmdzKVxuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBuZXdsaW5lKCkge1xuICBpZiAoZ2V0Q3VycmVudENvbmZpZygpLmVudiA9PT0gRW52LlRFU1QpIHJldHVyblxuICBjb25zb2xlLmxvZygnJylcbn1cbiIsICJpbXBvcnQgcGF0aCBmcm9tICdwYXRoJ1xuXG5pbXBvcnQgKiBhcyBsb2dnZXIgZnJvbSAnLi9sb2cnXG5pbXBvcnQgeyBjcmVhdGVFbWl0dGVyIH0gZnJvbSAnLi9jcmVhdGVFbWl0dGVyJ1xuXG5pbXBvcnQgdHlwZSB7IFByZXN0YSwgQ29uZmlnLCBDTEkgfSBmcm9tICcuLidcblxuY29uc3QgZGVmYXVsdENvbmZpZ0ZpbGVwYXRoID0gJ3ByZXN0YS5jb25maWcuanMnXG5cbmV4cG9ydCBlbnVtIEVudiB7XG4gIFBST0RVQ1RJT04gPSAncHJvZHVjdGlvbicsXG4gIERFVkVMT1BNRU5UID0gJ2RldmVsb3BtZW50JyxcbiAgVEVTVCA9ICd0ZXN0Jyxcbn1cblxuY29uc3QgZGVmYXVsdENvbmZpZyA9IHtcbiAgcGlkOiBwcm9jZXNzLnBpZCxcbiAgY3dkOiBwcm9jZXNzLmN3ZCgpLFxuICBlbnY6IEVudi5URVNULFxuICBkZWJ1ZzogZmFsc2UsXG59IGFzIFByZXN0YVxuXG5mdW5jdGlvbiBzZXRDdXJyZW50Q29uZmlnKGNvbmZpZzogUHJlc3RhKTogUHJlc3RhIHtcbiAgLy8gQHRzLWlnbm9yZVxuICBnbG9iYWwuX19wcmVzdGFfXyA9IGNvbmZpZ1xuICByZXR1cm4gY29uZmlnXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRDdXJyZW50Q29uZmlnKCk6IFByZXN0YSB7XG4gIC8vIEB0cy1pZ25vcmVcbiAgaWYgKCFnbG9iYWwuX19wcmVzdGFfXykge1xuICAgIHNldEN1cnJlbnRDb25maWcoZGVmYXVsdENvbmZpZylcbiAgfVxuXG4gIC8vIEB0cy1pZ25vcmVcbiAgcmV0dXJuIGdsb2JhbC5fX3ByZXN0YV9fXG59XG5cbmZ1bmN0aW9uIHJlc29sdmVBYnNvbHV0ZVBhdGhzKGNvbmZpZzogQ29uZmlnKSB7XG4gIGNvbnN0IGN3ZCA9IHByb2Nlc3MuY3dkKClcblxuICBpZiAoY29uZmlnLmZpbGVzKSBjb25maWcuZmlsZXMgPSAoW10gYXMgc3RyaW5nW10pLmNvbmNhdChjb25maWcuZmlsZXMpLm1hcCgocCkgPT4gcGF0aC5yZXNvbHZlKGN3ZCwgcCkpXG4gIGlmIChjb25maWcub3V0cHV0KSBjb25maWcub3V0cHV0ID0gcGF0aC5yZXNvbHZlKGN3ZCwgY29uZmlnLm91dHB1dClcbiAgaWYgKGNvbmZpZy5hc3NldHMpIGNvbmZpZy5hc3NldHMgPSBwYXRoLnJlc29sdmUoY3dkLCBjb25maWcuYXNzZXRzKVxuICByZXR1cm4gY29uZmlnXG59XG5cbi8qKlxuICogQHByaXZhdGVcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIF9jbGVhckN1cnJlbnRDb25maWcoKSB7XG4gIC8vIEB0cy1pZ25vcmVcbiAgZ2xvYmFsLl9fcHJlc3RhX18gPSB7XG4gICAgcGlkOiBwcm9jZXNzLnBpZCxcbiAgICBjd2Q6IHByb2Nlc3MuY3dkKCksXG4gICAgZW52OiBFbnYuVEVTVCxcbiAgfVxufVxuXG4vKipcbiAqIEZldGNoIGEgY29uZmlnIGZpbGUuIElmIG9uZSB3YXMgc3BlY2lmaWVkIGJ5IHRoZSB1c2VyLCBsZXQgdGhlbSBrbm93IGlmXG4gKiBhbnl0aGluZyBnb2VzIHdyb25nLiBPdXRzaWRlIHdhdGNoIG1vZGUsIHRoaXMgc2hvdWxkIGV4aXQoMSkgaWYgdGhlIHVzZXJcbiAqIHByb3ZpZGVkIGEgY29uZmlnIGFuZCB0aGVyZSB3YXMgYW4gZXJyb3JcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldENvbmZpZ0ZpbGUoZmlsZXBhdGg6IHN0cmluZywgc2hvdWxkRXhpdDogYm9vbGVhbiA9IGZhbHNlKSB7XG4gIHRyeSB7XG4gICAgcmV0dXJuIHJlcXVpcmUocGF0aC5yZXNvbHZlKGZpbGVwYXRoIHx8IGRlZmF1bHRDb25maWdGaWxlcGF0aCkpXG4gIH0gY2F0Y2ggKGUpIHtcbiAgICBsb2dnZXIuZXJyb3Ioe1xuICAgICAgbGFiZWw6ICdlcnJvcicsXG4gICAgICBlcnJvcjogZSxcbiAgICB9KVxuXG4gICAgLy8gd2UncmUgbm90IGluIHdhdGNoIG1vZGUsIGV4aXRcbiAgICBpZiAoc2hvdWxkRXhpdCkgcHJvY2Vzcy5leGl0KDEpXG5cbiAgICByZXR1cm4ge31cbiAgfVxufVxuXG4vKipcbiAqIENyZWF0ZXMgYSBuZXcgaW5zdGFuY2UgX3dpdGhvdXRfIGFueSB2YWx1ZXMgcHJvdmlkZWQgYnkgdGhlIGNvbmZpZyBmaWxlLlxuICogVGhpcyBpcyB1c2VkIHdoZW4gdGhlIHVzZXIgZGVsZXRlcyB0aGVpciBjb25maWcgZmlsZS5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHJlbW92ZUNvbmZpZ1ZhbHVlcygpIHtcbiAgbG9nZ2VyLmRlYnVnKHtcbiAgICBsYWJlbDogJ2RlYnVnJyxcbiAgICBtZXNzYWdlOiBgY29uZmlnIGZpbGUgdmFsdWVzIGNsZWFyZWRgLFxuICB9KVxuXG4gIHJldHVybiBzZXRDdXJyZW50Q29uZmlnKFxuICAgIGNyZWF0ZUNvbmZpZyh7XG4gICAgICAuLi5nZXRDdXJyZW50Q29uZmlnKCksXG4gICAgICBjb25maWc6IHt9LFxuICAgIH0pXG4gIClcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUNvbmZpZyh7XG4gIGVudiA9IGdldEN1cnJlbnRDb25maWcoKS5lbnYsXG4gIGNvbmZpZyA9IHt9LFxuICBjbGkgPSB7fSxcbn06IHtcbiAgZW52PzogRW52XG4gIGNvbmZpZz86IFBhcnRpYWw8Q29uZmlnPlxuICBjbGk/OiBQYXJ0aWFsPENMST5cbn0pIHtcbiAgY29uZmlnID0gcmVzb2x2ZUFic29sdXRlUGF0aHMoeyAuLi5jb25maWcgfSkgLy8gY2xvbmUgcmVhZC1vbmx5IG9ialxuICBjbGkgPSByZXNvbHZlQWJzb2x1dGVQYXRocyh7IC4uLmNsaSB9KVxuXG4gIC8vIGNvbWJpbmVkIGNvbmZpZywgcHJlZmVyZW5jZSB0byBDTEkgYXJnc1xuICBjb25zdCBtZXJnZWQgPSB7XG4gICAgb3V0cHV0OiBjbGkub3V0cHV0IHx8IGNvbmZpZy5vdXRwdXQgfHwgcGF0aC5yZXNvbHZlKCdidWlsZCcpLFxuICAgIGFzc2V0czogY2xpLmFzc2V0cyB8fCBjb25maWcuYXNzZXRzIHx8IHBhdGgucmVzb2x2ZSgncHVibGljJyksXG4gICAgZmlsZXM6IGNsaS5maWxlcyAmJiBjbGkuZmlsZXMubGVuZ3RoID8gY2xpLmZpbGVzIDogY29uZmlnLmZpbGVzID8gKFtdIGFzIHN0cmluZ1tdKS5jb25jYXQoY29uZmlnLmZpbGVzKSA6IFtdLFxuICB9XG5cbiAgLy8gc2V0IGluc3RhbmNlXG4gIGNvbnN0IGN1cnJlbnQgPSBzZXRDdXJyZW50Q29uZmlnKHtcbiAgICAuLi5nZXRDdXJyZW50Q29uZmlnKCksXG4gICAgLi4ubWVyZ2VkLCAvLyBvdmVyd3JpdGVzIGV2ZXJ5IHRpbWVcbiAgICBlbnYsXG4gICAgZGVidWc6IGNsaS5kZWJ1ZyB8fCBnZXRDdXJyZW50Q29uZmlnKCkuZGVidWcsXG4gICAgY3dkOiBwcm9jZXNzLmN3ZCgpLFxuICAgIGNvbmZpZ0ZpbGVwYXRoOiBwYXRoLnJlc29sdmUoY2xpLmNvbmZpZyB8fCBkZWZhdWx0Q29uZmlnRmlsZXBhdGgpLFxuICAgIGZ1bmN0aW9uc091dHB1dERpcjogcGF0aC5qb2luKG1lcmdlZC5vdXRwdXQsICdmdW5jdGlvbnMnKSxcbiAgICBzdGF0aWNPdXRwdXREaXI6IHBhdGguam9pbihtZXJnZWQub3V0cHV0LCAnc3RhdGljJyksXG4gICAgcm91dGVzTWFuaWZlc3Q6IHBhdGguam9pbihtZXJnZWQub3V0cHV0LCAncm91dGVzLmpzb24nKSxcbiAgICBldmVudHM6IGNyZWF0ZUVtaXR0ZXIoKSxcbiAgfSlcblxuICBpZiAoY29uZmlnLnBsdWdpbnMpIHtcbiAgICBjb25maWcucGx1Z2lucy5tYXAoKHApID0+IHtcbiAgICAgIHRyeSB7XG4gICAgICAgIHAoKVxuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBsb2dnZXIuZXJyb3Ioe1xuICAgICAgICAgIGxhYmVsOiAnZXJyb3InLFxuICAgICAgICAgIGVycm9yOiBlLFxuICAgICAgICB9KVxuICAgICAgfVxuICAgIH0pXG4gIH1cblxuICBsb2dnZXIuZGVidWcoe1xuICAgIGxhYmVsOiAnZGVidWcnLFxuICAgIG1lc3NhZ2U6IGBjb25maWcgY3JlYXRlZCAke0pTT04uc3RyaW5naWZ5KGN1cnJlbnQpfWAsXG4gIH0pXG5cbiAgcmV0dXJuIGN1cnJlbnRcbn1cbiIsICJ0eXBlIGNhbGxhYmxlID0gKC4uLmFyZ3M6IGFueVtdKSA9PiB2b2lkXG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVFbWl0dGVyKCkge1xuICBsZXQgZXZlbnRzOiB7IFtldmVudDogc3RyaW5nXTogY2FsbGFibGVbXSB9ID0ge31cblxuICBmdW5jdGlvbiBlbWl0KGV2OiBzdHJpbmcsIC4uLmFyZ3M6IGFueVtdKTogdm9pZCB7XG4gICAgZXZlbnRzW2V2XSA/IGV2ZW50c1tldl0ubWFwKChmbjogY2FsbGFibGUpID0+IGZuKC4uLmFyZ3MpKSA6IFtdXG4gIH1cblxuICBmdW5jdGlvbiBvbihldjogc3RyaW5nLCBmbjogKC4uLmFyZ3M6IGFueVtdKSA9PiB2b2lkKSB7XG4gICAgZXZlbnRzW2V2XSA9IGV2ZW50c1tldl0gPyBldmVudHNbZXZdLmNvbmNhdChmbikgOiBbZm5dXG4gICAgcmV0dXJuICgpID0+IGV2ZW50c1tldl0uc3BsaWNlKGV2ZW50c1tldl0uaW5kZXhPZihmbiksIDEpXG4gIH1cblxuICBmdW5jdGlvbiBjbGVhcigpIHtcbiAgICBldmVudHMgPSB7fVxuICB9XG5cbiAgZnVuY3Rpb24gbGlzdGVuZXJzKGV2OiBzdHJpbmcpIHtcbiAgICByZXR1cm4gZXZlbnRzW2V2XSB8fCBbXVxuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBlbWl0LFxuICAgIG9uLFxuICAgIGNsZWFyLFxuICAgIGxpc3RlbmVycyxcbiAgfVxufVxuIiwgImltcG9ydCBmcyBmcm9tICdmcy1leHRyYSdcbi8vIEB0cy1pZ25vcmVcbmltcG9ydCBncmFwaCBmcm9tICd3YXRjaC1kZXBlbmRlbmN5LWdyYXBoJ1xuaW1wb3J0IGNob2tpZGFyIGZyb20gJ2Nob2tpZGFyJ1xuaW1wb3J0IG1hdGNoIGZyb20gJ3BpY29tYXRjaCdcblxuaW1wb3J0IHsgb3V0cHV0TGFtYmRhcyB9IGZyb20gJy4vb3V0cHV0TGFtYmRhcydcbmltcG9ydCAqIGFzIGxvZ2dlciBmcm9tICcuL2xvZydcbmltcG9ydCB7IGdldEZpbGVzLCBpc1N0YXRpYywgaXNEeW5hbWljIH0gZnJvbSAnLi9nZXRGaWxlcydcbmltcG9ydCB7IHJlbmRlclN0YXRpY0VudHJpZXMgfSBmcm9tICcuL3JlbmRlclN0YXRpY0VudHJpZXMnXG5pbXBvcnQgeyB0aW1lciB9IGZyb20gJy4vdGltZXInXG5pbXBvcnQgeyBjcmVhdGVDb25maWcsIHJlbW92ZUNvbmZpZ1ZhbHVlcywgZ2V0Q29uZmlnRmlsZSB9IGZyb20gJy4vY29uZmlnJ1xuaW1wb3J0IHsgYnVpbHRTdGF0aWNGaWxlcyB9IGZyb20gJy4vYnVpbHRTdGF0aWNGaWxlcydcbmltcG9ydCB7IHJlbW92ZUJ1aWx0U3RhdGljRmlsZSB9IGZyb20gJy4vcmVtb3ZlQnVpbHRTdGF0aWNGaWxlJ1xuXG5pbXBvcnQgdHlwZSB7IFByZXN0YSB9IGZyb20gJy4uJ1xuXG4vKlxuICogV3JhcHMgb3V0cHV0TGFtYmRhcyBmb3IgbG9nZ2luZ1xuICovXG5mdW5jdGlvbiB1cGRhdGVMYW1iZGFzKGlucHV0czogc3RyaW5nW10sIGNvbmZpZzogUHJlc3RhKSB7XG4gIGNvbnN0IHRpbWUgPSB0aW1lcigpXG5cbiAgLy8gYWx3YXlzIHdyaXRlIHRoaXMsIGV2ZW4gaWYgaW5wdXRzID0gW11cbiAgb3V0cHV0TGFtYmRhcyhpbnB1dHMsIGNvbmZpZylcblxuICAvLyBpZiB1c2VyIGFjdHVhbGx5IGhhcyByb3V0ZXMgY29uZmlndXJlZCwgZ2l2ZSBmZWVkYmFja1xuICBpZiAoaW5wdXRzLmxlbmd0aCkge1xuICAgIGxvZ2dlci5pbmZvKHtcbiAgICAgIGxhYmVsOiAnYnVpbHQnLFxuICAgICAgbWVzc2FnZTogYGxhbWJkYXNgLFxuICAgICAgZHVyYXRpb246IHRpbWUoKSxcbiAgICB9KVxuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB3YXRjaChjb25maWc6IFByZXN0YSkge1xuICAvKlxuICAgKiBHZXQgZmlsZXMgdGhhdCBtYXRjaCBzdGF0aWMvZHluYW1pYyBwYXR0ZXJzIGF0IHN0YXJ0dXBcbiAgICovXG4gIGxldCBmaWxlcyA9IGdldEZpbGVzKGNvbmZpZylcbiAgbGV0IGhhc0NvbmZpZ0ZpbGUgPSBmcy5leGlzdHNTeW5jKGNvbmZpZy5jb25maWdGaWxlcGF0aClcblxuICBpZiAoIWZpbGVzLmxlbmd0aCkge1xuICAgIGxvZ2dlci53YXJuKHtcbiAgICAgIGxhYmVsOiAncGF0aHMnLFxuICAgICAgbWVzc2FnZTogJ25vIGZpbGVzIGNvbmZpZ3VyZWQnLFxuICAgIH0pXG4gIH1cblxuICAvKlxuICAgKiBDcmVhdGUgaW5pdGlhbCBkeW5hbWljIGVudHJ5IHJlZ2FyZGxlc3Mgb2YgaWYgdGhlIHVzZXIgaGFzIHJvdXRlcywgYmMgd2VcbiAgICogbmVlZCB0aGlzIGZpbGUgdG8gc2VydmUgNDA0IGxvY2FsbHlcbiAgICovXG4gIHVwZGF0ZUxhbWJkYXMoZmlsZXMuZmlsdGVyKGlzRHluYW1pYyksIGNvbmZpZylcblxuICAvKlxuICAgKiBTZXQgdXAgYWxsIHdhdGNoZXJzXG4gICAqL1xuICBjb25zdCBmaWxlV2F0Y2hlciA9IGdyYXBoKHsgYWxpYXM6IHsgJ0AnOiBjb25maWcuY3dkIH0gfSlcbiAgY29uc3QgZ2xvYmFsV2F0Y2hlciA9IGNob2tpZGFyLndhdGNoKGNvbmZpZy5jd2QsIHtcbiAgICBpZ25vcmVJbml0aWFsOiB0cnVlLFxuICAgIGlnbm9yZWQ6IFtjb25maWcub3V0cHV0LCBjb25maWcuYXNzZXRzXSxcbiAgfSlcblxuICAvKlxuICAgKiBPbiBhIGNvbmZpZyB1cGRhdGUsIHRoZSB1c2VyIG1heSBoYXZlIHBhc3NlZCBpbiBhIG5ldyBgZmlsZXNgIGFycmF5IG9yXG4gICAqIG90aGVyIGdsb2JhbCBjb25maWcgcmVxdWlyZWQgYnkgYWxsIGZpbGVzLCBzbyB3ZSBuZWVkIHRvIHJlLWZldGNoIGFsbFxuICAgKiBmaWxlcyBhbmQgcmVidWlsZCBldmVyeXRoaW5nLlxuICAgKi9cbiAgYXN5bmMgZnVuY3Rpb24gaGFuZGxlQ29uZmlnVXBkYXRlKCkge1xuICAgIGZpbGVzID0gZ2V0RmlsZXMoY29uZmlnKVxuICAgIGF3YWl0IHJlbmRlclN0YXRpY0VudHJpZXMoZmlsZXMuZmlsdGVyKGlzU3RhdGljKSwgY29uZmlnKVxuICAgIHVwZGF0ZUxhbWJkYXMoZmlsZXMuZmlsdGVyKGlzRHluYW1pYyksIGNvbmZpZylcbiAgfVxuXG4gIC8qXG4gICAqIE9uIGEgY2hhbmdlZCBmaWxlLCB3ZSBjYW4ganVzdCByZW5kZXIgaXRcbiAgICovXG4gIGFzeW5jIGZ1bmN0aW9uIGhhbmRsZUZpbGVDaGFuZ2UoZmlsZTogc3RyaW5nKSB7XG4gICAgLy8gcmVuZGVyIGp1c3QgZmlsZSB0aGF0IGNoYW5nZWRcbiAgICBpZiAoaXNTdGF0aWMoZmlsZSkpIHtcbiAgICAgIGF3YWl0IHJlbmRlclN0YXRpY0VudHJpZXMoW2ZpbGVdLCBjb25maWcpXG4gICAgfVxuXG4gICAgLy8gdXBkYXRlIGR5bmFtaWMgZW50cnkgd2l0aCBBTEwgZHluYW1pYyBmaWxlc1xuICAgIGlmIChpc0R5bmFtaWMoZmlsZSkpIHtcbiAgICAgIHVwZGF0ZUxhbWJkYXMoZmlsZXMuZmlsdGVyKGlzRHluYW1pYyksIGNvbmZpZylcbiAgICB9XG5cbiAgICBjb25maWcuZXZlbnRzLmVtaXQoJ3JlZnJlc2gnKVxuICAgIGNvbmZpZy5ldmVudHMuZW1pdCgnZG9uZScsIFtmaWxlXSlcbiAgfVxuXG4gIGZpbGVXYXRjaGVyLm9uKCdyZW1vdmUnLCAoW2lkXTogc3RyaW5nW10pID0+IHtcbiAgICBsb2dnZXIuZGVidWcoe1xuICAgICAgbGFiZWw6ICd3YXRjaCcsXG4gICAgICBtZXNzYWdlOiBgZmlsZVdhdGNoZXIgLSByZW1vdmVkICR7aWR9YCxcbiAgICB9KVxuXG4gICAgLy8gcmVtb3ZlIGZyb20gbG9jYWwgaGFzaFxuICAgIGZpbGVzLnNwbGljZShmaWxlcy5pbmRleE9mKGlkKSwgMSlcblxuICAgIC8vIHVwZGF0ZSB0aGlzIHJlZ2FyZGxlc3MsIG5vdCBzdXJlIGlmIFtpZF0gd2FzIGR5bmFtaWMgb3Igc3RhdGljXG4gICAgdXBkYXRlTGFtYmRhcyhmaWxlcy5maWx0ZXIoaXNEeW5hbWljKSwgY29uZmlnKVxuXG4gICAgLy8gaWYgaXQgd2FzIGNvbmZpZywgd2UgZ290dGEgZG8gYSByZXN0YXJ0XG4gICAgaWYgKGlkID09PSBjb25maWcuY29uZmlnRmlsZXBhdGgpIHtcbiAgICAgIC8vIGZpbHRlciBvdXQgdmFsdWVzIGZyb20gdGhlIGNvbmZpZyBmaWxlXG4gICAgICBjb25maWcgPSByZW1vdmVDb25maWdWYWx1ZXMoKVxuXG4gICAgICAvLyByZXNldCB0aGlzIVxuICAgICAgaGFzQ29uZmlnRmlsZSA9IGZhbHNlXG5cbiAgICAgIGhhbmRsZUNvbmZpZ1VwZGF0ZSgpXG4gICAgfVxuXG4gICAgOyhidWlsdFN0YXRpY0ZpbGVzW2lkXSB8fCBbXSkuZm9yRWFjaCgoZmlsZSkgPT4gcmVtb3ZlQnVpbHRTdGF0aWNGaWxlKGZpbGUsIGNvbmZpZykpXG5cbiAgICBjb25maWcuZXZlbnRzLmVtaXQoJ3JlbW92ZScsIGlkKVxuICB9KVxuXG4gIGZpbGVXYXRjaGVyLm9uKCdjaGFuZ2UnLCAoW2lkXTogc3RyaW5nW10pID0+IHtcbiAgICBsb2dnZXIuZGVidWcoe1xuICAgICAgbGFiZWw6ICd3YXRjaCcsXG4gICAgICBtZXNzYWdlOiBgZmlsZVdhdGNoZXIgLSBjaGFuZ2VkICR7aWR9YCxcbiAgICB9KVxuXG4gICAgaWYgKGlkID09PSBjb25maWcuY29uZmlnRmlsZXBhdGgpIHtcbiAgICAgIC8vIGNsZWFyIGNvbmZpZyBmaWxlIGZvciByZS1yZXF1aXJlXG4gICAgICBkZWxldGUgcmVxdWlyZS5jYWNoZVtjb25maWcuY29uZmlnRmlsZXBhdGhdXG5cbiAgICAgIHRyeSB7XG4gICAgICAgIC8vIG1lcmdlIGluIG5ldyB2YWx1ZXMgZnJvbSBjb25maWcgZmlsZVxuICAgICAgICBjb25maWcgPSBjcmVhdGVDb25maWcoe1xuICAgICAgICAgIGNvbmZpZzogZ2V0Q29uZmlnRmlsZShjb25maWcuY29uZmlnRmlsZXBhdGgpLFxuICAgICAgICB9KVxuXG4gICAgICAgIGhhbmRsZUNvbmZpZ1VwZGF0ZSgpXG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGxvZ2dlci5lcnJvcih7XG4gICAgICAgICAgbGFiZWw6ICdlcnJvcicsXG4gICAgICAgICAgZXJyb3I6IGUsXG4gICAgICAgIH0pXG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGhhbmRsZUZpbGVDaGFuZ2UoaWQpXG4gICAgfVxuXG4gICAgY29uZmlnLmV2ZW50cy5lbWl0KCdjaGFuZ2UnLCBpZClcbiAgfSlcblxuICBmaWxlV2F0Y2hlci5vbignZXJyb3InLCAoZTogRXJyb3IpID0+IHtcbiAgICBsb2dnZXIuZXJyb3Ioe1xuICAgICAgbGFiZWw6ICdlcnJvcicsXG4gICAgICBlcnJvcjogZSxcbiAgICB9KVxuICB9KVxuXG4gIC8qXG4gICAqIGdsb2JhbFdhdGNoZXIgd2F0Y2hlcyB0aGUgcmF3IGZpbGUgZ2xvYnMgcGFzc2VkIHRvIHRoZSBDTEkgb3IgYXMgYGZpbGVzYFxuICAgKiBpbiB0aGUgY29uZmlnLiBJZiBjaGVja3Mgb24gYWRkL2NoYW5nZSB0byBzZWUgaWYgYSBmaWxlIHNob3VsZCBiZSB1cGdyYWRlZFxuICAgKiB0byBhIGEgUHJlc3RhIHNvdXJjZSBmaWxlLCBhbmQgYWRkZWQgdG8gdGhlIGZpbGVXYXRjaGVyLiBJdCBhbHNvIHdhdGNoZXNcbiAgICogZm9yIGFkZGl0aW9uIG9mIGEgY29uZmlnIGZpbGUuXG4gICAqL1xuICBnbG9iYWxXYXRjaGVyLm9uKCdhbGwnLCBhc3luYyAoZXZlbnQsIGZpbGUpID0+IHtcbiAgICAvLyBpZ25vcmUgZXZlbnRzIGhhbmRsZWQgYnkgd2RnLCBvciBhbnkgZGlyZWN0b3J5IGV2ZW50c1xuICAgIGlmICghL2FkZHxjaGFuZ2UvLnRlc3QoZXZlbnQpIHx8ICFmcy5leGlzdHNTeW5jKGZpbGUpIHx8IGZzLmxzdGF0U3luYyhmaWxlKS5pc0RpcmVjdG9yeSgpKSByZXR1cm5cblxuICAgIC8vIGlmIGEgZmlsZSBjaGFuZ2UgbWF0Y2hlcyBhbnkgcGFnZXMgZ2xvYnNcbiAgICBpZiAobWF0Y2goY29uZmlnLmZpbGVzKShmaWxlKSAmJiAhZmlsZXMuaW5jbHVkZXMoZmlsZSkpIHtcbiAgICAgIGxvZ2dlci5kZWJ1Zyh7XG4gICAgICAgIGxhYmVsOiAnd2F0Y2gnLFxuICAgICAgICBtZXNzYWdlOiBgZ2xvYmFsV2F0Y2hlciAtIGFkZCAke2ZpbGV9YCxcbiAgICAgIH0pXG5cbiAgICAgIGZpbGVzLnB1c2goZmlsZSlcblxuICAgICAgZmlsZVdhdGNoZXIuYWRkKGZpbGUpXG5cbiAgICAgIGhhbmRsZUZpbGVDaGFuZ2UoZmlsZSlcbiAgICB9XG5cbiAgICAvLyBpZiBmaWxlIG1hdGNoZXMgY29uZmlnIGZpbGUgYW5kIHdlIGRvbid0IGFscmVhZHkgaGF2ZSBvbmVcbiAgICBpZiAoZmlsZSA9PT0gY29uZmlnLmNvbmZpZ0ZpbGVwYXRoICYmICFoYXNDb25maWdGaWxlKSB7XG4gICAgICBsb2dnZXIuZGVidWcoe1xuICAgICAgICBsYWJlbDogJ3dhdGNoJyxcbiAgICAgICAgbWVzc2FnZTogYGdsb2JhbFdhdGNoZXIgLSBhZGQgY29uZmlnIGZpbGUgJHtmaWxlfWAsXG4gICAgICB9KVxuXG4gICAgICBmaWxlV2F0Y2hlci5hZGQoY29uZmlnLmNvbmZpZ0ZpbGVwYXRoKVxuXG4gICAgICB0cnkge1xuICAgICAgICAvLyBtZXJnZSBpbiBuZXcgdmFsdWVzIGZyb20gY29uZmlnIGZpbGVcbiAgICAgICAgY29uZmlnID0gY3JlYXRlQ29uZmlnKHtcbiAgICAgICAgICBjb25maWc6IGdldENvbmZpZ0ZpbGUoY29uZmlnLmNvbmZpZ0ZpbGVwYXRoKSxcbiAgICAgICAgfSlcblxuICAgICAgICBoYXNDb25maWdGaWxlID0gdHJ1ZVxuXG4gICAgICAgIGhhbmRsZUNvbmZpZ1VwZGF0ZSgpXG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGxvZ2dlci5lcnJvcih7XG4gICAgICAgICAgbGFiZWw6ICdlcnJvcicsXG4gICAgICAgICAgZXJyb3I6IGUsXG4gICAgICAgIH0pXG4gICAgICB9XG4gICAgfVxuXG4gICAgY29uZmlnLmV2ZW50cy5lbWl0KCdhZGQnLCBmaWxlKVxuICB9KVxuXG4gIC8qKlxuICAgKiBJbml0IHdhdGNoaW5nIGFmdGVyIGV2ZW50IHN1YnNjcmlwdGlvbnNcbiAgICovXG4gIGZpbGVXYXRjaGVyLmFkZChmaWxlcylcbiAgaWYgKGhhc0NvbmZpZ0ZpbGUpIGZpbGVXYXRjaGVyLmFkZChjb25maWcuY29uZmlnRmlsZXBhdGgpXG5cbiAgLyoqXG4gICAqIFByaW1lIGZpbGVzIHRvIGNoZWNrIGZvciBlcnJvcnMgb24gc3RhcnR1cCBhbmQgcmVnaXN0ZXIgYW55IHBsdWdpbnNcbiAgICovXG4gIHRyeSB7XG4gICAgZmlsZXMubWFwKHJlcXVpcmUpXG4gIH0gY2F0Y2ggKGUpIHtcbiAgICBsb2dnZXIuZXJyb3Ioe1xuICAgICAgbGFiZWw6ICdlcnJvcicsXG4gICAgICBlcnJvcjogZSxcbiAgICB9KVxuICB9XG59XG4iLCAiaW1wb3J0IGZzIGZyb20gJ2ZzLWV4dHJhJ1xuaW1wb3J0IHBhdGggZnJvbSAncGF0aCdcbmltcG9ydCByc29ydCBmcm9tICdyb3V0ZS1zb3J0J1xuXG5pbXBvcnQgeyBFbnYgfSBmcm9tICcuL2NvbmZpZydcbmltcG9ydCB7IGhhc2hDb250ZW50IH0gZnJvbSAnLi9oYXNoQ29udGVudCdcbmltcG9ydCAqIGFzIGxvZ2dlciBmcm9tICcuL2xvZydcblxuaW1wb3J0IHR5cGUgeyBQcmVzdGEgfSBmcm9tICcuLidcblxuZXhwb3J0IGZ1bmN0aW9uIG91dHB1dExhbWJkYShpbnB1dDogc3RyaW5nLCBjb25maWc6IFByZXN0YSk6IFtzdHJpbmcsIHN0cmluZ10ge1xuICBjb25zdCB7IHJvdXRlIH0gPSByZXF1aXJlKGlucHV0KVxuICBjb25zdCBuYW1lID0gcGF0aC5iYXNlbmFtZShpbnB1dCkuc3BsaXQoJy4nKS5yZXZlcnNlKCkuc2xpY2UoMSkucmV2ZXJzZSgpLmpvaW4oJy4nKVxuICBjb25zdCBvdXRwdXQgPSBwYXRoLmpvaW4oXG4gICAgY29uZmlnLmZ1bmN0aW9uc091dHB1dERpcixcbiAgICBjb25maWcuZW52ID09PSBFbnYuUFJPRFVDVElPTiA/IG5hbWUgKyAnLScgKyBoYXNoQ29udGVudChmcy5yZWFkRmlsZVN5bmMoaW5wdXQsICd1dGY4JykpICsgJy5qcycgOiBuYW1lICsgJy5qcydcbiAgKVxuXG4gIGxvZ2dlci5kZWJ1Zyh7XG4gICAgbGFiZWw6ICdkZWJ1ZycsXG4gICAgbWVzc2FnZTogYGdlbmVyYXRpbmcgJHtuYW1lfSBsYW1iZGFgLFxuICB9KVxuXG4gIC8vIGltcG9ydGFudCBmb3Igd2F0Y2ggdGFza1xuICBkZWxldGUgcmVxdWlyZS5jYWNoZVtpbnB1dF1cbiAgZGVsZXRlIHJlcXVpcmUuY2FjaGVbb3V0cHV0XVxuXG4gIGZzLm91dHB1dEZpbGVTeW5jKFxuICAgIG91dHB1dCxcbiAgICBgaW1wb3J0IHsgd3JhcEhhbmRsZXIgfSBmcm9tICdwcmVzdGEnO1xuaW1wb3J0ICogYXMgZmlsZSBmcm9tICcke2lucHV0fSc7XG5leHBvcnQgY29uc3Qgcm91dGUgPSBmaWxlLnJvdXRlXG5leHBvcnQgY29uc3QgaGFuZGxlciA9IHdyYXBIYW5kbGVyKGZpbGUpYFxuICApXG5cbiAgcmV0dXJuIFtyb3V0ZSwgb3V0cHV0XVxufVxuXG5leHBvcnQgZnVuY3Rpb24gb3V0cHV0TGFtYmRhcyhpbnB1dHM6IHN0cmluZ1tdLCBjb25maWc6IFByZXN0YSkge1xuICBjb25zdCBsYW1iZGFzID0gaW5wdXRzXG4gICAgLm1hcCgoaW5wdXQpID0+IHtcbiAgICAgIHRyeSB7XG4gICAgICAgIHJldHVybiBvdXRwdXRMYW1iZGEoaW5wdXQsIGNvbmZpZylcbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgbG9nZ2VyLmVycm9yKHtcbiAgICAgICAgICBsYWJlbDogJ2Vycm9yJyxcbiAgICAgICAgICBlcnJvcjogZSxcbiAgICAgICAgfSlcbiAgICAgICAgcmV0dXJuIG51bGxcbiAgICAgIH1cbiAgICB9KVxuICAgIC5maWx0ZXIoQm9vbGVhbikgYXMgW3N0cmluZywgc3RyaW5nXVtdXG5cbiAgY29uc3Qgc29ydGVkID0gcnNvcnQobGFtYmRhcy5tYXAoKGwpID0+IGxbMF0pKVxuICBjb25zdCBtYW5pZmVzdDogeyBbcm91dGU6IHN0cmluZ106IHN0cmluZyB9ID0ge31cblxuICBmb3IgKGNvbnN0IHJvdXRlIG9mIHNvcnRlZCkge1xuICAgIGNvbnN0IG1hdGNoID0gbGFtYmRhcy5maW5kKChsKSA9PiBsWzBdID09PSByb3V0ZSlcblxuICAgIGlmIChtYXRjaCkge1xuICAgICAgbWFuaWZlc3Rbcm91dGVdID0gbWF0Y2hbMV1cbiAgICB9XG4gIH1cblxuICBmcy5vdXRwdXRGaWxlU3luYyhjb25maWcucm91dGVzTWFuaWZlc3QsIEpTT04uc3RyaW5naWZ5KG1hbmlmZXN0KSlcblxuICByZXR1cm4gbGFtYmRhc1xufVxuIiwgImV4cG9ydCBmdW5jdGlvbiBoYXNoQ29udGVudChjb250ZW50OiBzdHJpbmcpIHtcbiAgdmFyIGggPSA1MzgxLFxuICAgIGkgPSBjb250ZW50Lmxlbmd0aFxuXG4gIHdoaWxlIChpKSBoID0gKGggKiAzMykgXiBjb250ZW50LmNoYXJDb2RlQXQoLS1pKVxuXG4gIHJldHVybiAoaCA+Pj4gMCkudG9TdHJpbmcoMzYpXG59XG4iLCAiaW1wb3J0IGZzIGZyb20gJ2ZzLWV4dHJhJ1xuaW1wb3J0IHBhdGggZnJvbSAncGF0aCdcbmltcG9ydCBnbG9iU3luYyBmcm9tICd0aW55LWdsb2Ivc3luYydcblxuaW1wb3J0IHsgUHJlc3RhIH0gZnJvbSAnLi4nXG5cbmV4cG9ydCBmdW5jdGlvbiBpc0R5bmFtaWMoZmlsZTogc3RyaW5nKSB7XG4gIHJldHVybiAvZXhwb3J0XFxzLitcXHNyb3V0ZVxccytcXD0vLnRlc3QoZnMucmVhZEZpbGVTeW5jKGZpbGUsICd1dGYtOCcpKVxufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNTdGF0aWMoZmlsZTogc3RyaW5nKSB7XG4gIHJldHVybiAvZXhwb3J0XFxzLitcXHNnZXRTdGF0aWNQYXRocy8udGVzdChmcy5yZWFkRmlsZVN5bmMoZmlsZSwgJ3V0Zi04JykpXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc1ByZXN0YUZpbGUoZmlsZTogc3RyaW5nKSB7XG4gIHJldHVybiBpc1N0YXRpYyhmaWxlKSB8fCBpc0R5bmFtaWMoZmlsZSlcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldEZpbGVzKGNvbmZpZzogUHJlc3RhKTogc3RyaW5nW10ge1xuICByZXR1cm4gKFtdIGFzIHN0cmluZ1tdKVxuICAgIC5jb25jYXQoY29uZmlnLmZpbGVzKVxuICAgIC5tYXAoKGZpbGUpID0+IGdsb2JTeW5jKGZpbGUsIHsgY3dkOiBjb25maWcuY3dkIH0pKVxuICAgIC5mbGF0KClcbiAgICAubWFwKChmaWxlKSA9PiBwYXRoLnJlc29sdmUoY29uZmlnLmN3ZCwgZmlsZSkpIC8vIG1ha2UgYWJzb2x1dGVcbn1cbiIsICJpbXBvcnQgZnMgZnJvbSAnZnMtZXh0cmEnXG5pbXBvcnQgcGF0aCBmcm9tICdwYXRoJ1xuaW1wb3J0IG1pbWUgZnJvbSAnbWltZS10eXBlcydcblxuaW1wb3J0ICogYXMgbG9nZ2VyIGZyb20gJy4vbG9nJ1xuaW1wb3J0IHsgdGltZXIgfSBmcm9tICcuL3RpbWVyJ1xuaW1wb3J0IHsgZ2V0Um91dGVQYXJhbXMgfSBmcm9tICcuL2dldFJvdXRlUGFyYW1zJ1xuaW1wb3J0IHsgbm9ybWFsaXplUmVzcG9uc2UgfSBmcm9tICcuL25vcm1hbGl6ZVJlc3BvbnNlJ1xuaW1wb3J0IHsgYnVpbHRTdGF0aWNGaWxlcyB9IGZyb20gJy4vYnVpbHRTdGF0aWNGaWxlcydcbmltcG9ydCB7IHJlbW92ZUJ1aWx0U3RhdGljRmlsZSB9IGZyb20gJy4vcmVtb3ZlQnVpbHRTdGF0aWNGaWxlJ1xuXG5pbXBvcnQgdHlwZSB7IFByZXN0YSB9IGZyb20gJy4uJ1xuXG5leHBvcnQgZnVuY3Rpb24gcGF0aG5hbWVUb0ZpbGUocGF0aG5hbWU6IHN0cmluZywgZXh0ID0gJ2h0bWwnKSB7XG4gIHJldHVybiAhIXBhdGguZXh0bmFtZShwYXRobmFtZSlcbiAgICA/IHBhdGhuYW1lIC8vIGlmIHBhdGggaGFzIGV4dGVuc2lvbiwgdXNlIGl0XG4gICAgOiBleHQgPT09ICdodG1sJ1xuICAgID8gYCR7cGF0aG5hbWV9L2luZGV4Lmh0bWxgIC8vIGlmIEhUTUwgaXMgaW5mZXJyZWQsIGNyZWF0ZSBpbmRleFxuICAgIDogYCR7cGF0aG5hbWV9LiR7ZXh0fWAgLy8gYW55dGhpbmcgYnV0IEhUTUwgd2lsbCBuZWVkIGFuIGV4dGVuc2lvbiwgb3RoZXJ3aXNlIGJyb3dzZXJzIHdpbGwgcmVuZGVyIGFzIHRleHRcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHJlbmRlclN0YXRpY0VudHJpZXMoZW50cmllczogc3RyaW5nW10sIGNvbmZpZzogUHJlc3RhKTogUHJvbWlzZTx7IGFsbEdlbmVyYXRlZEZpbGVzOiBzdHJpbmdbXSB9PiB7XG4gIHJldHVybiBuZXcgUHJvbWlzZShhc3luYyAoeSwgbikgPT4ge1xuICAgIGxvZ2dlci5kZWJ1Zyh7XG4gICAgICBsYWJlbDogJ2RlYnVnJyxcbiAgICAgIG1lc3NhZ2U6IGByZW5kZXJpbmcgJHtKU09OLnN0cmluZ2lmeShlbnRyaWVzKX1gLFxuICAgIH0pXG5cbiAgICBjb25zdCBhbGxHZW5lcmF0ZWRGaWxlczogc3RyaW5nW10gPSBbXVxuXG4gICAgZm9yIChjb25zdCBlbnRyeSBvZiBlbnRyaWVzKSB7XG4gICAgICBjb25zdCBsb2NhdGlvbiA9IGVudHJ5LnJlcGxhY2UoY29uZmlnLmN3ZCwgJycpXG5cbiAgICAgIHRyeSB7XG4gICAgICAgIGRlbGV0ZSByZXF1aXJlLmNhY2hlW2VudHJ5XVxuXG4gICAgICAgIGNvbnN0IGZpbGUgPSByZXF1aXJlKGVudHJ5KVxuICAgICAgICBjb25zdCBwYXRocyA9IGF3YWl0IGZpbGUuZ2V0U3RhdGljUGF0aHMoKVxuXG4gICAgICAgIGNvbnN0IHByZXZGaWxlcyA9IChidWlsdFN0YXRpY0ZpbGVzW2VudHJ5XSA9IGJ1aWx0U3RhdGljRmlsZXNbZW50cnldIHx8IFtdKVxuICAgICAgICBjb25zdCBuZXh0RmlsZXM6IHN0cmluZ1tdID0gW11cblxuICAgICAgICBpZiAoIXBhdGhzIHx8ICFwYXRocy5sZW5ndGgpIHtcbiAgICAgICAgICBsb2dnZXIud2Fybih7XG4gICAgICAgICAgICBsYWJlbDogJ3BhdGhzJyxcbiAgICAgICAgICAgIG1lc3NhZ2U6IGAke2xvY2F0aW9ufSAtIG5vIHBhdGhzIHRvIHJlbmRlcmAsXG4gICAgICAgICAgfSlcblxuICAgICAgICAgIHByZXZGaWxlcy5mb3JFYWNoKChmaWxlKSA9PiByZW1vdmVCdWlsdFN0YXRpY0ZpbGUoZmlsZSwgY29uZmlnKSlcblxuICAgICAgICAgIGNvbnRpbnVlXG4gICAgICAgIH1cblxuICAgICAgICBmb3IgKGNvbnN0IHVybCBvZiBwYXRocykge1xuICAgICAgICAgIGNvbnN0IHRpbWUgPSB0aW1lcigpXG4gICAgICAgICAgY29uc3QgZXZlbnQgPSB7XG4gICAgICAgICAgICBwYXRoOiB1cmwsXG4gICAgICAgICAgICBwYXJhbXM6IGZpbGUucm91dGUgPyBnZXRSb3V0ZVBhcmFtcyh1cmwsIGZpbGUucm91dGUpIDoge30sXG4gICAgICAgICAgfVxuXG4gICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBub3JtYWxpemVSZXNwb25zZShhd2FpdCBmaWxlLmhhbmRsZXIoZXZlbnQsIHt9KSlcbiAgICAgICAgICBjb25zdCB0eXBlID0gcmVzcG9uc2UuaGVhZGVycyA/IHJlc3BvbnNlLmhlYWRlcnNbJ0NvbnRlbnQtVHlwZSddIDogJydcbiAgICAgICAgICBjb25zdCBleHQgPSB0eXBlID8gbWltZS5leHRlbnNpb24odHlwZSBhcyBzdHJpbmcpIHx8ICdodG1sJyA6ICdodG1sJ1xuICAgICAgICAgIGNvbnN0IGZpbGVuYW1lID0gcGF0aG5hbWVUb0ZpbGUodXJsLCBleHQpXG5cbiAgICAgICAgICBhbGxHZW5lcmF0ZWRGaWxlcy5wdXNoKGZpbGVuYW1lKVxuICAgICAgICAgIG5leHRGaWxlcy5wdXNoKGZpbGVuYW1lKVxuXG4gICAgICAgICAgZnMub3V0cHV0RmlsZVN5bmMocGF0aC5qb2luKGNvbmZpZy5zdGF0aWNPdXRwdXREaXIsIGZpbGVuYW1lKSwgcmVzcG9uc2UuYm9keSwgJ3V0Zi04JylcblxuICAgICAgICAgIGxvZ2dlci5pbmZvKHtcbiAgICAgICAgICAgIGxhYmVsOiAnYnVpbHQnLFxuICAgICAgICAgICAgbWVzc2FnZTogdXJsLFxuICAgICAgICAgICAgZHVyYXRpb246IHRpbWUoKSxcbiAgICAgICAgICB9KVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gZGlmZiBhbmQgcmVtb3ZlIGZpbGVzXG4gICAgICAgIGZvciAoY29uc3QgZmlsZSBvZiBwcmV2RmlsZXMpIHtcbiAgICAgICAgICBpZiAoIW5leHRGaWxlcy5pbmNsdWRlcyhmaWxlKSkge1xuICAgICAgICAgICAgcmVtb3ZlQnVpbHRTdGF0aWNGaWxlKGZpbGUsIGNvbmZpZylcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBidWlsdFN0YXRpY0ZpbGVzW2VudHJ5XSA9IG5leHRGaWxlc1xuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBpZiAoY29uZmlnLmVudiA9PT0gJ2RldmVsb3BtZW50Jykge1xuICAgICAgICAgIGxvZ2dlci5lcnJvcih7XG4gICAgICAgICAgICBsYWJlbDogJ2Vycm9yJyxcbiAgICAgICAgICAgIG1lc3NhZ2U6ICdlcnJvcnMgZGV0ZWN0ZWQsIHBhdXNpbmcuLi4nLFxuICAgICAgICAgICAgZXJyb3I6IGUsXG4gICAgICAgICAgfSlcblxuICAgICAgICAgIHkoeyBhbGxHZW5lcmF0ZWRGaWxlcyB9KVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGxvZ2dlci5lcnJvcih7XG4gICAgICAgICAgICBsYWJlbDogJ2Vycm9yJyxcbiAgICAgICAgICAgIGVycm9yOiBlLFxuICAgICAgICAgIH0pXG5cbiAgICAgICAgICBuKGUpXG4gICAgICAgIH1cblxuICAgICAgICAvLyBleGl0IGxvb3Agb24gYW55IGVycm9yXG4gICAgICAgIGJyZWFrXG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gY2xlYXIgdG8gcHJldmVudCBtZW1vcnkgbGVha1xuICAgIC8vIGxvYWRDYWNoZS5jbGVhckFsbE1lbW9yeSgpIC8vIFRPRE8gcHJvYnMgY2FuJ3QgXHUyMDE0IGVtaXQ/XG5cbiAgICB5KHsgYWxsR2VuZXJhdGVkRmlsZXMgfSlcbiAgfSlcbn1cbiIsICJleHBvcnQgZnVuY3Rpb24gdGltZXIoKSB7XG4gIGNvbnN0IHN0YXJ0ID0gcHJvY2Vzcy5ocnRpbWUoKVxuICByZXR1cm4gKCkgPT4ge1xuICAgIGNvbnN0IFtzLCBuYW5vc10gPSBwcm9jZXNzLmhydGltZShzdGFydClcbiAgICBjb25zdCBtcyA9IG5hbm9zIC8gMTAwMDAwMFxuXG4gICAgaWYgKHMgPCAxKSB7XG4gICAgICByZXR1cm4gKG1zID49IDEgPyBtcy50b0ZpeGVkKDApIDogbXMudG9GaXhlZCgyKSkgKyAnbXMnXG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBzICsgJy4nICsgbXMudG9GaXhlZCgwKSArICdzJ1xuICAgIH1cbiAgfVxufVxuIiwgImltcG9ydCB0b1JlZ0V4cCBmcm9tICdyZWdleHBhcmFtJ1xuXG5pbXBvcnQgeyBSb3V0ZVBhcmFtcyB9IGZyb20gJy4uJ1xuXG4vLyBAc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9sdWtlZWQvcmVnZXhwYXJhbSN1c2FnZVxuZXhwb3J0IGZ1bmN0aW9uIGdldFJvdXRlUGFyYW1zKHVybDogc3RyaW5nLCByb3V0ZTogc3RyaW5nKTogUm91dGVQYXJhbXMge1xuICBjb25zdCByZXN1bHQgPSB0b1JlZ0V4cChyb3V0ZSlcbiAgbGV0IGkgPSAwXG4gIGxldCBvdXQ6IFJvdXRlUGFyYW1zID0ge31cbiAgbGV0IG1hdGNoZXMgPSByZXN1bHQucGF0dGVybi5leGVjKHVybCkgfHwgW11cblxuICB3aGlsZSAoaSA8IHJlc3VsdC5rZXlzLmxlbmd0aCkge1xuICAgIG91dFtyZXN1bHQua2V5c1tpXV0gPSBtYXRjaGVzWysraV1cbiAgfVxuXG4gIHJldHVybiBvdXRcbn1cbiIsICJpbXBvcnQgeyBBV1MsIFJlc3BvbnNlIH0gZnJvbSAnLi4nXG5cbmZ1bmN0aW9uIHN0cmluZ2lmeShvYmo6IG9iamVjdCB8IHN0cmluZykge1xuICByZXR1cm4gdHlwZW9mIG9iaiA9PT0gJ29iamVjdCcgPyBKU09OLnN0cmluZ2lmeShvYmopIDogb2JqXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBub3JtYWxpemVSZXNwb25zZShyZXNwb25zZTogUGFydGlhbDxSZXNwb25zZT4gfCBzdHJpbmcpOiBBV1NbJ0hhbmRsZXJSZXNwb25zZSddIHtcbiAgY29uc3Qge1xuICAgIGlzQmFzZTY0RW5jb2RlZCA9IGZhbHNlLFxuICAgIHN0YXR1c0NvZGUgPSAyMDAsXG4gICAgaGVhZGVycyA9IHt9LFxuICAgIG11bHRpVmFsdWVIZWFkZXJzID0ge30sXG4gICAgYm9keSA9ICcnLFxuICAgIGh0bWwgPSB1bmRlZmluZWQsXG4gICAganNvbiA9IHVuZGVmaW5lZCxcbiAgICB4bWwgPSB1bmRlZmluZWQsXG4gIH0gPSB0eXBlb2YgcmVzcG9uc2UgPT09ICdzdHJpbmcnXG4gICAgPyB7XG4gICAgICAgIGJvZHk6IHJlc3BvbnNlLFxuICAgICAgfVxuICAgIDogcmVzcG9uc2VcblxuICBsZXQgY29udGVudFR5cGUgPSAndGV4dC9odG1sOyBjaGFyc2V0PXV0Zi04J1xuXG4gIGlmICghIWpzb24pIHtcbiAgICBjb250ZW50VHlwZSA9ICdhcHBsaWNhdGlvbi9qc29uOyBjaGFyc2V0PXV0Zi04J1xuICB9IGVsc2UgaWYgKCEheG1sKSB7XG4gICAgY29udGVudFR5cGUgPSAnYXBwbGljYXRpb24veG1sOyBjaGFyc2V0PXV0Zi04J1xuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBpc0Jhc2U2NEVuY29kZWQsXG4gICAgc3RhdHVzQ29kZSxcbiAgICBoZWFkZXJzOiB7XG4gICAgICAnQ29udGVudC1UeXBlJzogY29udGVudFR5cGUsXG4gICAgICAuLi5oZWFkZXJzLFxuICAgIH0sXG4gICAgbXVsdGlWYWx1ZUhlYWRlcnMsXG4gICAgYm9keTogc3RyaW5naWZ5KGJvZHkgfHwgaHRtbCB8fCBqc29uIHx8IHhtbCB8fCAnJyksXG4gIH1cbn1cbiIsICJ0eXBlIEJ1aWx0U3RhdGljRmlsZSA9IHN0cmluZ1xuXG5leHBvcnQgY29uc3QgYnVpbHRTdGF0aWNGaWxlczogeyBbZW50cnlGaWxlOiBzdHJpbmddOiBCdWlsdFN0YXRpY0ZpbGVbXSB9ID0ge31cbiIsICJpbXBvcnQgZnMgZnJvbSAnZnMtZXh0cmEnXG5pbXBvcnQgcGF0aCBmcm9tICdwYXRoJ1xuXG5pbXBvcnQgKiBhcyBsb2dnZXIgZnJvbSAnLi9sb2cnXG5cbmltcG9ydCB0eXBlIHsgUHJlc3RhIH0gZnJvbSAnLi4nXG5cbmV4cG9ydCBmdW5jdGlvbiByZW1vdmVCdWlsdFN0YXRpY0ZpbGUoZmlsZTogc3RyaW5nLCBjb25maWc6IFByZXN0YSkge1xuICBsb2dnZXIuZGVidWcoe1xuICAgIGxhYmVsOiAnZGVidWcnLFxuICAgIG1lc3NhZ2U6IGByZW1vdmluZyBvbGQgc3RhdGljIGZpbGUgJHtmaWxlfWAsXG4gIH0pXG5cbiAgZnMucmVtb3ZlKHBhdGguam9pbihjb25maWcuc3RhdGljT3V0cHV0RGlyLCBmaWxlKSlcbn1cbiIsICJpbXBvcnQgZnMgZnJvbSAnZnMtZXh0cmEnXG5pbXBvcnQgeyBidWlsZCBhcyBlc2J1aWxkIH0gZnJvbSAnZXNidWlsZCdcblxuaW1wb3J0IHsgb3V0cHV0TGFtYmRhcyB9IGZyb20gJy4vb3V0cHV0TGFtYmRhcydcbmltcG9ydCB7IGdldEZpbGVzLCBpc1N0YXRpYywgaXNEeW5hbWljIH0gZnJvbSAnLi9nZXRGaWxlcydcbmltcG9ydCB7IHJlbmRlclN0YXRpY0VudHJpZXMgfSBmcm9tICcuL3JlbmRlclN0YXRpY0VudHJpZXMnXG5pbXBvcnQgeyB0aW1lciB9IGZyb20gJy4vdGltZXInXG5pbXBvcnQgKiBhcyBsb2dnZXIgZnJvbSAnLi9sb2cnXG5cbmltcG9ydCB0eXBlIHsgUHJlc3RhIH0gZnJvbSAnLi4nXG5cbmZ1bmN0aW9uIGdldFJvdXRlc01hbmlmZXN0U2FmZWx5KG1hbmlmZXN0RmlsZXBhdGg6IHN0cmluZykge1xuICB0cnkge1xuICAgIHJldHVybiByZXF1aXJlKG1hbmlmZXN0RmlsZXBhdGgpXG4gIH0gY2F0Y2ggKGUpIHtcbiAgICByZXR1cm4ge31cbiAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gYnVpbGQoY29uZmlnOiBQcmVzdGEpIHtcbiAgY29uc3QgdG90YWxUaW1lID0gdGltZXIoKVxuICBjb25zdCBmaWxlcyA9IGdldEZpbGVzKGNvbmZpZylcbiAgY29uc3Qgc3RhdGljSWRzID0gZmlsZXMuZmlsdGVyKGlzU3RhdGljKVxuICBjb25zdCBkeW5hbWljSWRzID0gZmlsZXMuZmlsdGVyKGlzRHluYW1pYylcblxuICBsb2dnZXIuZGVidWcoe1xuICAgIGxhYmVsOiAnYnVpbGQnLFxuICAgIG1lc3NhZ2U6ICdzdGFydGluZyBidWlsZCcsXG4gIH0pXG5cbiAgaWYgKCFzdGF0aWNJZHMubGVuZ3RoICYmICFkeW5hbWljSWRzLmxlbmd0aCkge1xuICAgIGxvZ2dlci53YXJuKHtcbiAgICAgIGxhYmVsOiAnZmlsZXMnLFxuICAgICAgbWVzc2FnZTogJ25vIGZpbGVzIHdlcmUgZm91bmQsIG5vdGhpbmcgdG8gYnVpbGQnLFxuICAgIH0pXG4gIH0gZWxzZSB7XG4gICAgbGV0IHN0YXRpY1RpbWUgPSAnJ1xuICAgIGxldCBzdGF0aWNGaWxlQW1vdW50ID0gMFxuICAgIGxldCBkeW5hbWljVGltZSA9ICcnXG4gICAgbGV0IGNvcHlUaW1lID0gJydcblxuICAgIGNvbnN0IHRhc2tzID0gYXdhaXQgUHJvbWlzZS5hbGxTZXR0bGVkKFtcbiAgICAgIChhc3luYyAoKSA9PiB7XG4gICAgICAgIGlmIChzdGF0aWNJZHMubGVuZ3RoKSB7XG4gICAgICAgICAgY29uc3QgdGltZSA9IHRpbWVyKClcblxuICAgICAgICAgIGNvbnN0IHsgYWxsR2VuZXJhdGVkRmlsZXMgfSA9IGF3YWl0IHJlbmRlclN0YXRpY0VudHJpZXMoc3RhdGljSWRzLCBjb25maWcpXG5cbiAgICAgICAgICBzdGF0aWNUaW1lID0gdGltZSgpXG4gICAgICAgICAgc3RhdGljRmlsZUFtb3VudCA9IGFsbEdlbmVyYXRlZEZpbGVzLmxlbmd0aFxuICAgICAgICB9XG4gICAgICB9KSgpLFxuICAgICAgKGFzeW5jICgpID0+IHtcbiAgICAgICAgaWYgKGR5bmFtaWNJZHMubGVuZ3RoKSB7XG4gICAgICAgICAgY29uc3QgdGltZSA9IHRpbWVyKClcblxuICAgICAgICAgIG91dHB1dExhbWJkYXMoZHluYW1pY0lkcywgY29uZmlnKVxuXG4gICAgICAgICAgYXdhaXQgZXNidWlsZCh7XG4gICAgICAgICAgICBlbnRyeVBvaW50czogT2JqZWN0LnZhbHVlcyhyZXF1aXJlKGNvbmZpZy5yb3V0ZXNNYW5pZmVzdCkpLFxuICAgICAgICAgICAgb3V0ZGlyOiBjb25maWcuZnVuY3Rpb25zT3V0cHV0RGlyLFxuICAgICAgICAgICAgYnVuZGxlOiB0cnVlLFxuICAgICAgICAgICAgcGxhdGZvcm06ICdub2RlJyxcbiAgICAgICAgICAgIHRhcmdldDogWydub2RlMTInXSxcbiAgICAgICAgICAgIG1pbmlmeTogdHJ1ZSxcbiAgICAgICAgICAgIGFsbG93T3ZlcndyaXRlOiB0cnVlLFxuICAgICAgICAgIH0pXG5cbiAgICAgICAgICBkeW5hbWljVGltZSA9IHRpbWUoKVxuICAgICAgICB9XG4gICAgICB9KSgpLFxuICAgICAgKGFzeW5jICgpID0+IHtcbiAgICAgICAgaWYgKGZzLmV4aXN0c1N5bmMoY29uZmlnLmFzc2V0cykpIHtcbiAgICAgICAgICBjb25zdCB0aW1lID0gdGltZXIoKVxuXG4gICAgICAgICAgZnMuY29weVN5bmMoY29uZmlnLmFzc2V0cywgY29uZmlnLnN0YXRpY091dHB1dERpcilcblxuICAgICAgICAgIGNvcHlUaW1lID0gdGltZSgpXG4gICAgICAgIH1cbiAgICAgIH0pKCksXG4gICAgXSlcblxuICAgIC8vIHNpbmNlIHdlJ3JlIGJ1aWxkaW5nIChub3Qgd2F0Y2gpIGlmIGFueSB0YXNrIGZhaWxzLCBleGl0IHdpdGggZXJyb3JcbiAgICBpZiAodGFza3MuZmluZCgodGFzaykgPT4gdGFzay5zdGF0dXMgPT09ICdyZWplY3RlZCcpKSB7XG4gICAgICBsb2dnZXIuZGVidWcoe1xuICAgICAgICBsYWJlbDogJ2J1aWxkJyxcbiAgICAgICAgbWVzc2FnZTogJ2J1aWxkIHBhcnRpYWxseSBmYWlsZWQnLFxuICAgICAgfSlcblxuICAgICAgLy8gbG9nIG91dCBlcnJvcnNcbiAgICAgIHRhc2tzLmZvckVhY2goKHRhc2spID0+IHtcbiAgICAgICAgaWYgKHRhc2suc3RhdHVzID09PSAncmVqZWN0ZWQnKSB7XG4gICAgICAgICAgbG9nZ2VyLmVycm9yKHtcbiAgICAgICAgICAgIGxhYmVsOiAnZXJyb3InLFxuICAgICAgICAgICAgZXJyb3I6IHRhc2sucmVhc29uLFxuICAgICAgICAgIH0pXG4gICAgICAgIH1cbiAgICAgIH0pXG5cbiAgICAgIHByb2Nlc3MuZXhpdCgxKVxuICAgICAgcmV0dXJuXG4gICAgfVxuXG4gICAgaWYgKHN0YXRpY1RpbWUgfHwgZHluYW1pY1RpbWUpIHtcbiAgICAgIGxvZ2dlci5uZXdsaW5lKClcbiAgICB9XG5cbiAgICBpZiAoc3RhdGljVGltZSkge1xuICAgICAgbG9nZ2VyLmluZm8oe1xuICAgICAgICBsYWJlbDogJ3N0YXRpYycsXG4gICAgICAgIG1lc3NhZ2U6IGByZW5kZXJlZCAke3N0YXRpY0ZpbGVBbW91bnR9IGZpbGUocylgLFxuICAgICAgICBkdXJhdGlvbjogc3RhdGljVGltZSxcbiAgICAgIH0pXG4gICAgfVxuXG4gICAgaWYgKGR5bmFtaWNUaW1lKSB7XG4gICAgICBsb2dnZXIuaW5mbyh7XG4gICAgICAgIGxhYmVsOiAnbGFtYmRhJyxcbiAgICAgICAgbWVzc2FnZTogYGNvbXBpbGVkICR7ZHluYW1pY0lkcy5sZW5ndGh9IGZ1bmN0aW9uKHMpYCxcbiAgICAgICAgZHVyYXRpb246IGR5bmFtaWNUaW1lLFxuICAgICAgfSlcbiAgICB9XG5cbiAgICBpZiAoY29weVRpbWUpIHtcbiAgICAgIGxvZ2dlci5pbmZvKHtcbiAgICAgICAgbGFiZWw6ICdhc3NldHMnLFxuICAgICAgICBtZXNzYWdlOiBgY29waWVkIGluICR7Y29weVRpbWV9YCxcbiAgICAgIH0pXG4gICAgfVxuXG4gICAgaWYgKHN0YXRpY1RpbWUgfHwgZHluYW1pY1RpbWUpIHtcbiAgICAgIGxvZ2dlci5uZXdsaW5lKClcbiAgICAgIGxvZ2dlci5pbmZvKHtcbiAgICAgICAgbGFiZWw6ICdjb21wbGV0ZScsXG4gICAgICAgIG1lc3NhZ2U6IGBpbiAke3RvdGFsVGltZSgpfWAsXG4gICAgICB9KVxuICAgICAgbG9nZ2VyLm5ld2xpbmUoKVxuICAgIH1cblxuICAgIGNvbmZpZy5ldmVudHMuZW1pdCgncG9zdGJ1aWxkJywge1xuICAgICAgb3V0cHV0OiBjb25maWcub3V0cHV0LFxuICAgICAgc3RhdGljT3V0cHV0OiBjb25maWcuc3RhdGljT3V0cHV0RGlyLFxuICAgICAgZnVuY3Rpb25zT3V0cHV0OiBjb25maWcuZnVuY3Rpb25zT3V0cHV0RGlyLFxuICAgICAgZnVuY3Rpb25zTWFuaWZlc3Q6IGdldFJvdXRlc01hbmlmZXN0U2FmZWx5KGNvbmZpZy5yb3V0ZXNNYW5pZmVzdCksXG4gICAgfSlcbiAgfVxufVxuIiwgImltcG9ydCBmcyBmcm9tICdmcydcbmltcG9ydCBwYXRoIGZyb20gJ3BhdGgnXG5pbXBvcnQgaHR0cCBmcm9tICdodHRwJ1xuaW1wb3J0IGdldFBvcnQgZnJvbSAnZ2V0LXBvcnQnXG5pbXBvcnQgc2lydiBmcm9tICdzaXJ2J1xuaW1wb3J0IGNob2tpZGFyIGZyb20gJ2Nob2tpZGFyJ1xuaW1wb3J0IG1pbWUgZnJvbSAnbWltZS10eXBlcydcbmltcG9ydCB0b1JlZ0V4cCBmcm9tICdyZWdleHBhcmFtJ1xuXG5pbXBvcnQgeyB0aW1lciB9IGZyb20gJy4vdGltZXInXG5pbXBvcnQgKiBhcyBsb2dnZXIgZnJvbSAnLi9sb2cnXG5pbXBvcnQgeyBkZWZhdWx0NDA0IH0gZnJvbSAnLi9kZWZhdWx0NDA0J1xuaW1wb3J0IHsgcmVxdWVzdFRvRXZlbnQgfSBmcm9tICcuL3JlcXVlc3RUb0V2ZW50J1xuaW1wb3J0IHsgc2VuZFNlcnZlcmxlc3NSZXNwb25zZSB9IGZyb20gJy4vc2VuZFNlcnZlcmxlc3NSZXNwb25zZSdcblxuaW1wb3J0IHR5cGUgeyBBV1MsIFByZXN0YSB9IGZyb20gJy4uJ1xuXG5jb25zdCBzdHlsZSA9IFtcbiAgJ3Bvc2l0aW9uOiBmaXhlZCcsXG4gICdib3R0b206IDI0cHgnLFxuICAncmlnaHQ6IDI0cHgnLFxuICAnd2lkdGg6IDMycHgnLFxuICAnaGVpZ2h0OiAzMnB4JyxcbiAgJ2JvcmRlci1yYWRpdXM6IDMycHgnLFxuICAnYmFja2dyb3VuZDogd2hpdGUnLFxuICAnY29sb3I6ICNGRjdBOTMnLFxuICAnZm9udC1zaXplOiAyMHB4JyxcbiAgJ2ZvbnQtd2VpZ2h0OiBib2xkJyxcbiAgJ3RleHQtYWxpZ246IGNlbnRlcicsXG4gICdsaW5lLWhlaWdodDogMzFweCcsXG4gICdib3gtc2hhZG93OiAwcHggMHB4IDFweCByZ2JhKDAsIDAsIDAsIDAuMDQpLCAwcHggNHB4IDhweCByZ2JhKDAsIDAsIDAsIDAuMDQpLCAwcHggMTZweCAyNHB4IHJnYmEoMCwgMCwgMCwgMC4wNCksIDBweCAyNHB4IDMycHggcmdiYSgwLCAwLCAwLCAwLjA0KScsXG5dXG5cbmNvbnN0IGRldlNlcnZlckljb24gPSBgXG4gIDxkaXYgc3R5bGU9XCIke3N0eWxlLmpvaW4oJzsnKX1cIj5+PC9kaXY+XG5gXG5cbmZ1bmN0aW9uIHJlc29sdmVIVE1MKGRpcjogc3RyaW5nLCB1cmw6IHN0cmluZykge1xuICBsZXQgZmlsZSA9IHBhdGguam9pbihkaXIsIHVybClcblxuICAvLyBpZiBubyBleHRlbnNpb24sIGl0J3MgcHJvYmFibHkgaW50ZW5kZWQgdG8gYmUgYW4gSFRNTCBmaWxlXG4gIGlmICghcGF0aC5leHRuYW1lKHVybCkpIHtcbiAgICB0cnkge1xuICAgICAgcmV0dXJuIGZzLnJlYWRGaWxlU3luYyhwYXRoLmpvaW4oZGlyLCB1cmwsICdpbmRleC5odG1sJyksICd1dGY4JylcbiAgICB9IGNhdGNoIChlKSB7fVxuICB9XG5cbiAgcmV0dXJuIGZzLnJlYWRGaWxlU3luYyhmaWxlLCAndXRmOCcpXG59XG5cbmZ1bmN0aW9uIGNyZWF0ZURldkNsaWVudCh7IHBvcnQgfTogeyBwb3J0OiBudW1iZXIgfSkge1xuICByZXR1cm4gYFxuICAgIDxzY3JpcHQ+XG4gICAgICAoZnVuY3Rpb24gKGdsb2JhbCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGNvbnN0IHNvY2tldGlvID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc2NyaXB0JylcbiAgICAgICAgICBzb2NrZXRpby5zcmMgPSAnaHR0cHM6Ly91bnBrZy5jb20vcG9ja2V0LmlvQDAuMS40L21pbi5qcydcbiAgICAgICAgICBzb2NrZXRpby5vbmxvYWQgPSBmdW5jdGlvbiBpbml0ICgpIHtcbiAgICAgICAgICAgIHZhciBkaXNjb25uZWN0ZWQgPSBmYWxzZVxuICAgICAgICAgICAgdmFyIHNvY2tldCA9IGlvKCdodHRwOi8vbG9jYWxob3N0OiR7cG9ydH0nLCB7XG4gICAgICAgICAgICAgIHJlY29ubmVjdGlvbkF0dGVtcHRzOiAzXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgc29ja2V0Lm9uKCdjb25uZWN0JywgZnVuY3Rpb24oKSB7IGNvbnNvbGUubG9nKCdwcmVzdGEgY29ubmVjdGVkJykgfSlcbiAgICAgICAgICAgIHNvY2tldC5vbigncmVmcmVzaCcsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICBnbG9iYWwubG9jYXRpb24ucmVsb2FkKClcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICBzb2NrZXQub24oJ2Rpc2Nvbm5lY3QnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgZGlzY29ubmVjdGVkID0gdHJ1ZVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIHNvY2tldC5vbigncmVjb25uZWN0X2ZhaWxlZCcsIGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAgICAgaWYgKGRpc2Nvbm5lY3RlZCkgcmV0dXJuXG4gICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJwcmVzdGEgLSBjb25uZWN0aW9uIHRvIHNlcnZlciBvbiA6JHtwb3J0fSBmYWlsZWRcIilcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgfVxuICAgICAgICAgIGRvY3VtZW50LmhlYWQuYXBwZW5kQ2hpbGQoc29ja2V0aW8pXG4gICAgICAgIH0gY2F0Y2ggKGUpIHt9XG4gICAgICB9KSh0aGlzKTtcbiAgICA8L3NjcmlwdD5cbiAgYFxufVxuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlU2VydmVySGFuZGxlcih7IHBvcnQsIGNvbmZpZyB9OiB7IHBvcnQ6IG51bWJlcjsgY29uZmlnOiBQcmVzdGEgfSkge1xuICBjb25zdCBkZXZDbGllbnQgPSBjcmVhdGVEZXZDbGllbnQoeyBwb3J0IH0pXG4gIGNvbnN0IHN0YXRpY0RpciA9IGNvbmZpZy5zdGF0aWNPdXRwdXREaXJcbiAgY29uc3QgYXNzZXREaXIgPSBjb25maWcuYXNzZXRzXG5cbiAgcmV0dXJuIGFzeW5jIGZ1bmN0aW9uIHNlcnZlSGFuZGxlcihyZXE6IGh0dHAuSW5jb21pbmdNZXNzYWdlLCByZXM6IGh0dHAuU2VydmVyUmVzcG9uc2UpIHtcbiAgICBjb25zdCB0aW1lID0gdGltZXIoKVxuICAgIGNvbnN0IHVybCA9IHJlcS51cmwgYXMgc3RyaW5nXG5cbiAgICAvKlxuICAgICAqIElmIHRoaXMgaXMgYW4gYXNzZXQgb3RoZXIgdGhhbiBIVE1MIGZpbGVzLCBqdXN0IHNlcnZlIGl0XG4gICAgICovXG4gICAgaWYgKC9eLitcXC4uKyQvLnRlc3QodXJsKSAmJiAhL1xcLmh0bWw/JC8udGVzdCh1cmwpKSB7XG4gICAgICBsb2dnZXIuZGVidWcoe1xuICAgICAgICBsYWJlbDogJ2RlYnVnJyxcbiAgICAgICAgbWVzc2FnZTogYGF0dGVtcHRpbmcgdG8gc2VydmUgc3RhdGljIGFzc2V0ICR7dXJsfWAsXG4gICAgICB9KVxuXG4gICAgICAvKlxuICAgICAgICogZmlyc3QgY2hlY2sgdGhlIHZjcy10cmFja2VkIHN0YXRpYyBmb2xkZXIsXG4gICAgICAgKiB0aGVuIGNoZWNrIHRoZSBwcmVzdGEtYnVpbHQgc3RhdGljIGZvbGRlclxuICAgICAgICpcbiAgICAgICAqIEBzZWUgaHR0cHM6Ly9naXRodWIuY29tL3N1cmUtdGhpbmcvcHJlc3RhL2lzc3Vlcy8zMFxuICAgICAgICovXG4gICAgICBzaXJ2KGFzc2V0RGlyLCB7IGRldjogdHJ1ZSB9KShyZXEsIHJlcywgKCkgPT4ge1xuICAgICAgICBzaXJ2KHN0YXRpY0RpciwgeyBkZXY6IHRydWUgfSkocmVxLCByZXMsICgpID0+IHtcbiAgICAgICAgICBsb2dnZXIud2Fybih7XG4gICAgICAgICAgICBsYWJlbDogJ3NlcnZlJyxcbiAgICAgICAgICAgIG1lc3NhZ2U6IGA0MDQgJHt1cmx9YCxcbiAgICAgICAgICAgIGR1cmF0aW9uOiB0aW1lKCksXG4gICAgICAgICAgfSlcblxuICAgICAgICAgIHNlbmRTZXJ2ZXJsZXNzUmVzcG9uc2UocmVzLCB7XG4gICAgICAgICAgICBzdGF0dXNDb2RlOiA0MDQsXG4gICAgICAgICAgICBib2R5OiBkZWZhdWx0NDA0ICsgZGV2Q2xpZW50ICsgZGV2U2VydmVySWNvbixcbiAgICAgICAgICB9KVxuICAgICAgICB9KVxuICAgICAgfSlcbiAgICB9IGVsc2Uge1xuICAgICAgLypcbiAgICAgICAqIFRyeSB0byByZXNvbHZlIGEgc3RhdGljIHJvdXRlIG5vcm1hbGx5XG4gICAgICAgKi9cbiAgICAgIHRyeSB7XG4gICAgICAgIGxvZ2dlci5kZWJ1Zyh7XG4gICAgICAgICAgbGFiZWw6ICdkZWJ1ZycsXG4gICAgICAgICAgbWVzc2FnZTogYGF0dGVtcHRpbmcgdG8gcmVuZGVyIHN0YXRpYyBIVE1MIGZvciAke3VybH1gLFxuICAgICAgICB9KVxuXG4gICAgICAgIGNvbnN0IGZpbGUgPSByZXNvbHZlSFRNTChzdGF0aWNEaXIsIHVybCkgKyBkZXZDbGllbnQgKyBkZXZTZXJ2ZXJJY29uXG5cbiAgICAgICAgbG9nZ2VyLmluZm8oe1xuICAgICAgICAgIGxhYmVsOiAnc2VydmUnLFxuICAgICAgICAgIG1lc3NhZ2U6IGAyMDAgJHt1cmx9YCxcbiAgICAgICAgICBkdXJhdGlvbjogdGltZSgpLFxuICAgICAgICB9KVxuXG4gICAgICAgIHNlbmRTZXJ2ZXJsZXNzUmVzcG9uc2UocmVzLCB7IGJvZHk6IGZpbGUgfSlcbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgbG9nZ2VyLmRlYnVnKHtcbiAgICAgICAgICBsYWJlbDogJ2RlYnVnJyxcbiAgICAgICAgICBtZXNzYWdlOiBgc2VydmUgZXJyb3JgLFxuICAgICAgICAgIGVycm9yOiBlLFxuICAgICAgICB9KVxuXG4gICAgICAgIC8vIGV4cGVjdCBFTk9FTlQsIGxvZyBldmVyeXRoaW5nIGVsc2VcbiAgICAgICAgaWYgKCEvRU5PRU5UfEVJU0RJUi8udGVzdChlLm1lc3NhZ2UpKSB7XG4gICAgICAgICAgY29uc29sZS5lcnJvcihlKVxuICAgICAgICB9XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAvKlxuICAgICAgICAgICAqIE5vIGFzc2V0IGZpbGUsIG5vIHN0YXRpYyBmaWxlLCB0cnkgZHluYW1pY1xuICAgICAgICAgICAqL1xuICAgICAgICAgIGNvbnN0IG1hbmlmZXN0ID0gcmVxdWlyZShjb25maWcucm91dGVzTWFuaWZlc3QpXG4gICAgICAgICAgY29uc3Qgcm91dGVzID0gT2JqZWN0LmtleXMobWFuaWZlc3QpXG4gICAgICAgICAgY29uc3QgbGFtYmRhRmlsZXBhdGggPSByb3V0ZXNcbiAgICAgICAgICAgIC5tYXAoKHJvdXRlKSA9PiAoe1xuICAgICAgICAgICAgICBtYXRjaGVyOiB0b1JlZ0V4cChyb3V0ZSksXG4gICAgICAgICAgICAgIHJvdXRlLFxuICAgICAgICAgICAgfSkpXG4gICAgICAgICAgICAuZmlsdGVyKCh7IG1hdGNoZXIgfSkgPT4ge1xuICAgICAgICAgICAgICByZXR1cm4gbWF0Y2hlci5wYXR0ZXJuLnRlc3QodXJsLnNwbGl0KCc/JylbMF0pXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLm1hcCgoeyByb3V0ZSB9KSA9PiBtYW5pZmVzdFtyb3V0ZV0pWzBdXG5cbiAgICAgICAgICAvKipcbiAgICAgICAgICAgKiBJZiB3ZSBoYXZlIGEgc2VydmVybGVzcyBmdW5jdGlvbiwgZGVsZWdhdGUgdG8gaXQsIG90aGVyd2lzZSA0MDRcbiAgICAgICAgICAgKi9cbiAgICAgICAgICBpZiAobGFtYmRhRmlsZXBhdGgpIHtcbiAgICAgICAgICAgIGxvZ2dlci5kZWJ1Zyh7XG4gICAgICAgICAgICAgIGxhYmVsOiAnZGVidWcnLFxuICAgICAgICAgICAgICBtZXNzYWdlOiBgYXR0ZW1wdGluZyB0byByZW5kZXIgbGFtYmRhIGZvciAke3VybH1gLFxuICAgICAgICAgICAgfSlcblxuICAgICAgICAgICAgY29uc3QgeyBoYW5kbGVyIH06IHsgaGFuZGxlcjogQVdTWydIYW5kbGVyJ10gfSA9IHJlcXVpcmUobGFtYmRhRmlsZXBhdGgpXG4gICAgICAgICAgICBjb25zdCBldmVudCA9IGF3YWl0IHJlcXVlc3RUb0V2ZW50KHJlcSlcbiAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgaGFuZGxlcihldmVudCwge30pXG4gICAgICAgICAgICBjb25zdCBoZWFkZXJzID0gcmVzcG9uc2UuaGVhZGVycyB8fCB7fVxuICAgICAgICAgICAgY29uc3QgcmVkaXIgPSByZXNwb25zZS5zdGF0dXNDb2RlID4gMjk5ICYmIHJlc3BvbnNlLnN0YXR1c0NvZGUgPCAzOTlcblxuICAgICAgICAgICAgLy8gZ2V0IG1pbWUgdHlwZVxuICAgICAgICAgICAgY29uc3QgdHlwZSA9IGhlYWRlcnNbJ0NvbnRlbnQtVHlwZSddIGFzIHN0cmluZ1xuICAgICAgICAgICAgY29uc3QgZXh0ID0gdHlwZSA/IG1pbWUuZXh0ZW5zaW9uKHR5cGUpIDogJ2h0bWwnXG5cbiAgICAgICAgICAgIGxvZ2dlci5pbmZvKHtcbiAgICAgICAgICAgICAgbGFiZWw6ICdzZXJ2ZScsXG4gICAgICAgICAgICAgIG1lc3NhZ2U6IGAke3Jlc3BvbnNlLnN0YXR1c0NvZGV9ICR7cmVkaXIgPyBoZWFkZXJzLkxvY2F0aW9uIDogdXJsfWAsXG4gICAgICAgICAgICAgIGR1cmF0aW9uOiB0aW1lKCksXG4gICAgICAgICAgICB9KVxuXG4gICAgICAgICAgICBzZW5kU2VydmVybGVzc1Jlc3BvbnNlKHJlcywge1xuICAgICAgICAgICAgICBzdGF0dXNDb2RlOiByZXNwb25zZS5zdGF0dXNDb2RlLFxuICAgICAgICAgICAgICBoZWFkZXJzOiByZXNwb25zZS5oZWFkZXJzLFxuICAgICAgICAgICAgICBtdWx0aVZhbHVlSGVhZGVyczogcmVzcG9uc2UubXVsdGlWYWx1ZUhlYWRlcnMsXG4gICAgICAgICAgICAgIC8vIG9ubHkgaHRtbCBjYW4gYmUgbGl2ZS1yZWxvYWRlZCwgZHVoXG4gICAgICAgICAgICAgIGJvZHk6XG4gICAgICAgICAgICAgICAgZXh0ID09PSAnaHRtbCcgPyAocmVzcG9uc2UuYm9keSB8fCAnJykuc3BsaXQoJzwvYm9keT4nKVswXSArIGRldkNsaWVudCArIGRldlNlcnZlckljb24gOiByZXNwb25zZS5ib2R5LFxuICAgICAgICAgICAgfSlcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKHtcbiAgICAgICAgICAgICAgbGFiZWw6ICdkZWJ1ZycsXG4gICAgICAgICAgICAgIG1lc3NhZ2U6IGBhdHRlbXB0aW5nIHRvIHJlbmRlciBzdGF0aWMgNDA0Lmh0bWwgcGFnZSBmb3IgJHt1cmx9YCxcbiAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgKiBUcnkgdG8gZmFsbCBiYWNrIHRvIGEgc3RhdGljIDQwNCBwYWdlXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgIGNvbnN0IGZpbGUgPSByZXNvbHZlSFRNTChzdGF0aWNEaXIsICc0MDQnKSArIGRldkNsaWVudCArIGRldlNlcnZlckljb25cblxuICAgICAgICAgICAgICBsb2dnZXIud2Fybih7XG4gICAgICAgICAgICAgICAgbGFiZWw6ICdzZXJ2ZScsXG4gICAgICAgICAgICAgICAgbWVzc2FnZTogYDQwNCAke3VybH1gLFxuICAgICAgICAgICAgICAgIGR1cmF0aW9uOiB0aW1lKCksXG4gICAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgICAgc2VuZFNlcnZlcmxlc3NSZXNwb25zZShyZXMsIHtcbiAgICAgICAgICAgICAgICBzdGF0dXNDb2RlOiA0MDQsXG4gICAgICAgICAgICAgICAgYm9keTogZmlsZSxcbiAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgaWYgKCFlLm1lc3NhZ2UuaW5jbHVkZXMoJ0VOT0VOVCcpKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihlKVxuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKHtcbiAgICAgICAgICAgICAgICBsYWJlbDogJ2RlYnVnJyxcbiAgICAgICAgICAgICAgICBtZXNzYWdlOiBgcmVuZGVyaW5nIGRlZmF1bHQgNDA0IEhUTUwgcGFnZSBmb3IgJHt1cmx9YCxcbiAgICAgICAgICAgICAgfSlcblxuICAgICAgICAgICAgICBsb2dnZXIud2Fybih7XG4gICAgICAgICAgICAgICAgbGFiZWw6ICdzZXJ2ZScsXG4gICAgICAgICAgICAgICAgbWVzc2FnZTogYDQwNCAke3VybH1gLFxuICAgICAgICAgICAgICAgIGR1cmF0aW9uOiB0aW1lKCksXG4gICAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgICAgc2VuZFNlcnZlcmxlc3NSZXNwb25zZShyZXMsIHtcbiAgICAgICAgICAgICAgICBzdGF0dXNDb2RlOiA0MDQsXG4gICAgICAgICAgICAgICAgYm9keTogZGVmYXVsdDQwNCArIGRldkNsaWVudCArIGRldlNlcnZlckljb24sXG4gICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgbG9nZ2VyLmRlYnVnKHtcbiAgICAgICAgICAgIGxhYmVsOiAnZGVidWcnLFxuICAgICAgICAgICAgbWVzc2FnZTogYHJlbmRlcmluZyBkZWZhdWx0IDUwMCBIVE1MIHBhZ2UgZm9yICR7dXJsfWAsXG4gICAgICAgICAgfSlcblxuICAgICAgICAgIGxvZ2dlci5lcnJvcih7XG4gICAgICAgICAgICBsYWJlbDogJ3NlcnZlJyxcbiAgICAgICAgICAgIG1lc3NhZ2U6IGA1MDAgJHt1cmx9YCxcbiAgICAgICAgICAgIGVycm9yOiBlLFxuICAgICAgICAgICAgZHVyYXRpb246IHRpbWUoKSxcbiAgICAgICAgICB9KVxuXG4gICAgICAgICAgc2VuZFNlcnZlcmxlc3NSZXNwb25zZShyZXMsIHtcbiAgICAgICAgICAgIHN0YXR1c0NvZGU6IDUwMCxcbiAgICAgICAgICAgIGJvZHk6ICcnICsgZGV2Q2xpZW50ICsgZGV2U2VydmVySWNvbiwgLy8gVE9ETyBkZWZhdWx0IDUwMCBzY3JlZW5cbiAgICAgICAgICB9KVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzZXJ2ZShjb25maWc6IFByZXN0YSkge1xuICBjb25zdCBwb3J0ID0gYXdhaXQgZ2V0UG9ydCh7IHBvcnQ6IDQwMDAgfSlcbiAgY29uc3Qgc2VydmVyID0gaHR0cC5jcmVhdGVTZXJ2ZXIoY3JlYXRlU2VydmVySGFuZGxlcih7IHBvcnQsIGNvbmZpZyB9KSkubGlzdGVuKHBvcnQpXG4gIGNvbnN0IHNvY2tldCA9IHJlcXVpcmUoJ3BvY2tldC5pbycpKHNlcnZlciwgeyBzZXJ2ZUNsaWVudDogZmFsc2UgfSlcblxuICBjb25maWcuZXZlbnRzLm9uKCdyZWZyZXNoJywgKCkgPT4ge1xuICAgIGxvZ2dlci5kZWJ1Zyh7XG4gICAgICBsYWJlbDogJ2RlYnVnJyxcbiAgICAgIG1lc3NhZ2U6IGByZWZyZXNoIGV2ZW50IHJlY2VpdmVkYCxcbiAgICB9KVxuXG4gICAgc29ja2V0LmVtaXQoJ3JlZnJlc2gnKVxuICB9KVxuXG4gIGNob2tpZGFyLndhdGNoKGNvbmZpZy5hc3NldHMsIHsgaWdub3JlSW5pdGlhbDogdHJ1ZSB9KS5vbignYWxsJywgKCkgPT4ge1xuICAgIGNvbmZpZy5ldmVudHMuZW1pdCgncmVmcmVzaCcpXG4gIH0pXG5cbiAgcmV0dXJuIHsgcG9ydCB9XG59XG4iLCAiZXhwb3J0IGNvbnN0IGRlZmF1bHQ0MDQgPSBgPCEtLSBidWlsdCB3aXRoIHByZXN0YSBodHRwczovL25wbS5pbS9wcmVzdGEgLS0+XG48IURPQ1RZUEUgaHRtbD5cbjxodG1sPlxuICA8aGVhZD5cbiAgICA8bWV0YSBjaGFyc2V0PVwiVVRGLThcIiAvPlxuICAgIDxtZXRhIG5hbWU9XCJ2aWV3cG9ydFwiIGNvbnRlbnQ9XCJ3aWR0aD1kZXZpY2Utd2lkdGgsaW5pdGlhbC1zY2FsZT0xXCIgLz5cbiAgICA8dGl0bGU+NDA0PC90aXRsZT5cbiAgICA8bGlua1xuICAgICAgcmVsPVwic3R5bGVzaGVldFwiXG4gICAgICB0eXBlPVwidGV4dC9jc3NcIlxuICAgICAgaHJlZj1cImh0dHBzOi8vdW5wa2cuY29tL3N2YnN0cmF0ZUA0LjEuMS9kaXN0L3N2YnN0cmF0ZS5jc3NcIlxuICAgIC8+XG4gIDwvaGVhZD5cbiAgPGJvZHk+XG4gICAgPGRpdiBjbGFzcz1cImYgYWljIGpjY1wiIHN0eWxlPVwiaGVpZ2h0OiAxMDB2aFwiPlxuICAgICAgPGgyIGNsYXNzPVwicDFcIiBzdHlsZT1cImNvbG9yOiBibHVlXCI+NDA0IE5vdCBGb3VuZDwvaDI+XG4gICAgPC9kaXY+XG4gIDwvYm9keT5cbjwvaHRtbD5gXG4iLCAiaW1wb3J0IGh0dHAgZnJvbSAnaHR0cCdcbmltcG9ydCB7IHBhcnNlIGFzIHBhcnNlVXJsIH0gZnJvbSAndXJsJ1xuaW1wb3J0IHsgcGFyc2UgYXMgcGFyc2VRdWVyeSB9IGZyb20gJ3F1ZXJ5LXN0cmluZydcbmltcG9ydCByYXdCb2R5IGZyb20gJ3Jhdy1ib2R5J1xuaW1wb3J0IG1pbWUgZnJvbSAnbWltZS10eXBlcydcblxuaW1wb3J0IHR5cGUgeyBBV1MgfSBmcm9tICcuLidcblxuLy8gQHNlZSBodHRwczovL2dpdGh1Yi5jb20vbmV0bGlmeS9jbGkvYmxvYi8yN2JiN2I5YjMwZDQ2NWFiZTg2Zjg3ZjQyNzRkZDdhNzFiMWIwMDNiL3NyYy91dGlscy9zZXJ2ZS1mdW5jdGlvbnMuanMjTDE2N1xuY29uc3QgQkFTRV82NF9NSU1FX1JFR0VYUCA9IC9pbWFnZXxhdWRpb3x2aWRlb3xhcHBsaWNhdGlvblxcL3BkZnxhcHBsaWNhdGlvblxcL3ppcHxhcHBsaWNhdG9uXFwvb2N0ZXQtc3RyZWFtL2lcbmZ1bmN0aW9uIHNob3VsZEJhc2U2NEVuY29kZShjb250ZW50VHlwZTogc3RyaW5nKSB7XG4gIHJldHVybiBCb29sZWFuKGNvbnRlbnRUeXBlKSAmJiBCQVNFXzY0X01JTUVfUkVHRVhQLnRlc3QoY29udGVudFR5cGUpXG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiByZXF1ZXN0VG9FdmVudChyZXE6IGh0dHAuSW5jb21pbmdNZXNzYWdlKTogUHJvbWlzZTxBV1NbJ0hhbmRsZXJFdmVudCddPiB7XG4gIC8vIEBzZWUgaHR0cHM6Ly9naXRodWIuY29tL25ldGxpZnkvY2xpL2Jsb2IvMjdiYjdiOWIzMGQ0NjVhYmU4NmY4N2Y0Mjc0ZGQ3YTcxYjFiMDAzYi9zcmMvdXRpbHMvc2VydmUtZnVuY3Rpb25zLmpzI0wyMDhcbiAgY29uc3QgcmVtb3RlQWRkcmVzcyA9IFN0cmluZyhyZXEuaGVhZGVyc1sneC1mb3J3YXJkZWQtZm9yJ10pIHx8IHJlcS5jb25uZWN0aW9uLnJlbW90ZUFkZHJlc3MgfHwgJydcbiAgY29uc3QgaXAgPSByZW1vdGVBZGRyZXNzXG4gICAgLnNwbGl0KHJlbW90ZUFkZHJlc3MuaW5jbHVkZXMoJy4nKSA/ICc6JyA6ICcsJylcbiAgICAucG9wKClcbiAgICA/LnRyaW0oKVxuICBjb25zdCBpc0Jhc2U2NEVuY29kZWQgPSBzaG91bGRCYXNlNjRFbmNvZGUocmVxLmhlYWRlcnNbJ2NvbnRlbnQtdHlwZSddIHx8ICcnKVxuICBjb25zdCBib2R5ID0gcmVxLmhlYWRlcnNbJ2NvbnRlbnQtbGVuZ3RoJ11cbiAgICA/IGF3YWl0IHJhd0JvZHkocmVxLCB7XG4gICAgICAgIGxpbWl0OiAnMW1iJyxcbiAgICAgICAgZW5jb2Rpbmc6IG1pbWUuY2hhcnNldChyZXEuaGVhZGVyc1snY29udGVudC10eXBlJ10gfHwgJycpIHx8IHVuZGVmaW5lZCxcbiAgICAgIH0pXG4gICAgOiB1bmRlZmluZWRcblxuICByZXR1cm4ge1xuICAgIHBhdGg6IHJlcS51cmwgYXMgc3RyaW5nLFxuICAgIGh0dHBNZXRob2Q6IHJlcS5tZXRob2QgYXMgc3RyaW5nLFxuICAgIC8vIEB0cy1pZ25vcmUgVE9ETyB0ZXN0IHNldC1jb29raWUgY29taW5nIGluIGFzIGFycmF5XG4gICAgaGVhZGVyczoge1xuICAgICAgLi4ucmVxLmhlYWRlcnMsXG4gICAgICAnY2xpZW50LWlwJzogaXAsXG4gICAgfSxcbiAgICAvLyBUT0RPIHNob3VsZCB0aGVzZSBoZWFkZXJzIGJlIGV4Y2x1c2l2ZWx5IHNpbmdsZSB2YWx1ZSB2cyBtdWx0aT9cbiAgICBtdWx0aVZhbHVlSGVhZGVyczogT2JqZWN0LmtleXMocmVxLmhlYWRlcnMpLnJlZHVjZSgoaGVhZGVycywga2V5KSA9PiB7XG4gICAgICBpZiAocmVxLmhlYWRlcnNba2V5XSAmJiAhKHJlcS5oZWFkZXJzW2tleV0gYXMgc3RyaW5nKS5pbmNsdWRlcygnLCcpKSByZXR1cm4gaGVhZGVycyAvLyBvbmx5IGluY2x1ZGUgbXVsdGktdmFsdWUgaGVhZGVycyBoZXJlXG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIC4uLmhlYWRlcnMsXG4gICAgICAgIC8vIEB0cy1pZ25vcmUgVE9ETyBhZ2FpbiwgYXJyYXkgaGVhZGVyc1xuICAgICAgICBba2V5XTogcmVxLmhlYWRlcnNba2V5XS5zcGxpdCgnLCcpLFxuICAgICAgfVxuICAgIH0sIHt9KSxcbiAgICAvLyBAdHMtaWdub3JlIFRPRE8gZG8gSSBuZWVkIHRvIGtlZXAgdGhlc2Ugc2VwYXJhdGU/XG4gICAgcXVlcnlTdHJpbmdQYXJhbWV0ZXJzOiBwYXJzZVF1ZXJ5KHBhcnNlVXJsKHJlcS51cmwpLnF1ZXJ5KSxcbiAgICBib2R5OiBib2R5ID8gbmV3IEJ1ZmZlcihib2R5KS50b1N0cmluZyhpc0Jhc2U2NEVuY29kZWQgPyAnYmFzZTY0JyA6ICd1dGY4JykgOiBudWxsLFxuICAgIGlzQmFzZTY0RW5jb2RlZCxcbiAgfVxufVxuIiwgImltcG9ydCBodHRwIGZyb20gJ2h0dHAnXG5cbmltcG9ydCB7IG5vcm1hbGl6ZVJlc3BvbnNlIH0gZnJvbSAnLi9ub3JtYWxpemVSZXNwb25zZSdcblxuaW1wb3J0IHR5cGUgeyBBV1MgfSBmcm9tICcuLidcblxuZXhwb3J0IGZ1bmN0aW9uIHNlbmRTZXJ2ZXJsZXNzUmVzcG9uc2UocmVzOiBodHRwLlNlcnZlclJlc3BvbnNlLCByOiBQYXJ0aWFsPEFXU1snSGFuZGxlclJlc3BvbnNlJ10+KSB7XG4gIGNvbnN0IHJlc3BvbnNlID0gbm9ybWFsaXplUmVzcG9uc2UocilcblxuICAvLyBAc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9uZXRsaWZ5L2NsaS9ibG9iLzI3YmI3YjliMzBkNDY1YWJlODZmODdmNDI3NGRkN2E3MWIxYjAwM2Ivc3JjL3V0aWxzL3NlcnZlLWZ1bmN0aW9ucy5qcyNMNzNcbiAgZm9yIChjb25zdCBrZXkgaW4gci5tdWx0aVZhbHVlSGVhZGVycykge1xuICAgIHJlcy5zZXRIZWFkZXIoa2V5LCBTdHJpbmcoci5tdWx0aVZhbHVlSGVhZGVyc1trZXldKSlcbiAgfVxuXG4gIGZvciAoY29uc3Qga2V5IGluIHIuaGVhZGVycykge1xuICAgIHJlcy5zZXRIZWFkZXIoa2V5LCBTdHJpbmcoci5oZWFkZXJzW2tleV0pKVxuICB9XG5cbiAgcmVzLnN0YXR1c0NvZGUgPSByZXNwb25zZS5zdGF0dXNDb2RlXG4gIHJlcy53cml0ZShyZXNwb25zZS5ib2R5KVxuICByZXMuZW5kKClcbn1cbiJdLAogICJtYXBwaW5ncyI6ICI7azRCQUVBLE9BQWUsdUJBQ2YsR0FBaUIsdTZDQ0hqQixNQUF5QixvQkNBekIsTUFBaUIsbUJDRVYsYUFBeUIsQ0FDOUIsR0FBSSxHQUEwQyxHQUU5QyxXQUFjLEtBQWUsRUFBbUIsQ0FDOUMsRUFBTyxJQUFNLEVBQU8sR0FBSSxJQUFJLEFBQUMsR0FBaUIsRUFBRyxHQUFHLElBR3RELFdBQVksRUFBWSxFQUE4QixDQUNwRCxTQUFPLEdBQU0sRUFBTyxHQUFNLEVBQU8sR0FBSSxPQUFPLEdBQU0sQ0FBQyxHQUM1QyxJQUFNLEVBQU8sR0FBSSxPQUFPLEVBQU8sR0FBSSxRQUFRLEdBQUssR0FHekQsWUFBaUIsQ0FDZixFQUFTLEdBR1gsV0FBbUIsRUFBWSxDQUM3QixNQUFPLEdBQU8sSUFBTyxHQUd2QixNQUFPLENBQ0wsT0FDQSxLQUNBLFFBQ0EsYURuQkosR0FBTSxJQUF3QixtQkFFbEIsRUFBTCxVQUFLLEVBQUwsQ0FDTCxhQUFhLGFBQ2IsY0FBYyxjQUNkLE9BQU8sU0FIRyxXQU1aLEdBQU0sSUFBZ0IsQ0FDcEIsSUFBSyxRQUFRLElBQ2IsSUFBSyxRQUFRLE1BQ2Is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
